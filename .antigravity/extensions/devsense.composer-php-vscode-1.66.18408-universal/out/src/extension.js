var kS=Object.create;var Go=Object.defineProperty;var OS=Object.getOwnPropertyDescriptor;var NS=Object.getOwnPropertyNames;var qS=Object.getPrototypeOf,LS=Object.prototype.hasOwnProperty;var d=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),MS=(e,t)=>{for(var r in t)Go(e,r,{get:t[r],enumerable:!0})},Uv=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of NS(t))!LS.call(e,i)&&i!==r&&Go(e,i,{get:()=>t[i],enumerable:!(n=OS(t,i))||n.enumerable});return e};var Pr=(e,t,r)=>(r=e!=null?kS(qS(e)):{},Uv(t||!e||!e.__esModule?Go(r,"default",{value:e,enumerable:!0}):r,e)),HS=e=>Uv(Go({},"__esModule",{value:!0}),e);var w=(e,t,r)=>new Promise((n,i)=>{var s=u=>{try{o(r.next(u))}catch(c){i(c)}},a=u=>{try{o(r.throw(u))}catch(c){i(c)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(s,a);o((r=r.apply(e,t)).next())});var Il=d(Vv=>{var $v=require("url"),FS=require("child_process").spawn,Ii=require("fs");Vv.XMLHttpRequest=function(){"use strict";var e=this,t=require("http"),r=require("https"),n,i,s={},a=!1,o={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},u={},c={},l=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],f=["TRACE","TRACK","CONNECT"],p=!1,h=!1,v={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;var T=function(m){return a||m&&l.indexOf(m.toLowerCase())===-1},S=function(m){return m&&f.indexOf(m)===-1};this.open=function(m,A,Y,J,de){if(this.abort(),h=!1,!S(m))throw new Error("SecurityError: Request method not allowed");s={method:m,url:A.toString(),async:typeof Y!="boolean"?!0:Y,user:J||null,password:de||null},x(this.OPENED)},this.setDisableHeaderCheck=function(m){a=m},this.setRequestHeader=function(m,A){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!T(m)){console.warn('Refused to set unsafe header "'+m+'"');return}if(p)throw new Error("INVALID_STATE_ERR: send flag is true");m=c[m.toLowerCase()]||m,c[m.toLowerCase()]=m,u[m]=u[m]?u[m]+", "+A:A},this.getResponseHeader=function(m){return typeof m=="string"&&this.readyState>this.OPENED&&i&&i.headers&&i.headers[m.toLowerCase()]&&!h?i.headers[m.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||h)return"";var m="";for(var A in i.headers)A!=="set-cookie"&&A!=="set-cookie2"&&(m+=A+": "+i.headers[A]+`\r
`);return m.substr(0,m.length-2)},this.getRequestHeader=function(m){return typeof m=="string"&&c[m.toLowerCase()]?u[c[m.toLowerCase()]]:""},this.send=function(m){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(p)throw new Error("INVALID_STATE_ERR: send has already been called");var A=!1,Y=!1,J=$v.parse(s.url),de;switch(J.protocol){case"https:":A=!0;case"http:":de=J.hostname;break;case"file:":Y=!0;break;case void 0:case null:case"":de="localhost";break;default:throw new Error("Protocol not supported.")}if(Y){if(s.method!=="GET")throw new Error("XMLHttpRequest: Only GET method is supported");if(s.async)Ii.readFile(J.pathname,"utf8",function(pr,Yt){pr?e.handleError(pr):(e.status=200,e.responseText=Yt,x(e.DONE))});else try{this.responseText=Ii.readFileSync(J.pathname,"utf8"),this.status=200,x(e.DONE)}catch(pr){this.handleError(pr)}return}var nt=J.port||(A?443:80),Mt=J.pathname+(J.search?J.search:"");for(var dt in o)c[dt.toLowerCase()]||(u[dt]=o[dt]);if(u.Host=de,A&&nt===443||nt===80||(u.Host+=":"+J.port),s.user){typeof s.password>"u"&&(s.password="");var Ei=new Buffer(s.user+":"+s.password);u.Authorization="Basic "+Ei.toString("base64")}s.method==="GET"||s.method==="HEAD"?m=null:m?(u["Content-Length"]=Buffer.isBuffer(m)?m.length:Buffer.byteLength(m),u["Content-Type"]||(u["Content-Type"]="text/plain;charset=UTF-8")):s.method==="POST"&&(u["Content-Length"]=0);var xr={host:de,port:nt,path:Mt,method:s.method,headers:u,agent:!1,withCredentials:e.withCredentials};if(h=!1,s.async){var Ar=A?r.request:t.request;p=!0,e.dispatchEvent("readystatechange");var _n=function pr(Yt){if(i=Yt,i.statusCode===301||i.statusCode===302||i.statusCode===303||i.statusCode===307){s.url=i.headers.location;var Ci=$v.parse(s.url);de=Ci.hostname;var Jt={hostname:Ci.hostname,port:Ci.port,path:Ci.path,method:i.statusCode===303?"GET":s.method,headers:u,withCredentials:e.withCredentials};n=Ar(Jt,pr).on("error",Rr),n.end();return}i.setEncoding("utf8"),x(e.HEADERS_RECEIVED),e.status=i.statusCode,i.on("data",function(Fe){Fe&&(e.responseText+=Fe),p&&x(e.LOADING)}),i.on("end",function(){p&&(x(e.DONE),p=!1)}),i.on("error",function(Fe){e.handleError(Fe)})},Rr=function(Yt){e.handleError(Yt)};n=Ar(xr,_n).on("error",Rr),m&&n.write(m),n.end(),e.dispatchEvent("loadstart")}else{var En=".node-xmlhttprequest-content-"+process.pid,Cn=".node-xmlhttprequest-sync-"+process.pid;Ii.writeFileSync(Cn,"","utf8");for(var ml="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(A?"s":"")+".request;var options = "+JSON.stringify(xr)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+En+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+Cn+"');});response.on('error', function(error) {fs.writeFileSync('"+En+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+Cn+"');});}).on('error', function(error) {fs.writeFileSync('"+En+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+Cn+"');});"+(m?"req.write('"+JSON.stringify(m).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",yl=FS(process.argv[0],["-e",ml]);Ii.existsSync(Cn););var Tn=JSON.parse(Ii.readFileSync(En,"utf8"));yl.stdin.end(),Ii.unlinkSync(En),Tn.err?e.handleError(Tn.err):(i=Tn.data,e.status=Tn.data.statusCode,e.responseText=Tn.data.text,x(e.DONE))}},this.handleError=function(m){this.status=0,this.statusText=m,this.responseText=m.stack,h=!0,x(this.DONE),this.dispatchEvent("error")},this.abort=function(){n&&(n.abort(),n=null),u=o,this.status=0,this.responseText="",this.responseXML="",h=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||p)&&this.readyState!==this.DONE&&(p=!1,x(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(m,A){m in v||(v[m]=[]),v[m].push(A)},this.removeEventListener=function(m,A){m in v&&(v[m]=v[m].filter(function(Y){return Y!==A}))},this.dispatchEvent=function(m){if(typeof e["on"+m]=="function"&&e["on"+m](),m in v)for(var A=0,Y=v[m].length;A<Y;A++)v[m][A].call(e)};var x=function(m){(m==e.LOADING||e.readyState!==m)&&(e.readyState=m,(s.async||e.readyState<e.OPENED||e.readyState===e.DONE)&&e.dispatchEvent("readystatechange"),e.readyState===e.DONE&&!h&&(e.dispatchEvent("load"),e.dispatchEvent("loadend")))}}});var Qe=d((BF,Kv)=>{"use strict";var BS=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();Kv.exports=BS});var Xo=d(nn=>{"use strict";var Yv=nn&&nn.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(nn,"__esModule",{value:!0});var bn=wn(),GS=require("events"),zS;(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(zS=nn.SpanKind||(nn.SpanKind={}));var Jv=function(){function e(){}return e.prototype.active=function(){var t=this,r=bn.CorrelationContextManager.getCurrentContext();return Yv({},r,{getValue:function(n){return t._activeSymbol?n===t._activeSymbol?r:!1:(t._activeSymbol=n,r)},setValue:function(){}})},e.prototype.with=function(t,r){var n=t.parentSpanId,i=t.name,s=e._spanToContext(t,n,i);return bn.CorrelationContextManager.runWithContext(s,r)()},e.prototype.bind=function(t){return typeof t=="function"?bn.CorrelationContextManager.wrapCallback(t):(t instanceof GS.EventEmitter&&bn.CorrelationContextManager.wrapEmitter(t),t)},e.prototype.enable=function(){return bn.CorrelationContextManager.enable(),this},e.prototype.disable=function(){return bn.CorrelationContextManager.disable(),this},e._spanToContext=function(t,r,n){var i=r?"|"+t.context().traceId+"."+r+".":t.context().traceId,s=Yv({},t.context(),{traceFlags:t.context().traceFlags.toString()}),a=bn.CorrelationContextManager.spanToContextObject(s,i,n);return a},e}();nn.OpenTelemetryScopeManagerWrapper=Jv;nn.AsyncScopeManager=new Jv});var iu=d((N,hg)=>{N=hg.exports=z;var ae;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?ae=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:ae=function(){};N.SEMVER_SPEC_VERSION="2.0.0";var Xs=256,Wo=Number.MAX_SAFE_INTEGER||9007199254740991,xl=16,QS=Xs-6,Ws=N.re=[],he=N.safeRe=[],y=N.src=[],$=0,kl="[a-zA-Z0-9-]",Al=[["\\s",1],["\\d",Xs],[kl,QS]];function tu(e){for(var t=0;t<Al.length;t++){var r=Al[t][0],n=Al[t][1];e=e.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return e}var Si=$++;y[Si]="0|[1-9]\\d*";var xi=$++;y[xi]="\\d+";var Ol=$++;y[Ol]="\\d*[a-zA-Z-]"+kl+"*";var eg=$++;y[eg]="("+y[Si]+")\\.("+y[Si]+")\\.("+y[Si]+")";var tg=$++;y[tg]="("+y[xi]+")\\.("+y[xi]+")\\.("+y[xi]+")";var Rl=$++;y[Rl]="(?:"+y[Si]+"|"+y[Ol]+")";var Pl=$++;y[Pl]="(?:"+y[xi]+"|"+y[Ol]+")";var Nl=$++;y[Nl]="(?:-("+y[Rl]+"(?:\\."+y[Rl]+")*))";var ql=$++;y[ql]="(?:-?("+y[Pl]+"(?:\\."+y[Pl]+")*))";var Dl=$++;y[Dl]=kl+"+";var Ys=$++;y[Ys]="(?:\\+("+y[Dl]+"(?:\\."+y[Dl]+")*))";var Ll=$++,rg="v?"+y[eg]+y[Nl]+"?"+y[Ys]+"?";y[Ll]="^"+rg+"$";var Ml="[v=\\s]*"+y[tg]+y[ql]+"?"+y[Ys]+"?",Hl=$++;y[Hl]="^"+Ml+"$";var ki=$++;y[ki]="((?:<|>)?=?)";var Ko=$++;y[Ko]=y[xi]+"|x|X|\\*";var Yo=$++;y[Yo]=y[Si]+"|x|X|\\*";var Sn=$++;y[Sn]="[v=\\s]*("+y[Yo]+")(?:\\.("+y[Yo]+")(?:\\.("+y[Yo]+")(?:"+y[Nl]+")?"+y[Ys]+"?)?)?";var Ri=$++;y[Ri]="[v=\\s]*("+y[Ko]+")(?:\\.("+y[Ko]+")(?:\\.("+y[Ko]+")(?:"+y[ql]+")?"+y[Ys]+"?)?)?";var ng=$++;y[ng]="^"+y[ki]+"\\s*"+y[Sn]+"$";var ig=$++;y[ig]="^"+y[ki]+"\\s*"+y[Ri]+"$";var sg=$++;y[sg]="(?:^|[^\\d])(\\d{1,"+xl+"})(?:\\.(\\d{1,"+xl+"}))?(?:\\.(\\d{1,"+xl+"}))?(?:$|[^\\d])";var ru=$++;y[ru]="(?:~>?)";var Pi=$++;y[Pi]="(\\s*)"+y[ru]+"\\s+";Ws[Pi]=new RegExp(y[Pi],"g");he[Pi]=new RegExp(tu(y[Pi]),"g");var XS="$1~",ag=$++;y[ag]="^"+y[ru]+y[Sn]+"$";var og=$++;y[og]="^"+y[ru]+y[Ri]+"$";var nu=$++;y[nu]="(?:\\^)";var Di=$++;y[Di]="(\\s*)"+y[nu]+"\\s+";Ws[Di]=new RegExp(y[Di],"g");he[Di]=new RegExp(tu(y[Di]),"g");var WS="$1^",ug=$++;y[ug]="^"+y[nu]+y[Sn]+"$";var cg=$++;y[cg]="^"+y[nu]+y[Ri]+"$";var Fl=$++;y[Fl]="^"+y[ki]+"\\s*("+Ml+")$|^$";var jl=$++;y[jl]="^"+y[ki]+"\\s*("+rg+")$|^$";var xn=$++;y[xn]="(\\s*)"+y[ki]+"\\s*("+Ml+"|"+y[Sn]+")";Ws[xn]=new RegExp(y[xn],"g");he[xn]=new RegExp(tu(y[xn]),"g");var KS="$1$2$3",lg=$++;y[lg]="^\\s*("+y[Sn]+")\\s+-\\s+("+y[Sn]+")\\s*$";var fg=$++;y[fg]="^\\s*("+y[Ri]+")\\s+-\\s+("+y[Ri]+")\\s*$";var pg=$++;y[pg]="(<|>)?=?\\s*\\*";for(vr=0;vr<$;vr++)ae(vr,y[vr]),Ws[vr]||(Ws[vr]=new RegExp(y[vr]),he[vr]=new RegExp(tu(y[vr])));var vr;N.parse=An;function An(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if(typeof e!="string"||e.length>Xs)return null;var r=t.loose?he[Hl]:he[Ll];if(!r.test(e))return null;try{return new z(e,t)}catch{return null}}N.valid=YS;function YS(e,t){var r=An(e,t);return r?r.version:null}N.clean=JS;function JS(e,t){var r=An(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}N.SemVer=z;function z(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>Xs)throw new TypeError("version is longer than "+Xs+" characters");if(!(this instanceof z))return new z(e,t);ae("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?he[Hl]:he[Ll]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Wo||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Wo||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Wo||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<Wo)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};z.prototype.toString=function(){return this.version};z.prototype.compare=function(e){return ae("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)};z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),Ai(this.major,e.major)||Ai(this.minor,e.minor)||Ai(this.patch,e.patch)};z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(ae("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Ai(r,n)}while(++t)};z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};N.inc=ZS;function ZS(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch{return null}}N.diff=ex;function ex(e,t){if(Ul(e,t))return null;var r=An(e),n=An(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return i+a;return s}N.compareIdentifiers=Ai;var Zv=/^[0-9]+$/;function Ai(e,t){var r=Zv.test(e),n=Zv.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}N.rcompareIdentifiers=tx;function tx(e,t){return Ai(t,e)}N.major=rx;function rx(e,t){return new z(e,t).major}N.minor=nx;function nx(e,t){return new z(e,t).minor}N.patch=ix;function ix(e,t){return new z(e,t).patch}N.compare=Dr;function Dr(e,t,r){return new z(e,r).compare(new z(t,r))}N.compareLoose=sx;function sx(e,t){return Dr(e,t,!0)}N.rcompare=ax;function ax(e,t,r){return Dr(t,e,r)}N.sort=ox;function ox(e,t){return e.sort(function(r,n){return N.compare(r,n,t)})}N.rsort=ux;function ux(e,t){return e.sort(function(r,n){return N.rcompare(r,n,t)})}N.gt=Ks;function Ks(e,t,r){return Dr(e,t,r)>0}N.lt=Jo;function Jo(e,t,r){return Dr(e,t,r)<0}N.eq=Ul;function Ul(e,t,r){return Dr(e,t,r)===0}N.neq=dg;function dg(e,t,r){return Dr(e,t,r)!==0}N.gte=$l;function $l(e,t,r){return Dr(e,t,r)>=0}N.lte=Vl;function Vl(e,t,r){return Dr(e,t,r)<=0}N.cmp=Zo;function Zo(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Ul(e,r,n);case"!=":return dg(e,r,n);case">":return Ks(e,r,n);case">=":return $l(e,r,n);case"<":return Jo(e,r,n);case"<=":return Vl(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}N.Comparator=Ht;function Ht(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Ht){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof Ht))return new Ht(e,t);e=e.trim().split(/\s+/).join(" "),ae("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Js?this.value="":this.value=this.operator+this.semver.version,ae("comp",this)}var Js={};Ht.prototype.parse=function(e){var t=this.options.loose?he[Fl]:he[jl],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=Js};Ht.prototype.toString=function(){return this.value};Ht.prototype.test=function(e){return ae("Comparator.test",e,this.options.loose),this.semver===Js?!0:(typeof e=="string"&&(e=new z(e,this.options)),Zo(e,this.operator,this.semver,this.options))};Ht.prototype.intersects=function(e,t){if(!(e instanceof Ht))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new Ie(e.value,t),eu(this.value,r,t);if(e.operator==="")return r=new Ie(this.value,t),eu(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,a=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=Zo(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),u=Zo(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||s&&a||o||u};N.Range=Ie;function Ie(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Ie(e.raw,t);if(e instanceof Ht)return new Ie(e.value,t);if(!(this instanceof Ie))return new Ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Ie.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};Ie.prototype.toString=function(){return this.range};Ie.prototype.parseRange=function(e){var t=this.options.loose,r=t?he[fg]:he[lg];e=e.replace(r,yx),ae("hyphen replace",e),e=e.replace(he[xn],KS),ae("comparator trim",e,he[xn]),e=e.replace(he[Pi],XS),e=e.replace(he[Di],WS);var n=t?he[Fl]:he[jl],i=e.split(" ").map(function(s){return lx(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new Ht(s,this.options)},this),i};Ie.prototype.intersects=function(e,t){if(!(e instanceof Ie))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(s){return n.intersects(s,t)})})})})};N.toComparators=cx;function cx(e,t){return new Ie(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function lx(e,t){return ae("comp",e,t),e=dx(e,t),ae("caret",e),e=fx(e,t),ae("tildes",e),e=vx(e,t),ae("xrange",e),e=mx(e,t),ae("stars",e),e}function ht(e){return!e||e.toLowerCase()==="x"||e==="*"}function fx(e,t){return e.trim().split(/\s+/).map(function(r){return px(r,t)}).join(" ")}function px(e,t){var r=t.loose?he[og]:he[ag];return e.replace(r,function(n,i,s,a,o){ae("tilde",e,n,i,s,a,o);var u;return ht(i)?u="":ht(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":ht(a)?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":o?(ae("replaceTilde pr",o),u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0"):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0",ae("tilde return",u),u})}function dx(e,t){return e.trim().split(/\s+/).map(function(r){return hx(r,t)}).join(" ")}function hx(e,t){ae("caret",e,t);var r=t.loose?he[cg]:he[ug];return e.replace(r,function(n,i,s,a,o){ae("caret",e,n,i,s,a,o);var u;return ht(i)?u="":ht(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":ht(a)?i==="0"?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+".0 <"+(+i+1)+".0.0":o?(ae("replaceCaret pr",o),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+"-"+o+" <"+(+i+1)+".0.0"):(ae("no pr"),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+" <"+(+i+1)+".0.0"),ae("caret return",u),u})}function vx(e,t){return ae("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return gx(r,t)}).join(" ")}function gx(e,t){e=e.trim();var r=t.loose?he[ig]:he[ng];return e.replace(r,function(n,i,s,a,o,u){ae("xRange",e,n,i,s,a,o,u);var c=ht(s),l=c||ht(a),f=l||ht(o),p=f;return i==="="&&p&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&p?(l&&(a=0),o=0,i===">"?(i=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):i==="<="&&(i="<",l?s=+s+1:a=+a+1),n=i+s+"."+a+"."+o):l?n=">="+s+".0.0 <"+(+s+1)+".0.0":f&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),ae("xRange return",n),n})}function mx(e,t){return ae("replaceStars",e,t),e.trim().replace(he[pg],"")}function yx(e,t,r,n,i,s,a,o,u,c,l,f,p){return ht(r)?t="":ht(n)?t=">="+r+".0.0":ht(i)?t=">="+r+"."+n+".0":t=">="+t,ht(u)?o="":ht(c)?o="<"+(+u+1)+".0.0":ht(l)?o="<"+u+"."+(+c+1)+".0":f?o="<="+u+"."+c+"."+l+"-"+f:o="<="+o,(t+" "+o).trim()}Ie.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(_x(this.set[t],e,this.options))return!0;return!1};function _x(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(ae(e[n].semver),e[n].semver!==Js&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}N.satisfies=eu;function eu(e,t,r){try{t=new Ie(t,r)}catch{return!1}return t.test(e)}N.maxSatisfying=Ex;function Ex(e,t,r){var n=null,i=null;try{var s=new Ie(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new z(n,r))}),n}N.minSatisfying=Cx;function Cx(e,t,r){var n=null,i=null;try{var s=new Ie(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new z(n,r))}),n}N.minVersion=Tx;function Tx(e,t){e=new Ie(e,t);var r=new z("0.0.0");if(e.test(r)||(r=new z("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(s){var a=new z(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Ks(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&e.test(r)?r:null}N.validRange=Ix;function Ix(e,t){try{return new Ie(e,t).range||"*"}catch{return null}}N.ltr=bx;function bx(e,t,r){return Bl(e,t,"<",r)}N.gtr=wx;function wx(e,t,r){return Bl(e,t,">",r)}N.outside=Bl;function Bl(e,t,r,n){e=new z(e,n),t=new Ie(t,n);var i,s,a,o,u;switch(r){case">":i=Ks,s=Vl,a=Jo,o=">",u=">=";break;case"<":i=Jo,s=$l,a=Ks,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(eu(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],f=null,p=null;if(l.forEach(function(h){h.semver===Js&&(h=new Ht(">=0.0.0")),f=f||h,p=p||h,i(h.semver,f.semver,n)?f=h:a(h.semver,p.semver,n)&&(p=h)}),f.operator===o||f.operator===u||(!p.operator||p.operator===o)&&s(e,p.semver))return!1;if(p.operator===u&&a(e,p.semver))return!1}return!0}N.prerelease=Sx;function Sx(e,t){var r=An(e,t);return r&&r.prerelease.length?r.prerelease:null}N.intersects=xx;function xx(e,t,r){return e=new Ie(e,r),t=new Ie(t,r),e.intersects(t)}N.coerce=Ax;function Ax(e){if(e instanceof z)return e;if(typeof e!="string")return null;var t=e.match(he[sg]);return t==null?null:An(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var zl=d(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var Rx=require("path"),Px=iu(),gg=require("module"),Dx=Object.keys(process.binding("natives")),vg=gg.prototype.require;function kx(e){var t={};return function(n){var i=vg.apply(this,arguments);if(e[n]){var s=gg._resolveFilename(n,this);if(t.hasOwnProperty(s))return t[s];var a=void 0;if(Dx.indexOf(n)<0)try{a=vg.call(this,Rx.join(n,"package.json")).version}catch{return i}else a=process.version.substring(1);var o=a.indexOf("-");o>=0&&(a=a.substring(0,o));for(var u=i,c=0,l=e[n];c<l.length;c++){var f=l[c];Px.satisfies(a,f.versionSpecifier)&&(u=f.patch(u,s))}return t[s]=u}return i}}Gl.makePatchingRequire=kx});var mg=d((QF,Ox)=>{Ox.exports={name:"diagnostic-channel",version:"0.3.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"^7.0.12",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"^2.2.1"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var Oe=d(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});var Nx=zl(),qx=zl();su.makePatchingRequire=qx.makePatchingRequire;var yg=function(e){return!0},Lx=function(){function e(){this.version=mg().version,this.subscribers={},this.contextPreservationFunction=function(t){return t},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(t){var r=this.subscribers[t];return r?r.some(function(n){var i=n.filter;return!i||i(!1)}):!1},e.prototype.publish=function(t,r){if(!this.currentlyPublishing){var n=this.subscribers[t];if(n){var i={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,o=s.filter;try{o&&o(!0)&&a(i)}catch{}}),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(t,r,n){n===void 0&&(n=yg),this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push({listener:r,filter:n})},e.prototype.unsubscribe=function(t,r,n){n===void 0&&(n=yg);var i=this.subscribers[t];if(i){for(var s=0;s<i.length;++s)if(i[s].listener===r&&i[s].filter===n)return i.splice(s,1),!0}return!1},e.prototype.reset=function(){var t=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete t.knownPatches[r]})},e.prototype.bindToContext=function(t){return this.contextPreservationFunction(t)},e.prototype.addContextPreservation=function(t){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return t(r(n))}},e.prototype.registerMonkeyPatch=function(t,r){this.knownPatches[t]||(this.knownPatches[t]=[]),this.knownPatches[t].push(r)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new Lx,_g=require("module"),_g.prototype.require=Nx.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var _g;su.channel=global.diagnosticsSource});var Cg=d(kr=>{"use strict";var Mx=kr&&kr.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(kr,"__esModule",{value:!0});var au=Oe();kr.AzureMonitorSymbol="Azure_Monitor_Tracer";var Eg=!1,Hx=function(e){if(Eg)return e;try{var t=require("@opentelemetry/tracing"),r=require("@opentelemetry/api"),n=au.channel.spanContextPropagator?{contextManager:au.channel.spanContextPropagator}:void 0;new t.BasicTracerProvider().register(n);var i=r.trace.getTracer("applicationinsights tracer"),s=i.startSpan;i.startSpan=function(a,o){if(!o||!o.parent){var u=r.getSpan(r.context.active());u&&u.operation&&u.operation.traceparent&&(o=Mx({},o,{parent:{traceId:u.operation.traceparent.traceId,spanId:u.operation.traceparent.spanId,traceFlags:1}}))}var c=s.call(this,a,o),l=c.end;return c.end=function(){var f=l.apply(this,arguments);return au.channel.publish("azure-coretracing",c),f},c},r.getSpan(r.context.active()),i[kr.AzureMonitorSymbol]=!0,e.setTracer(i),Eg=!0}catch{}return e};kr.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:Hx};function Fx(){au.channel.registerMonkeyPatch("@azure/core-tracing",kr.azureCoreTracing)}kr.enable=Fx});var Ig=d(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});var Tg=Oe(),jx=function(e){var t=e.prototype._emit;return e.prototype._emit=function(r,n){var i=t.apply(this,arguments);if(!n){var s=i;s||(s=t.call(this,r,!0)),Tg.channel.publish("bunyan",{level:r.level,result:s})}return i},e};Zs.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:jx};function Ux(){Tg.channel.registerMonkeyPatch("bunyan",Zs.bunyan)}Zs.enable=Ux});var wg=d(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});var Ql=Oe(),bg=require("stream"),$x=function(e){var t=new bg.Writable,r=new bg.Writable;t.write=function(c){if(!c)return!0;var l=c.toString();return Ql.channel.publish("console",{message:l}),!0},r.write=function(c){if(!c)return!0;var l=c.toString();return Ql.channel.publish("console",{message:l,stderr:!0}),!0};for(var n=new e.Console(t,r),i=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(c){var l=e[c];l&&(e[c]=function(){if(n[c])try{n[c].apply(n,arguments)}catch{}return l.apply(e,arguments)})},a=0,o=i;a<o.length;a++){var u=o[a];s(u)}return e};ea.console={versionSpecifier:">= 4.0.0",patch:$x};function Vx(){Ql.channel.registerMonkeyPatch("console",ea.console),require("console")}ea.enable=Vx});var Sg=d(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});var Xl=Oe(),Bx=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.pool.write;this.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=Xl.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Xl.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e};ta.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Bx};function Gx(){Xl.channel.registerMonkeyPatch("mongodb-core",ta.mongoCore)}ta.enable=Gx});var Ag=d(Zt=>{"use strict";var xg=Zt&&Zt.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Zt,"__esModule",{value:!0});var it=Oe(),zx=function(e){var t=e.instrument({operationIdGenerator:{next:function(){return it.channel.bindToContext(function(n){return n()})}}}),r={};return t.on("started",function(n){r[n.requestId]||(r[n.requestId]=xg({},n,{time:new Date}))}),t.on("succeeded",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return it.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}):it.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}),t.on("failed",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return it.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}):it.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}),e},Qx=function(e){var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=it.channel.bindToContext(function(s){return s()}),r[i.requestId]=xg({},i,{time:new Date}))}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return it.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return it.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e},Xx=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=it.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=it.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e},Wx=function(e){Xx(e);var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=it.channel.bindToContext(function(s){return s()}),r[i.requestId]=i)}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return it.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return it.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e};Zt.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:zx};Zt.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:Qx};Zt.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:Wx};function Kx(){it.channel.registerMonkeyPatch("mongodb",Zt.mongo2),it.channel.registerMonkeyPatch("mongodb",Zt.mongo3),it.channel.registerMonkeyPatch("mongodb",Zt.mongo330)}Zt.enable=Kx});var Pg=d(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});var ou=Oe(),Rg=require("path"),Yx=function(e,t){var r=function(u,c){return function(l,f){var p=u[l];p&&(u[l]=function(){for(var v=arguments.length-1,T=arguments.length-1;T>=0;--T)if(typeof arguments[T]=="function"){v=T;break}else if(typeof arguments[T]<"u")break;var S=arguments[v],x={result:null,startTime:null,startDate:null};typeof S=="function"&&(f?(x.startTime=process.hrtime(),x.startDate=new Date,arguments[v]=ou.channel.bindToContext(f(x,S))):arguments[v]=ou.channel.bindToContext(S));var m=p.apply(this,arguments);return x.result=m,m})}},n=function(u,c){return r(u.prototype,c+".prototype")},i=["connect","changeUser","ping","statistics","end"],s=require(Rg.dirname(t)+"/lib/Connection");i.forEach(function(u){return n(s,"Connection")(u)}),r(s,"Connection")("createQuery",function(u,c){return function(l){var f=process.hrtime(u.startTime),p=f[0]*1e3+f[1]/1e6|0;ou.channel.publish("mysql",{query:u.result,callbackArgs:arguments,err:l,duration:p,time:u.startDate}),c.apply(this,arguments)}});var a=["_enqueueCallback"],o=require(Rg.dirname(t)+"/lib/Pool");return a.forEach(function(u){return n(o,"Pool")(u)}),e};ra.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:Yx};function Jx(){ou.channel.registerMonkeyPatch("mysql",ra.mysql)}ra.enable=Jx});var kg=d(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});var Dg=Oe();function Zx(e){var t=e.prototype.connect;return e.prototype.connect=function(n){return n&&(arguments[0]=Dg.channel.bindToContext(n)),t.apply(this,arguments)},e}na.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:Zx};function eA(){Dg.channel.registerMonkeyPatch("pg-pool",na.postgresPool1)}na.enable=eA});var Ng=d(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});var Oi=Oe(),Og=require("events");function tA(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},c=process.hrtime(),l;function f(p){p&&p[n]&&(p=p[n]);var h=Oi.channel.bindToContext(function(v,T){var S=process.hrtime(c);if(u.result=T&&{rowCount:T.rowCount,command:T.command},u.error=v,u.duration=Math.ceil(S[0]*1e3+S[1]/1e6),Oi.channel.publish("postgres",u),v){if(p)return p.apply(this,arguments);l&&l instanceof Og.EventEmitter&&l.emit("error",v)}else p&&p.apply(this,arguments)});try{return Object.defineProperty(h,n,{value:p}),h}catch{return p}}try{typeof s=="string"?a instanceof Array?(u.query.preparable={text:s,args:a},o=f(o)):(u.query.text=s,o?o=f(o):a=f(a)):(typeof s.name=="string"?u.query.plan=s.name:s.values instanceof Array?u.query.preparable={text:s.text,args:s.values}:u.query.text=s.text,o?o=f(o):a?a=f(a):s.callback=f(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,l=r.apply(this,arguments),l},e}function rA(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var u=this,c=!!o,l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},f=process.hrtime(),p;function h(v){v&&v[n]&&(v=v[n]);var T=Oi.channel.bindToContext(function(S,x){var m=process.hrtime(f);if(l.result=x&&{rowCount:x.rowCount,command:x.command},l.error=S,l.duration=Math.ceil(m[0]*1e3+m[1]/1e6),Oi.channel.publish("postgres",l),S){if(v)return v.apply(this,arguments);p&&p instanceof Og.EventEmitter&&p.emit("error",S)}else v&&v.apply(this,arguments)});try{return Object.defineProperty(T,n,{value:v}),T}catch{return v}}try{typeof s=="string"?a instanceof Array?(l.query.preparable={text:s,args:a},c=typeof o=="function",o=c?h(o):o):(l.query.text=s,o?(c=typeof o=="function",o=c?h(o):o):(c=typeof a=="function",a=c?h(a):a)):(typeof s.name=="string"?l.query.plan=s.name:s.values instanceof Array?l.query.preparable={text:s.text,args:s.values}:l.query.text=s.text,o?(c=typeof o=="function",o=h(o)):a?(c=typeof a=="function",a=c?h(a):a):(c=typeof s.callback=="function",s.callback=c?h(s.callback):s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,p=r.apply(this,arguments),c?p:p.then(function(v){return h()(void 0,v),new u._Promise(function(T,S){T(v)})}).catch(function(v){return h()(v,void 0),new u._Promise(function(T,S){S(v)})})},e}Rn.postgres6={versionSpecifier:"6.*",patch:tA};Rn.postgres7={versionSpecifier:">=7.* <=8.*",patch:rA};function nA(){Oi.channel.registerMonkeyPatch("pg",Rn.postgres6),Oi.channel.registerMonkeyPatch("pg",Rn.postgres7)}Rn.enable=nA});var qg=d(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});var Wl=Oe(),iA=function(e){var t=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var i=this.address,s=process.hrtime(),a=new Date;r.callback=Wl.channel.bindToContext(function(o,u){var c=process.hrtime(s),l=c[0]*1e3+c[1]/1e6|0;Wl.channel.publish("redis",{duration:l,address:i,commandObj:r,err:o,result:u,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return t.call(this,r)},e};ia.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:iA};function sA(){Wl.channel.registerMonkeyPatch("redis",ia.redis)}ia.enable=sA});var Lg=d(Pn=>{"use strict";var aA=Pn&&Pn.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Pn,"__esModule",{value:!0});var Kl=Oe(),oA=function(e){var t=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),o={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return Kl.channel.bindToContext(function(u,c,l){var f=process.hrtime(a);o=aA({},o,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!u&&{rowCount:c,rows:l},query:{text:this.parametersByName.statement.value},error:u,duration:Math.ceil(f[0]*1e3+f[1]/1e6)}),Kl.channel.publish("tedious",o),s.call(this,u,c,l)})}var i=arguments[0];arguments[0].callback=n(i.callback),t.apply(this,arguments)},e};Pn.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:oA};function uA(){Kl.channel.registerMonkeyPatch("tedious",Pn.tedious)}Pn.enable=uA});var Mg=d(er=>{"use strict";var cA=er&&er.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lA=er&&er.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(er,"__esModule",{value:!0});var uu=Oe(),fA=function(e){var t=e.Logger.prototype.log,r,n=function(i,s,a){var o;return r===e.config.npm.levels?o="npm":r===e.config.syslog.levels?o="syslog":o="unknown",uu.channel.publish("winston",{level:i,message:s,meta:a,levelKind:o}),s};return e.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),t.apply(this,arguments)},e},pA=function(e){var t=function(a,o){var u;return a.config.npm.levels[o]!=null?u="npm":a.config.syslog.levels[o]!=null?u="syslog":u="unknown",u},r=function(a){cA(o,a);function o(u,c){var l=a.call(this,c)||this;return l.winston=u,l}return o.prototype.log=function(u,c){var l=u.message,f=u.level,p=u.meta,h=lA(u,["message","level","meta"]);f=typeof Symbol.for=="function"?u[Symbol.for("level")]:f,l=u instanceof Error?u:l;var v=t(this.winston,f);p=p||{};for(var T in h)h.hasOwnProperty(T)&&(p[T]=h[T]);uu.channel.publish("winston",{message:l,level:f,levelKind:v,meta:p}),c()},o}(e.Transport);function n(){var a=arguments[0].levels||e.config.npm.levels,o;for(var u in a)a.hasOwnProperty(u)&&(o=o===void 0||a[u]>a[o]?u:o);this.add(new r(e,{level:o}))}var i=e.createLogger;e.createLogger=function(){var o=arguments[0].levels||e.config.npm.levels,u;for(var c in o)o.hasOwnProperty(c)&&(u=u===void 0||o[c]>o[u]?c:u);var l=i.apply(this,arguments);l.add(new r(e,{level:u}));var f=l.configure;return l.configure=function(){f.apply(this,arguments),n.apply(this,arguments)},l};var s=e.configure;return e.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},e.add(new r(e)),e};er.winston3={versionSpecifier:"3.x",patch:pA};er.winston2={versionSpecifier:"2.x",patch:fA};function dA(){uu.channel.registerMonkeyPatch("winston",er.winston2),uu.channel.registerMonkeyPatch("winston",er.winston3)}er.enable=dA});var Wg=d(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});var Hg=Cg();bt.azuresdk=Hg;var Fg=Ig();bt.bunyan=Fg;var jg=wg();bt.console=jg;var Ug=Sg();bt.mongodbCore=Ug;var $g=Ag();bt.mongodb=$g;var Vg=Pg();bt.mysql=Vg;var Bg=kg();bt.pgPool=Bg;var Gg=Ng();bt.pg=Gg;var zg=qg();bt.redis=zg;var Qg=Lg();bt.tedious=Qg;var Xg=Mg();bt.winston=Xg;function hA(){Fg.enable(),jg.enable(),Ug.enable(),$g.enable(),Vg.enable(),Gg.enable(),Bg.enable(),zg.enable(),Xg.enable(),Hg.enable(),Qg.enable()}bt.enable=hA});var fu=d(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});var vA=Xo(),Yl=Qe();Ni.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var Jl="DiagnosticChannel";if(Ni.IsInitialized){tr=Wg(),Kg=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",cu=Kg.split(","),Zl={bunyan:tr.bunyan,console:tr.console,mongodb:tr.mongodb,mongodbCore:tr.mongodbCore,mysql:tr.mysql,redis:tr.redis,pg:tr.pg,pgPool:tr.pgPool,winston:tr.winston,azuresdk:tr.azuresdk};for(lu in Zl)cu.indexOf(lu)===-1&&(Zl[lu].enable(),Yl.info(Jl,"Subscribed to "+lu+" events"));cu.length>0&&Yl.info(Jl,"Some modules will not be patched",cu)}else Yl.info(Jl,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var tr,Kg,cu,Zl,lu;function gA(e){if(!!Ni.IsInitialized){var t=Oe();t.channel.addContextPreservation(e),t.channel.spanContextPropagator=vA.AsyncScopeManager}}Ni.registerContextPreservation=gA});var qi=d((uj,Yg)=>{"use strict";Yg.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var kt=d((rf,Zg)=>{"use strict";var ef=rf&&rf.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},mA=require("http"),Jg=require("https"),tf=require("url"),pu=require("constants"),sa=Qe(),Li=qi(),yA=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&typeof r=="string")for(var i=t+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=e.trim(r),r&&r.indexOf(i)===0){n=r.substring(i.length,s[a].length);break}}return n},e.trim=function(t){return typeof t=="string"?t.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(t){var r=function(o,u){return String.fromCharCode(o>>u&255)},n=function(o){return r(o,24)+r(o,16)+r(o,8)+r(o,0)},i=t.map(n).join(""),s=Buffer.from?Buffer.from(i,"binary"):new Buffer(i,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,i=0;i<4;i++)n=e.random32(),r+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var s=t[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(t){return t.length===32&&t!=="00000000000000000000000000000000"},e.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"},e.isError=function(t){return t instanceof Error},e.isPrimitive=function(t){var r=typeof t;return r==="string"||r==="number"||r==="boolean"},e.isDate=function(t){return Object.prototype.toString.call(t)==="[object Date]"},e.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var r=(t/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i;var a=s>0?s+".":"";return a+i+":"+n+":"+r},e.extractError=function(t){var r=t;return{message:t.message,code:r.code||r.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):typeof t.toJSON=="function"?t.toJSON():t},e.validateStringMap=function(t){if(typeof t!="object"){sa.info("Invalid properties dropped from payload");return}var r={};for(var n in t){var i="",s=t[n],a=typeof s;if(e.isPrimitive(s))i=s.toString();else if(s===null||a==="undefined")i="";else if(a==="function"){sa.info("key: "+n+" was function; will not serialize");continue}else{var o=e.isArray(s)?s:e.extractObject(s);try{e.isPrimitive(o)?i=o:i=JSON.stringify(o)}catch(u){i=s.constructor.name.toString()+" (Error: "+u.message+")",sa.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,e.MAX_PROPERTY_LENGTH)}return r},e.canIncludeCorrelationHeader=function(t,r){var n=t&&t.config&&t.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var i=0;i<n.length;i++){var s=new RegExp(n[i].replace(/\./g,".").replace(/\*/g,".*"));if(s.test(tf.parse(r).hostname))return!1}return!0},e.getCorrelationContextTarget=function(t,r){var n=t.headers&&t.headers[Li.requestContextHeader];if(n)for(var i=n.split(","),s=0;s<i.length;++s){var a=i[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},e.makeRequest=function(t,r,n,i){r&&r.indexOf("//")===0&&(r="https:"+r);var s=tf.parse(r),a=ef({},n,{host:s.hostname,port:s.port,path:s.pathname}),o=void 0;if(s.protocol==="https:"&&(o=t.proxyHttpsUrl||void 0),s.protocol==="http:"&&(o=t.proxyHttpUrl||void 0),o){o.indexOf("//")===0&&(o="http:"+o);var u=tf.parse(o);u.protocol==="https:"?(sa.info("Proxies that use HTTPS are not supported"),o=void 0):a=ef({},a,{host:u.hostname,port:u.port||"80",path:r,headers:ef({},a.headers,{Host:s.hostname})})}var c=s.protocol==="https:"&&!o;return c&&t.httpsAgent!==void 0?a.agent=t.httpsAgent:!c&&t.httpAgent!==void 0?a.agent=t.httpAgent:c&&(a.agent=e.tlsRestrictedAgent),c?Jg.request(a,i):mA.request(a,i)},e.safeIncludeCorrelationHeader=function(t,r,n){var i;if(typeof n=="string")i=n;else if(n instanceof Array)i=n.join(",");else if(n&&typeof n.toString=="function")try{i=n.toString()}catch(s){sa.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}i?e.addCorrelationIdHeaderFromString(t,r,i):r.setHeader(Li.requestContextHeader,Li.requestContextSourceKey+"="+t.config.correlationId)},e.addCorrelationIdHeaderFromString=function(t,r,n){var i=n.split(","),s=Li.requestContextSourceKey+"=",a=i.some(function(o){return o.substring(0,s.length)===s});a||r.setHeader(Li.requestContextHeader,n+","+Li.requestContextSourceKey+"="+t.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new Jg.Agent({secureOptions:pu.SSL_OP_NO_SSLv2|pu.SSL_OP_NO_SSLv3|pu.SSL_OP_NO_TLSv1|pu.SSL_OP_NO_TLSv1_1}),e}();Zg.exports=yA});var Dn=d((cj,em)=>{"use strict";var du=kt(),nf=Qe(),_A=function(){function e(){}return e.queryCorrelationId=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(n)){r(e.completedLookups[n]);return}else if(e.pendingLookups[n]){e.pendingLookups[n].push(r);return}e.pendingLookups[n]=[r];var i=function(){if(!!e.pendingLookups[n]){var s={method:"GET",disableAppInsightsAutoCollection:!0};nf.info(e.TAG,s);var a=du.makeRequest(t,n,s,function(o){if(o.statusCode===200){var u="";o.setEncoding("utf-8"),o.on("data",function(c){u+=c}),o.on("end",function(){nf.info(e.TAG,u);var c=e.correlationIdPrefix+u;e.completedLookups[n]=c,e.pendingLookups[n]&&e.pendingLookups[n].forEach(function(l){return l(c)}),delete e.pendingLookups[n]})}else o.statusCode>=400&&o.statusCode<500?(e.completedLookups[n]=void 0,delete e.pendingLookups[n]):setTimeout(i,t.correlationIdRetryIntervalMs)});a&&(a.on("error",function(o){nf.warn(e.TAG,o)}),a.end())}};setTimeout(i,0)},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",i=e.pendingLookups[n];i&&(e.pendingLookups[n]=i.filter(function(s){return s!=r}),e.pendingLookups[n].length==0&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){t=t[0]=="|"?t:"|"+t,t[t.length-1]!=="."&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}else return e.generateRootId()},e.getRootId=function(t){var r=t.indexOf(".");r<0&&(r=t.length);var n=t[0]==="|"?1:0;return t.substring(n,r)},e.generateRootId=function(){return"|"+du.w3cTraceId()+"."},e.appendSuffix=function(t,r,n){if(t.length+r.length<e.requestIdMaxLength)return t+r+n;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var s=t[i-1];if(s==="."||s==="_")break}if(i<=1)return e.generateRootId();for(r=du.randomu32().toString(16);r.length<8;)r="0"+r;return t.substring(0,i)+r+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=du.randomu32(),e}();em.exports=_A});var aa=d((lj,tm)=>{"use strict";var Ye=kt(),EA=Dn(),CA=function(){function e(t,r){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&typeof t=="string")if(t.split(",").length>1)this.traceId=Ye.w3cTraceId(),this.spanId=Ye.w3cTraceId().substr(0,16);else{var n=t.trim().split("-"),i=n.length;i>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=Ye.w3cTraceId(),this.spanId=Ye.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=Ye.w3cTraceId()),this.version==="00"&&i!==4&&(this.traceId=Ye.w3cTraceId(),this.spanId=Ye.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=e.DEFAULT_VERSION,this.traceId=Ye.w3cTraceId(),this.spanId=Ye.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=Ye.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=Ye.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=Ye.w3cTraceId().substr(0,16),this.traceId=Ye.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=EA.getRootId(r);e.isValidTraceId(s)||(this.legacyRootId=s,s=Ye.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=Ye.w3cTraceId(),this.spanId=Ye.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&t!=="00000000000000000000000000000000"},e.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&t!=="0000000000000000"},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=Ye.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();tm.exports=CA});var sf=d((fj,rm)=>{"use strict";var TA=function(){function e(t){this.fieldmap=[],t&&(this.fieldmap=this.parseHeader(t))}return e.prototype.toString=function(){var t=this.fieldmap;return!t||t.length==0?null:t.join(", ")},e.validateKeyChars=function(t){var r=t.split("@");if(r.length==2){var n=r[0].trim(),i=r[1].trim(),s=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),a=Boolean(i.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return s&&a}else if(r.length==1)return Boolean(t.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},e.prototype.parseHeader=function(t){var r=[],n={},i=t.split(",");if(i.length>32)return null;for(var s=0,a=i;s<a.length;s++){var o=a[s],u=o.trim();if(u.length!==0){var c=u.split("=");if(c.length!==2||!e.validateKeyChars(c[0])||n[c[0]])return null;n[c[0]]=!0,r.push(u)}}return r},e.strict=!0,e}();rm.exports=TA});var Or=d((pj,nm)=>{"use strict";var IA=function(){function e(){}return e}();nm.exports=IA});var sm=d((af,im)=>{"use strict";var bA=af&&af.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wA=Or(),SA=function(e){bA(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(wA);im.exports=SA});var of=d((dj,am)=>{"use strict";var xA=function(){function e(){}return e}();am.exports=xA});var um=d((hj,om)=>{"use strict";var AA=function(){function e(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return e}();om.exports=AA});var lm=d((uf,cm)=>{"use strict";var RA=uf&&uf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),PA=of(),DA=function(e){RA(t,e);function t(){return e.call(this)||this}return t}(PA);cm.exports=DA});var lf=d((vj,fm)=>{"use strict";var cf;(function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"})(cf||(cf={}));fm.exports=cf});var dm=d((gj,pm)=>{"use strict";var kA=lf(),OA=function(){function e(){this.kind=kA.Measurement}return e}();pm.exports=OA});var vm=d((mj,hm)=>{"use strict";var NA=function(){function e(){this.ver=1,this.sampleRate=100,this.tags={}}return e}();hm.exports=NA});var pf=d((ff,gm)=>{"use strict";var qA=ff&&ff.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),LA=Or(),MA=function(e){qA(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(LA);gm.exports=MA});var ym=d((df,mm)=>{"use strict";var HA=df&&df.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),FA=Or(),jA=function(e){HA(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return t}(FA);mm.exports=jA});var Em=d((yj,_m)=>{"use strict";var UA=function(){function e(){this.hasFullStack=!0,this.parsedStack=[]}return e}();_m.exports=UA});var Tm=d((hf,Cm)=>{"use strict";var $A=hf&&hf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),VA=Or(),BA=function(e){$A(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r}return t}(VA);Cm.exports=BA});var bm=d((vf,Im)=>{"use strict";var GA=vf&&vf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zA=Or(),QA=function(e){GA(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return t}(zA);Im.exports=QA});var Sm=d((gf,wm)=>{"use strict";var XA=gf&&gf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),WA=pf(),KA=function(e){XA(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(WA);wm.exports=KA});var Am=d((mf,xm)=>{"use strict";var YA=mf&&mf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JA=Or(),ZA=function(e){YA(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return t}(JA);xm.exports=ZA});var Pm=d((yf,Rm)=>{"use strict";var eR=yf&&yf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tR=Or(),rR=function(e){eR(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(tR);Rm.exports=rR});var km=d((_j,Dm)=>{"use strict";var _f;(function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"})(_f||(_f={}));Dm.exports=_f});var Nm=d((Ej,Om)=>{"use strict";var nR=function(){function e(){}return e}();Om.exports=nR});var Ef=d(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.AvailabilityData=sm();je.Base=of();je.ContextTagKeys=um();je.Data=lm();je.DataPoint=dm();je.DataPointType=lf();je.Domain=Or();je.Envelope=vm();je.EventData=pf();je.ExceptionData=ym();je.ExceptionDetails=Em();je.MessageData=Tm();je.MetricData=bm();je.PageViewData=Sm();je.RemoteDependencyData=Am();je.RequestData=Pm();je.SeverityLevel=km();je.StackFrame=Nm()});var qm=d(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});var kn=Ef(),iR=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();hu.RemoteDependencyDataConstants=iR;function sR(e){return"properties"in e||e instanceof kn.EventData||e instanceof kn.ExceptionData||e instanceof kn.MessageData||e instanceof kn.MetricData||e instanceof kn.PageViewData||e instanceof kn.RemoteDependencyData||e instanceof kn.RequestData}hu.domainSupportsProperties=sR});var Lm=d(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});function aR(e){switch(e){case Je.Event:return"EventData";case Je.Exception:return"ExceptionData";case Je.Trace:return"MessageData";case Je.Metric:return"MetricData";case Je.Request:return"RequestData";case Je.Dependency:return"RemoteDependencyData";case Je.Availability:return"AvailabilityData";case Je.PageView:return"PageViewData"}}On.telemetryTypeToBaseType=aR;function oR(e){switch(e){case"EventData":return Je.Event;case"ExceptionData":return Je.Exception;case"MessageData":return Je.Trace;case"MetricData":return Je.Metric;case"RequestData":return Je.Request;case"RemoteDependencyData":return Je.Dependency;case"AvailabilityData":return Je.Availability;case"PageViewData":return Je.PageView}}On.baseTypeToTelemetryType=oR;On.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var Je;(function(e){e[e.Event=0]="Event",e[e.Exception=1]="Exception",e[e.Trace=2]="Trace",e[e.Metric=3]="Metric",e[e.Request=4]="Request",e[e.Dependency=5]="Dependency",e[e.Availability=6]="Availability",e[e.PageView=7]="PageView"})(Je=On.TelemetryType||(On.TelemetryType={}))});var Mm=d(vu=>{"use strict";function uR(e){for(var t in e)vu.hasOwnProperty(t)||(vu[t]=e[t])}Object.defineProperty(vu,"__esModule",{value:!0});uR(Lm())});var wt=d(gu=>{"use strict";function Cf(e){for(var t in e)gu.hasOwnProperty(t)||(gu[t]=e[t])}Object.defineProperty(gu,"__esModule",{value:!0});Cf(qm());Cf(Ef());Cf(Mm())});var Tf=d((Sj,Hm)=>{"use strict";var cR=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(t,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=t;var i=this.properties||{};if(r){if(typeof r=="string")i.error=r;else if(r instanceof Error)i.error=r.message;else if(typeof r=="object")for(var s in r)i[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=i},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();Hm.exports=cR});var wf=d((bf,jm)=>{"use strict";var lR=bf&&bf.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),mu=require("url"),fR=wt(),Fm=kt(),Nn=qi(),pR=Tf(),sn=Dn(),dR=sf(),If=aa(),hR=function(e){lR(t,e);function t(r,n){var i=e.call(this)||this;return r&&(i.method=r.method,i.url=i._getAbsoluteUrl(r),i.startTime=+new Date,i.socketRemoteAddress=r.socket&&r.socket.remoteAddress,i.parseHeaders(r,n),r.connection&&(i.connectionRemoteAddress=r.connection.remoteAddress,i.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),i}return t.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},t.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},t.prototype.getRequestTelemetry=function(r){var n={id:this.requestId,name:this.method+" "+mu.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?n.time=r.time:this.startTime&&(n.time=new Date(this.startTime)),r){for(var i in r)n[i]||(n[i]=r[i]);if(r.properties)for(var i in r.properties)n.properties[i]=r.properties[i]}return n},t.prototype.getRequestTags=function(r){var n={};for(var i in r)n[i]=r[i];return n[t.keys.locationIp]=r[t.keys.locationIp]||this._getIp(),n[t.keys.sessionId]=r[t.keys.sessionId]||this._getId("ai_session"),n[t.keys.userId]=r[t.keys.userId]||this._getId("ai_user"),n[t.keys.userAuthUserId]=r[t.keys.userAuthUserId]||this._getId("ai_authUser"),n[t.keys.operationName]=this.getOperationName(r),n[t.keys.operationParentId]=this.getOperationParentId(r),n[t.keys.operationId]=this.getOperationId(r),n},t.prototype.getOperationId=function(r){return r[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(r){return r[t.keys.operationParentId]||this.parentId||this.getOperationId(r)},t.prototype.getOperationName=function(r){return r[t.keys.operationName]||this.method+" "+mu.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,i=mu.parse(r.url),s=i.pathname,a=i.search,o=mu.format({protocol:n?"https":"http",host:r.headers.host,pathname:s,search:a});return o},t.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},i=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!i&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(i="127.0.0.1"),i},t.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",i=t.parseId(Fm.getCookie(r,n));return i},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=Fm.getCorrelationContextTarget(r,Nn.requestContextSourceKey),r.headers){var i=r.headers[Nn.traceStateHeader],s=r.headers[Nn.traceparentHeader],a=r.headers[Nn.requestIdHeader],o=r.headers[Nn.parentIdHeader],u=r.headers[Nn.rootIdHeader];this.correlationContextHeader=r.headers[Nn.correlationContextHeader],sn.w3cEnabled&&(s||i)?(this.traceparent=new If(s),this.tracestate=s&&i&&new dR(i),this.setBackCompatFromThisTraceContext()):a?sn.w3cEnabled?(this.traceparent=new If(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=sn.generateRequestId(this.parentId),this.operationId=sn.getRootId(this.requestId)):sn.w3cEnabled?(this.traceparent=new If,this.traceparent.parentId=o,this.traceparent.legacyRootId=u||o,this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=sn.generateRequestId(u||this.parentId),this.correlationContextHeader=null,this.operationId=sn.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=sn.getRootId(this.requestId))}},t.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},t.keys=new fR.ContextTagKeys,t}(pR);jm.exports=hR});var yu=d((xj,Vm)=>{"use strict";function Sf(e){return typeof e=="function"}var vt=console.error.bind(console);function oa(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function ua(e){e&&e.logger&&(Sf(e.logger)?vt=e.logger:vt("new logger isn't a function, not replacing"))}function Um(e,t,r){if(!e||!e[t]){vt("no original function "+t+" to wrap");return}if(!r){vt("no wrapper function"),vt(new Error().stack);return}if(!Sf(e[t])||!Sf(r)){vt("original object and wrapper must be functions");return}var n=e[t],i=r(n,t);return oa(i,"__original",n),oa(i,"__unwrap",function(){e[t]===i&&oa(e,t,n)}),oa(i,"__wrapped",!0),oa(e,t,i),i}function vR(e,t,r){if(e)Array.isArray(e)||(e=[e]);else{vt("must provide one or more modules to patch"),vt(new Error().stack);return}if(!(t&&Array.isArray(t))){vt("must provide one or more functions to wrap on modules");return}e.forEach(function(n){t.forEach(function(i){Um(n,i,r)})})}function $m(e,t){if(!e||!e[t]){vt("no function to unwrap."),vt(new Error().stack);return}if(!e[t].__unwrap)vt("no original to unwrap to -- has "+t+" already been unwrapped?");else return e[t].__unwrap()}function gR(e,t){if(e)Array.isArray(e)||(e=[e]);else{vt("must provide one or more modules to patch"),vt(new Error().stack);return}if(!(t&&Array.isArray(t))){vt("must provide one or more functions to unwrap on modules");return}e.forEach(function(r){t.forEach(function(n){$m(r,n)})})}ua.wrap=Um;ua.massWrap=vR;ua.unwrap=$m;ua.massUnwrap=gR;Vm.exports=ua});var Cu=d((Aj,Qm)=>{"use strict";var Gm=yu(),Mi=Gm.wrap,_u=Gm.unwrap,Nr="wrap@before";function Eu(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function mR(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n],s=e[Nr];if(typeof s=="function")s(i);else if(Array.isArray(s))for(var a=s.length,o=0;o<a;o++)s[o](i)}}function zm(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r?r=[r]:r=[]),r}function yR(e,t,r){var n=zm(e,t),i=n.filter(function(s){return r.indexOf(s)===-1});i.length>0&&mR(e,i)}function Bm(e,t){if(!!e){var r=e;if(typeof e=="function")r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}Qm.exports=function(t,r,n){if(!t||!t.on||!t.addListener||!t.removeListener||!t.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function i(a){return function(u,c){var l=zm(this,u).slice();try{var f=a.call(this,u,c);return yR(this,u,l),f}finally{this.on.__wrapped||Mi(this,"on",i),this.addListener.__wrapped||Mi(this,"addListener",i)}}}function s(a){return function(u){if(!this._events||!this._events[u])return a.apply(this,arguments);var c=this._events[u];function l(f){return function(){this._events[u]=c;try{return f.apply(this,arguments)}finally{c=this._events[u],this._events[u]=Bm(c,n)}}}Mi(this,"removeListener",l);try{return this._events[u]=Bm(c,n),a.apply(this,arguments)}finally{_u(this,"removeListener"),this._events[u]=c}}}t[Nr]?typeof t[Nr]=="function"?Eu(t,Nr,[t[Nr],r]):Array.isArray(t[Nr])&&t[Nr].push(r):Eu(t,Nr,r),t.__wrapped||(Mi(t,"addListener",i),Mi(t,"on",i),Mi(t,"emit",s),Eu(t,"__unwrap",function(){_u(t,"addListener"),_u(t,"on"),_u(t,"emit"),delete t[Nr],delete t.__wrapped}),Eu(t,"__wrapped",!0))}});var Ym=d((Rj,Km)=>{"use strict";var re=require("util"),qr=require("assert"),_R=Cu(),_e=require("async_hooks"),ca="cls@contexts",la="error@context",be=process.env.DEBUG_CLS_HOOKED,te=-1;Km.exports={getNamespace:Xm,createNamespace:ER,destroyNamespace:Wm,reset:CR,ERROR_SYMBOL:la};function Ft(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}Ft.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[t]=r,be){let n=" ".repeat(this._indent<0?0:this._indent);Ce(n+"CONTEXT-SET KEY:"+t+"="+r+" in ns:"+this.name+" currentUid:"+te+" active:"+re.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};Ft.prototype.get=function(t){if(!this.active){if(be){let r=_e.currentId(),n=_e.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Ce(`${i}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${t}=undefined currentUid:${te} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(be){let r=_e.executionAsyncId(),n=_e.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Ce(i+"CONTEXT-GETTING KEY:"+t+"="+this.active[t]+" ("+this.name+") currentUid:"+te+" active:"+re.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),Ce(`${i}CONTEXT-GETTING KEY: (${this.name}) ${t}=${this.active[t]} currentUid:${te} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${re.inspect(this.active)}`)}return this.active[t]};Ft.prototype.createContext=function(){let t=Object.create(this.active?this.active:Object.prototype);if(t._ns_name=this.name,t.id=te,be){let r=_e.executionAsyncId(),n=_e.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Ce(`${i}CONTEXT-CREATED Context: (${this.name}) currentUid:${te} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${re.inspect(t,{showHidden:!0,depth:2,colors:!0})}`)}return t};Ft.prototype.run=function(t){let r=this.createContext();this.enter(r);try{if(be){let n=_e.triggerAsyncId(),i=_e.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Ce(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${te} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} context:${re.inspect(r)}`)}return t(r),r}catch(n){throw n&&(n[la]=r),n}finally{if(be){let n=_e.triggerAsyncId(),i=_e.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Ce(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${te} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} ${re.inspect(r)}`)}this.exit(r)}};Ft.prototype.runAndReturn=function(t){let r;return this.run(function(n){r=t(n)}),r};Ft.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return be&&Ce("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+te+" len:"+this._set.length+" "+re.inspect(r)),n.then(i=>(be&&Ce("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+te+" len:"+this._set.length+" "+re.inspect(r)),this.exit(r),i)).catch(i=>{throw i[la]=r,be&&Ce("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+te+" len:"+this._set.length+" "+re.inspect(r)),this.exit(r),i})};Ft.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[la]=r),s}finally{n.exit(r)}}};Ft.prototype.enter=function(t){if(qr.ok(t,"context must be provided for entering"),be){let r=_e.executionAsyncId(),n=_e.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Ce(`${i}CONTEXT-ENTER: (${this.name}) currentUid:${te} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${re.inspect(t)}`)}this._set.push(this.active),this.active=t};Ft.prototype.exit=function(t){if(qr.ok(t,"context must be provided for exiting"),be){let n=_e.executionAsyncId(),i=_e.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Ce(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${te} triggerId:${i} asyncHooksCurrentId:${n} len:${this._set.length} ${re.inspect(t)}`)}if(this.active===t){qr.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(be&&Ce("??ERROR?? context exiting but not entered - ignoring: "+re.inspect(t)),qr.ok(r>=0,`context not currently entered; can't exit. 
`+re.inspect(this)+`
`+re.inspect(t))):(qr.ok(r,"can't remove top context"),this._set.splice(r,1))};Ft.prototype.bindEmitter=function(t){qr.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[ca]||(a[ca]=Object.create(null)),a[ca][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[ca]))return a;let o=a,u=a[ca];return Object.keys(u).forEach(function(c){let l=u[c];o=l.namespace.bind(o,l.context)}),o}_R(t,i,s)};Ft.prototype.fromException=function(t){return t[la]};function Xm(e){return process.namespaces[e]}function ER(e){qr.ok(e,"namespace must be given a name."),be&&Ce(`NS-CREATING NAMESPACE (${e})`);let t=new Ft(e);return t.id=te,_e.createHook({init(n,i,s,a){if(te=_e.executionAsyncId(),t.active){if(t._contexts.set(n,t.active),be){let o=" ".repeat(t._indent<0?0:t._indent);Ce(`${o}INIT [${i}] (${e}) asyncId:${n} currentUid:${te} triggerId:${s} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(te===0){let o=_e.triggerAsyncId(),u=t._contexts.get(o);if(u){if(t._contexts.set(n,u),be){let c=" ".repeat(t._indent<0?0:t._indent);Ce(`${c}INIT USING CONTEXT FROM TRIGGERID [${i}] (${e}) asyncId:${n} currentUid:${te} triggerId:${o} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(be){let c=" ".repeat(t._indent<0?0:t._indent);Ce(`${c}INIT MISSING CONTEXT [${i}] (${e}) asyncId:${n} currentUid:${te} triggerId:${o} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(be&&i==="PROMISE"){Ce(re.inspect(a,{showHidden:!0}));let o=a.parentId,u=" ".repeat(t._indent<0?0:t._indent);Ce(`${u}INIT RESOURCE-PROMISE [${i}] (${e}) parentId:${o} asyncId:${n} currentUid:${te} triggerId:${s} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){te=_e.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(te),i){if(be){let s=_e.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);Ce(`${a}BEFORE (${e}) asyncId:${n} currentUid:${te} triggerId:${s} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${re.inspect(i)}`),t._indent+=2}t.enter(i)}else if(be){let s=_e.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);Ce(`${a}BEFORE MISSING CONTEXT (${e}) asyncId:${n} currentUid:${te} triggerId:${s} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${re.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(n){te=_e.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(te),i){if(be){let s=_e.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);Ce(`${a}AFTER (${e}) asyncId:${n} currentUid:${te} triggerId:${s} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${re.inspect(i)}`)}t.exit(i)}else if(be){let s=_e.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);Ce(`${a}AFTER MISSING CONTEXT (${e}) asyncId:${n} currentUid:${te} triggerId:${s} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${re.inspect(i)}`)}},destroy(n){if(te=_e.executionAsyncId(),be){let i=_e.triggerAsyncId(),s=" ".repeat(t._indent<0?0:t._indent);Ce(`${s}DESTROY (${e}) currentUid:${te} asyncId:${n} triggerId:${i} active:${re.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${re.inspect(t._contexts.get(te))}`)}t._contexts.delete(n)}}).enable(),process.namespaces[e]=t,t}function Wm(e){let t=Xm(e);qr.ok(t,`can't delete nonexistent namespace! "`+e+'"'),qr.ok(t.id,"don't assign to process.namespaces directly! "+re.inspect(t)),process.namespaces[e]=null}function CR(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Wm(e)}),process.namespaces=Object.create(null)}process.namespaces={};function Ce(...e){be&&process._rawDebug(`${re.format(...e)}`)}});var Zm=d((Pj,Jm)=>{"use strict";function TR(){}Jm.exports=function(){let t=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let u=0;u<arguments.length;u++)i[u]=arguments[u];let s=i[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new TR,o=--r.counter;return t.init.call(a,o,0,null,null),i[0]=function(){t.pre.call(a,o);let u=!0;try{s.apply(this,arguments),u=!1}finally{u&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(a,o,!0),t.destroy.call(null,o)})}t.post.call(a,o,!1),t.destroy.call(null,o)},n.apply(process,i)}}});var ty=d((Dj,ey)=>{"use strict";function IR(){}ey.exports=function(){let t=this._hooks,r=this._state,n=global.Promise,i=n.prototype.then;n.prototype.then=u;function s(c,l,f,p){return typeof c!="function"?p?a(f):o(f):function(){t.pre.call(l,f);try{return c.apply(this,arguments)}finally{t.post.call(l,f,!1),t.destroy.call(null,f)}}}function a(c){return function(f){return t.destroy.call(null,c),f}}function o(c){return function(f){throw t.destroy.call(null,c),f}}function u(c,l){if(!r.enabled)return i.call(this,c,l);let f=new IR,p=--r.counter;return t.init.call(f,p,0,null,null),i.call(this,s(c,f,p,!0),s(l,f,p,!1))}}});var ny=d((kj,ry)=>{"use strict";var Ot=require("timers");function bR(){}function wR(){}function SR(){}var xR=new Map,AR=new Map,RR=new Map,xf=null,Af=!1;ry.exports=function(){Rf(this._hooks,this._state,"setTimeout","clearTimeout",bR,xR,!0),Rf(this._hooks,this._state,"setInterval","clearInterval",wR,AR,!1),Rf(this._hooks,this._state,"setImmediate","clearImmediate",SR,RR,!0),global.setTimeout=Ot.setTimeout,global.setInterval=Ot.setInterval,global.setImmediate=Ot.setImmediate,global.clearTimeout=Ot.clearTimeout,global.clearInterval=Ot.clearInterval,global.clearImmediate=Ot.clearImmediate};function Rf(e,t,r,n,i,s,a){let o=Ot[r],u=Ot[n];Ot[r]=function(){if(!t.enabled)return o.apply(Ot,arguments);let c=new Array(arguments.length);for(let v=0;v<arguments.length;v++)c[v]=arguments[v];let l=c[0];if(typeof l!="function")throw new TypeError('"callback" argument must be a function');let f=new i,p=--t.counter,h;return e.init.call(f,p,0,null,null),c[0]=function(){xf=h,e.pre.call(f,p);let v=!0;try{l.apply(this,arguments),v=!1}finally{v&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(f,p,!0),s.delete(h),e.destroy.call(null,p)})}e.post.call(f,p,!1),xf=null,(a||Af)&&(Af=!1,s.delete(h),e.destroy.call(null,p))},h=o.apply(Ot,c),s.set(h,p),h},Ot[n]=function(c){if(xf===c&&c!==null)Af=!0;else if(s.has(c)){let l=s.get(c);s.delete(c),e.destroy.call(null,l)}u.apply(Ot,arguments)}}});var Pf=d((Oj,PR)=>{PR.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}});var ay=d((Nj,sy)=>{"use strict";var pa=process.binding("async_wrap"),DR=pa.Providers.TIMERWRAP,iy={nextTick:Zm(),promise:ty(),timers:ny()},fa=new Set;function kR(){this.enabled=!1,this.counter=0}function Df(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(i,s,a,o){if(s===DR){fa.add(i);return}for(let u of e)u(i,this,s,a,o)},this.pre=function(i){if(!fa.has(i))for(let s of t)s(i,this)},this.post=function(i,s){if(!fa.has(i))for(let a of r)a(i,this,s)},this.destroy=function(i){if(fa.has(i)){fa.delete(i);return}for(let s of n)s(i)}}Df.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)};function Tu(e,t){let r=e.indexOf(t);r!==-1&&e.splice(r,1)}Df.prototype.remove=function(e){e.init&&Tu(this.initFns,e.init),e.pre&&Tu(this.preFns,e.pre),e.post&&Tu(this.postFns,e.post),e.destroy&&Tu(this.destroyFns,e.destroy)};function da(){this._state=new kR,this._hooks=new Df,this.version=Pf().version,this.providers=pa.Providers;for(let e of Object.keys(iy))iy[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),pa.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}sy.exports=da;da.prototype.addHooks=function(e){this._hooks.add(e)};da.prototype.removeHooks=function(e){this._hooks.remove(e)};da.prototype.enable=function(){this._state.enabled=!0,pa.enable()};da.prototype.disable=function(){this._state.enabled=!1,pa.disable()}});var kf=d((qj,OR)=>{OR.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}});var uy=d((Lj,oy)=>{function NR(e){try{return Error.prototype.toString.call(e)}catch(t){try{return"<error: "+t+">"}catch{return"<error>"}}}oy.exports=function(t,r){var n=[];n.push(NR(t));for(var i=0;i<r.length;i++){var s=r[i],a;try{a=s.toString()}catch(o){try{a="<error: "+o+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var py=d((Mj,fy)=>{var Iu=uy();function ly(){this.extend=new ha,this.filter=new ha,this.format=new va,this.version=kf().version}var Nf=!1;ly.prototype.callSite=function e(t){t||(t={}),Nf=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return Nf=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var an=new ly;function ha(){this._modifiers=[]}ha.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t};ha.prototype.attach=function(e){this._modifiers.push(e)};ha.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return t===-1?!1:(this._modifiers.splice(t,1),!0)};function va(){this._formater=Iu,this._previous=void 0}va.prototype.replace=function(e){e?this._formater=e:this.restore()};va.prototype.restore=function(){this._formater=Iu,this._previous=void 0};va.prototype._backup=function(){this._previous=this._formater};va.prototype._roolback=function(){this._previous===Iu?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&an.format.replace(Error.prepareStackTrace);var Of=!1;function cy(e,t){if(Nf)return t;if(Of)return Iu(e,t);var r=t.concat();r=an.extend._modify(e,r),r=an.filter._modify(e,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&Object.getOwnPropertyDescriptor(e,"callSite")===void 0&&(e.callSite={original:t,mutated:r}),Of=!0;var n=an.format._formater(e,r);return Of=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return cy},set:function(e){e===cy?an.format._roolback():(an.format._backup(),an.format.replace(e))}});function qR(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:qR,set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0});fy.exports=an});var Lf=d((Hj,qf)=>{if(global._stackChain)if(global._stackChain.version===kf().version)qf.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else qf.exports=global._stackChain=py()});var dy=d((Fj,Mf)=>{"use strict";var LR=ay();if(global._asyncHook)if(global._asyncHook.version===Pf().version)Mf.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else Lf().filter.attach(function(t,r){return r.filter(function(n){let i=n.getFileName();return!(i&&i.slice(0,__dirname.length)===__dirname)})}),Mf.exports=global._asyncHook=new LR});var _y=d((jj,yy)=>{"use strict";var qe=require("util"),Lr=require("assert"),MR=Cu(),Hi=dy(),ga="cls@contexts",ma="error@context",vy=[];for(let e in Hi.providers)vy[Hi.providers[e]]=e;var De=process.env.DEBUG_CLS_HOOKED,Ue=-1;yy.exports={getNamespace:gy,createNamespace:HR,destroyNamespace:my,reset:FR,ERROR_SYMBOL:ma};function jt(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}jt.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return De&&Ne("    SETTING KEY:"+t+"="+r+" in ns:"+this.name+" uid:"+Ue+" active:"+qe.inspect(this.active,!0)),this.active[t]=r,r};jt.prototype.get=function(t){if(!this.active){De&&Ne("    GETTING KEY:"+t+"=undefined "+this.name+" uid:"+Ue+" active:"+qe.inspect(this.active,!0));return}return De&&Ne("    GETTING KEY:"+t+"="+this.active[t]+" "+this.name+" uid:"+Ue+" active:"+qe.inspect(this.active,!0)),this.active[t]};jt.prototype.createContext=function(){De&&Ne("   CREATING Context: "+this.name+" uid:"+Ue+" len:"+this._set.length+"  active:"+qe.inspect(this.active,!0,2,!0));let t=Object.create(this.active?this.active:Object.prototype);return t._ns_name=this.name,t.id=Ue,De&&Ne("   CREATED Context: "+this.name+" uid:"+Ue+" len:"+this._set.length+"  context:"+qe.inspect(t,!0,2,!0)),t};jt.prototype.run=function(t){let r=this.createContext();this.enter(r);try{return De&&Ne(" BEFORE RUN: "+this.name+" uid:"+Ue+" len:"+this._set.length+" "+qe.inspect(r)),t(r),r}catch(n){throw n&&(n[ma]=r),n}finally{De&&Ne(" AFTER RUN: "+this.name+" uid:"+Ue+" len:"+this._set.length+" "+qe.inspect(r)),this.exit(r)}};jt.prototype.runAndReturn=function(t){var r;return this.run(function(n){r=t(n)}),r};jt.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return De&&Ne(" BEFORE runPromise: "+this.name+" uid:"+Ue+" len:"+this._set.length+" "+qe.inspect(r)),n.then(i=>(De&&Ne(" AFTER runPromise: "+this.name+" uid:"+Ue+" len:"+this._set.length+" "+qe.inspect(r)),this.exit(r),i)).catch(i=>{throw i[ma]=r,De&&Ne(" AFTER runPromise: "+this.name+" uid:"+Ue+" len:"+this._set.length+" "+qe.inspect(r)),this.exit(r),i})};jt.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[ma]=r),s}finally{n.exit(r)}}};jt.prototype.enter=function(t){Lr.ok(t,"context must be provided for entering"),De&&Ne("  ENTER "+this.name+" uid:"+Ue+" len:"+this._set.length+" context: "+qe.inspect(t)),this._set.push(this.active),this.active=t};jt.prototype.exit=function(t){if(Lr.ok(t,"context must be provided for exiting"),De&&Ne("  EXIT "+this.name+" uid:"+Ue+" len:"+this._set.length+" context: "+qe.inspect(t)),this.active===t){Lr.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(De&&Ne("??ERROR?? context exiting but not entered - ignoring: "+qe.inspect(t)),Lr.ok(r>=0,`context not currently entered; can't exit. 
`+qe.inspect(this)+`
`+qe.inspect(t))):(Lr.ok(r,"can't remove top context"),this._set.splice(r,1))};jt.prototype.bindEmitter=function(t){Lr.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[ga]||(a[ga]=Object.create(null)),a[ga][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[ga]))return a;let o=a,u=a[ga];return Object.keys(u).forEach(function(c){let l=u[c];o=l.namespace.bind(o,l.context)}),o}MR(t,i,s)};jt.prototype.fromException=function(t){return t[ma]};function gy(e){return process.namespaces[e]}function HR(e){Lr.ok(e,"namespace must be given a name."),De&&Ne("CREATING NAMESPACE "+e);let t=new jt(e);return t.id=Ue,Hi.addHooks({init(r,n,i,s,a){Ue=r,s?(t._contexts.set(r,t._contexts.get(s)),De&&Ne("PARENTID: "+e+" uid:"+r+" parent:"+s+" provider:"+i)):t._contexts.set(Ue,t.active),De&&Ne("INIT "+e+" uid:"+r+" parent:"+s+" provider:"+vy[i]+" active:"+qe.inspect(t.active,!0))},pre(r,n){Ue=r;let i=t._contexts.get(r);i?(De&&Ne(" PRE "+e+" uid:"+r+" handle:"+bu(n)+" context:"+qe.inspect(i)),t.enter(i)):De&&Ne(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+bu(n))},post(r,n){Ue=r;let i=t._contexts.get(r);i?(De&&Ne(" POST "+e+" uid:"+r+" handle:"+bu(n)+" context:"+qe.inspect(i)),t.exit(i)):De&&Ne(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+bu(n))},destroy(r){Ue=r,De&&Ne("DESTROY "+e+" uid:"+r+" context:"+qe.inspect(t._contexts.get(Ue))+" active:"+qe.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t}function my(e){let t=gy(e);Lr.ok(t,`can't delete nonexistent namespace! "`+e+'"'),Lr.ok(t.id,"don't assign to process.namespaces directly! "+qe.inspect(t)),process.namespaces[e]=null}function FR(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){my(e)}),process.namespaces=Object.create(null)}process.namespaces={};Hi._state&&!Hi._state.enabled&&Hi.enable();function Ne(e){process.env.DEBUG&&process._rawDebug(e)}function bu(e){if(!e)return e;if(typeof e=="function")return e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(e.constructor&&e.constructor.name)return e.constructor.name}if(De){Hf=Lf();for(hy in Hf.filter._modifiers)Hf.filter.deattach(hy)}var Hf,hy});var Ey=d((Uj,Ff)=>{"use strict";var jR=iu();process&&jR.gte(process.versions.node,"8.0.0")?Ff.exports=Ym():Ff.exports=_y()});var Iy=d(($j,Ty)=>{var UR=yu().wrap,Uf=1<<0,$f=1<<1,Vf=1<<2,Su=1<<3,fe=[],$R=0,st=!1,on=[],Fi,Bf;function Gf(e,t){var r=e.length,n=t.length,i=[];if(r===0&&n===0)return i;for(var s=0;s<r;s++)i[s]=e[s];if(n===0)return i;for(var a=0;a<n;a++){var o=!0;for(s=0;s<r;s++)if(e[s].uid===t[a].uid){o=!1;break}o&&i.push(t[a])}return i}process._fatalException?(wu=!1,Fi=function(t){var r=fe.length;if(wu||r===0)return!1;var n=!1;wu=!0;for(var i=0;i<r;++i){var s=fe[i];if((s.flags&Su)!==0){var a=ji&&ji[s.uid];n=s.error(a,t)||n}}return wu=!1,on.length>0&&(fe=on.pop()),ji=void 0,n&&!st},Bf=function(t,r,n){var i=[];st=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Uf)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return st=!1,function(){ji=i,on.push(fe),fe=Gf(r,fe),st=!0;for(var u=0;u<n;++u)(r[u].flags&$f)>0&&r[u].before(this,i[r[u].uid]);st=!1;var c=t.apply(this,arguments);for(st=!0,u=0;u<n;++u)(r[u].flags&Vf)>0&&r[u].after(this,i[r[u].uid]);return st=!1,fe=on.pop(),ji=void 0,c}},UR(process,"_fatalException",function(e){return function(r){return Fi(r)||e(r)}})):(jf=!1,Fi=function(t){if(jf)throw t;for(var r=!1,n=fe.length,i=0;i<n;++i){var s=fe[i];(s.flags&Su)!==0&&(r=s.error(null,t)||r)}if(!r&&st)throw t},Bf=function(t,r,n){var i=[];st=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Uf)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return st=!1,function(){var u=!1,c=!1;on.push(fe),fe=Gf(r,fe),st=!0;for(var l=0;l<n;++l)(r[l].flags&$f)>0&&r[l].before(this,i[r[l].uid]);st=!1;var f;try{f=t.apply(this,arguments)}catch(p){u=!0;for(var l=0;l<n;++l)if((fe[l].flags&Su)!=0)try{c=fe[l].error(i[r[l].uid],p)||c}catch(v){throw jf=!0,v}if(!c)throw process.removeListener("uncaughtException",Fi),process._originalNextTick(function(){process.addListener("uncaughtException",Fi)}),p}finally{if(!u||c){for(st=!0,l=0;l<n;++l)(r[l].flags&Vf)>0&&r[l].after(this,i[r[l].uid]);st=!1}fe=on.pop()}return f}},process.addListener("uncaughtException",Fi));var wu,ji,jf;function VR(e,t,r){st=!0;for(var n=0;n<r;++n){var i=t[n];i.create&&i.create(i.data)}return st=!1,function(){on.push(fe),fe=Gf(t,fe);var s=e.apply(this,arguments);return fe=on.pop(),s}}function BR(e){var t=fe.length;if(t===0)return e;for(var r=fe.slice(),n=0;n<t;++n)if(r[n].flags>0)return Bf(e,r,t);return VR(e,r,t)}function gr(e,t){typeof e.create=="function"&&(this.create=e.create,this.flags|=Uf),typeof e.before=="function"&&(this.before=e.before,this.flags|=$f),typeof e.after=="function"&&(this.after=e.after,this.flags|=Vf),typeof e.error=="function"&&(this.error=e.error,this.flags|=Su),this.uid=++$R,this.data=t===void 0?null:t}gr.prototype.create=void 0;gr.prototype.before=void 0;gr.prototype.after=void 0;gr.prototype.error=void 0;gr.prototype.data=void 0;gr.prototype.uid=0;gr.prototype.flags=0;function Cy(e,t){if(typeof e!="object"||!e)throw new TypeError("callbacks argument must be an object");return e instanceof gr?e:new gr(e,t)}function GR(e,t){var r;e instanceof gr?r=e:r=Cy(e,t);for(var n=!1,i=0;i<fe.length;i++)if(r===fe[i]){n=!0;break}return n||fe.push(r),r}function zR(e){for(var t=0;t<fe.length;t++)if(e===fe[t]){fe.splice(t,1);break}}process.createAsyncListener=Cy;process.addAsyncListener=GR;process.removeAsyncListener=zR;Ty.exports=BR});var wy=d((Bj,by)=>{"use strict";by.exports=(e,t)=>class extends e{constructor(n){var i,s;super(o);var a=this;try{n.apply(i,s)}catch(u){s[1](u)}return a;function o(u,c){i=this,s=[l,f];function l(p){return t(a,!1),u(p)}function f(p){return t(a,!1),c(p)}}}}});var ky=d(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var Ry=yu(),Au=iu(),St=Ry.wrap,un=Ry.massWrap,we=Iy(),QR=require("util"),XR=Au.gte(process.version,"6.0.0"),Xf=Au.gte(process.version,"7.0.0"),WR=Au.gte(process.version,"8.0.0"),KR=Au.gte(process.version,"11.0.0"),mr=require("net");Xf&&!mr._normalizeArgs?mr._normalizeArgs=function(e){if(e.length===0)return[{},null];var t=e[0],r={};typeof t=="object"&&t!==null?r=t:tP(t)?r.path=t:(r.port=t,e.length>1&&typeof e[1]=="string"&&(r.host=e[1]));var n=e[e.length-1];return typeof n!="function"?[r,null]:[r,n]}:!Xf&&!mr._normalizeConnectArgs&&(mr._normalizeConnectArgs=function(e){var t={};function r(i){return(i=Number(i))>=0?i:!1}typeof e[0]=="object"&&e[0]!==null?t=e[0]:typeof e[0]=="string"&&r(e[0])===!1?t.path=e[0]:(t.port=e[0],typeof e[1]=="string"&&(t.host=e[1]));var n=e[e.length-1];return typeof n=="function"?[t,n]:[t]});"_setUpListenHandle"in mr.Server.prototype?St(mr.Server.prototype,"_setUpListenHandle",Sy):St(mr.Server.prototype,"_listen2",Sy);function Sy(e){return function(){this.on("connection",function(t){t._handle&&(t._handle.onread=we(t._handle.onread))});try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=we(this._handle.onconnection))}}}function Py(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=we(t._originalOnread)}}St(mr.Socket.prototype,"connect",function(e){return function(){var t;WR&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?t=arguments[0]:t=Xf?mr._normalizeArgs(arguments):mr._normalizeConnectArgs(arguments),t[1]&&(t[1]=we(t[1]));var r=e.apply(this,t);return Py(this),r}});var YR=require("http");St(YR.Agent.prototype,"addRequest",function(e){return function(t){var r=t.onSocket;return t.onSocket=we(function(n){return Py(n),r.apply(this,arguments)}),e.apply(this,arguments)}});var zf=require("child_process");function xy(e){Array.isArray(e.stdio)&&e.stdio.forEach(function(t){t&&t._handle&&(t._handle.onread=we(t._handle.onread),St(t._handle,"close",Ru))}),e._handle&&(e._handle.onexit=we(e._handle.onexit))}zf.ChildProcess?St(zf.ChildProcess.prototype,"spawn",function(e){return function(){var t=e.apply(this,arguments);return xy(this),t}}):un(zf,["execFile","fork","spawn"],function(e){return function(){var t=e.apply(this,arguments);return xy(t),t}});process._fatalException||(process._originalNextTick=process.nextTick);var Yf=[];process._nextDomainTick&&Yf.push("_nextDomainTick");process._tickDomainCallback&&Yf.push("_tickDomainCallback");un(process,Yf,yr);St(process,"nextTick",Ru);var Jf=["setTimeout","setInterval"];global.setImmediate&&Jf.push("setImmediate");var Dy=require("timers"),JR=global.setTimeout===Dy.setTimeout;un(Dy,Jf,Ru);JR&&un(global,Jf,Ru);var Wf=require("dns");un(Wf,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],yr);Wf.resolveNaptr&&St(Wf,"resolveNaptr",yr);var Ln=require("fs");un(Ln,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],yr);Ln.lchown&&St(Ln,"lchown",yr);Ln.lchmod&&St(Ln,"lchmod",yr);Ln.ftruncate&&St(Ln,"ftruncate",yr);var ya;try{ya=require("zlib")}catch{}ya&&ya.Deflate&&ya.Deflate.prototype&&(qn=Object.getPrototypeOf(ya.Deflate.prototype),qn._transform?St(qn,"_transform",yr):qn.write&&qn.flush&&qn.end&&un(qn,["write","flush","end"],yr));var qn,Kf;try{Kf=require("crypto")}catch{}Kf&&(Qf=["pbkdf2","randomBytes"],KR||Qf.push("pseudoRandomBytes"),un(Kf,Qf,yr));var Qf,xu=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";xu&&(Ay=process.addAsyncListener({create:function(){xu=!1}}),global.Promise.resolve(!0).then(function(){xu=!1}),process.removeAsyncListener(Ay));var Ay;xu&&ZR();function ZR(){var e=global.Promise;function t(a){if(!(this instanceof t))return e(a);if(typeof a!="function")return new e(a);var o,u,c=new e(l);c.__proto__=t.prototype;try{a.apply(o,u)}catch(f){u[1](f)}return c;function l(f,p){o=this,u=[h,v];function h(T){return n(c,!1),f(T)}function v(T){return n(c,!1),p(T)}}}if(QR.inherits(t,e),St(e.prototype,"then",s),e.prototype.chain&&St(e.prototype,"chain",s),XR)global.Promise=wy()(e,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof e[a]=="function"&&(t[a]=e[a])}),global.Promise=t}function n(a,o){(!a.__asl_wrapper||o)&&(a.__asl_wrapper=we(i))}function i(a,o,u,c){var l;try{return l=o.call(a,u),{returnVal:l,error:!1}}catch(f){return{errorVal:f,error:!0}}finally{l instanceof e?c.__asl_wrapper=function(){var p=l.__asl_wrapper||i;return p.apply(this,arguments)}:n(c,!0)}}function s(a){return function(){var u=this,c=a.apply(u,Array.prototype.map.call(arguments,l));return c.__asl_wrapper=function(p,h,v,T){return u.__asl_wrapper?(u.__asl_wrapper(p,function(){},null,c),c.__asl_wrapper(p,h,v,T)):i(p,h,v,T)},c;function l(f){return typeof f!="function"?f:we(function(p){var h=(u.__asl_wrapper||i)(this,f,p,c);if(h.error)throw h.errorVal;return h.returnVal})}}}}function yr(e){var t=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var i=0;i<arguments.length-1;i++)r[i]=arguments[i];r[n]=we(arguments[n])}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof n=="function"&&(n=we(n)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof i=="function"&&(i=we(i)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof s=="function"&&(s=we(s)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof a=="function"&&(a=we(a)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof o=="function"&&(o=we(o)),e.call(this,r,n,i,s,a,o))};default:return t}}function Ru(e){var t=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=we(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof r=="function"&&(r=we(r)),e.call(this,r,n,i,s,a,o))};default:return t}}function eP(e){return(e=Number(e))>=0?e:!1}function tP(e){return typeof e=="string"&&eP(e)===!1}});var My=d((Qj,Ly)=>{"use strict";var Mr=require("assert"),rP=Cu(),_a="cls@contexts",Zf="error@context";process.addAsyncListener||ky();function rr(e){this.name=e,this.active=null,this._set=[],this.id=null}rr.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t};rr.prototype.get=function(e){if(!!this.active)return this.active[e]};rr.prototype.createContext=function(){return Object.create(this.active)};rr.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(r){throw r&&(r[Zf]=t),r}finally{this.exit(t)}};rr.prototype.runAndReturn=function(e){var t;return this.run(function(r){t=e(r)}),t};rr.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(n){throw n&&(n[Zf]=t),n}finally{r.exit(t)}}};rr.prototype.enter=function(e){Mr.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e};rr.prototype.exit=function(e){if(Mr.ok(e,"context must be provided for exiting"),this.active===e){Mr.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var t=this._set.lastIndexOf(e);Mr.ok(t>=0,"context not currently entered; can't exit"),Mr.ok(t,"can't remove top context"),this._set.splice(t,1)};rr.prototype.bindEmitter=function(e){Mr.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;function n(s){!s||(s[_a]||(s[_a]=Object.create(null)),s[_a][r]={namespace:t,context:t.active})}function i(s){if(!(s&&s[_a]))return s;var a=s,o=s[_a];return Object.keys(o).forEach(function(u){var c=o[u];a=c.namespace.bind(a,c.context)}),a}rP(e,n,i)};rr.prototype.fromException=function(e){return e[Zf]};function Oy(e){return process.namespaces[e]}function nP(e){Mr.ok(e,"namespace must be given a name!");var t=new rr(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(r,n){n&&t.enter(n)},after:function(r,n){n&&t.exit(n)},error:function(r){r&&t.exit(r)}}),process.namespaces[e]=t,t}function Ny(e){var t=Oy(e);Mr.ok(t,"can't delete nonexistent namespace!"),Mr.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function qy(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Ny(e)}),process.namespaces=Object.create(null)}process.namespaces||qy();Ly.exports={getNamespace:Oy,createNamespace:nP,destroyNamespace:Ny,reset:qy}});var wn=d(tp=>{"use strict";Object.defineProperty(tp,"__esModule",{value:!0});var Fy=Qe(),iP=fu(),Ea=aa(),ep=sf(),Hy=wf(),sP=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return t===void 0?null:t},e.generateContextObject=function(t,r,n,i,s,a){return r=r||t,this.enabled?{operation:{name:n,id:t,parentId:r,traceparent:s,tracestate:a},customProperties:new aP(i)}:null},e.spanToContextObject=function(t,r,n){var i=new Ea;return i.traceId=t.traceId,i.spanId=t.spanId,i.traceFlag=t.traceFlags||Ea.DEFAULT_TRACE_FLAG,i.parentId=r,e.generateContextObject(i.traceId,i.parentId,n,null,i)},e.runWithContext=function(t,r){if(e.enabled)return e.session.bind(r,(n={},n[e.CONTEXT_NAME]=t,n))();return r();var n},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){if(e.enabled)return e.session.bind(t,r?(n={},n[e.CONTEXT_NAME]=r,n):void 0);return t;var n},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls>"u"&&(e.forceClsHooked===!0||e.forceClsHooked===void 0&&e.shouldUseClsHooked()?this.cls=Ey():this.cls=My()),e.session=this.cls.createNamespace("AI-CLS-Session"),iP.registerContextPreservation(function(r){return e.session.bind(r)})),this.enabled=!0}},e.startOperation=function(t,r){var n=t&&t.traceContext||null,i=t&&t.traceId?t:null,s=t&&t.headers;if(i){var a=new Ea("00-"+i.traceId+"-"+i.spanId+"-01"),o=new ep(i.tracestate),u=e.generateContextObject(i.traceId,"|"+i.traceId+"."+i.spanId+".",typeof r=="string"?r:"",void 0,a,o);return u}if(n){var a=new Ea(n.traceparent),o=new ep(n.tracestate),c=typeof r=="object"?new Hy(r):null,u=e.generateContextObject(a.traceId,a.parentId,typeof r=="string"?r:c.getOperationName({}),c&&c.getCorrelationContextHeader()||void 0,a,o);return u}if(s){var a=new Ea(s.traceparent),o=new ep(s.tracestate),c=new Hy(t),u=e.generateContextObject(a.traceId,a.parentId,c.getOperationName({}),c.getCorrelationContextHeader(),a,o);return u}return Fy.warn("startOperation was called with invalid arguments",arguments),null},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>3||parseInt(t[0])>2&&parseInt(t[1])>2},e.shouldUseClsHooked=function(){var t=process.versions.node.split(".");return parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=2},e.canUseClsHooked=function(){var t=process.versions.node.split("."),r=parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=0,n=parseInt(t[0])<8||parseInt(t[0])<=8&&parseInt(t[1])<2,i=parseInt(t[0])>4||parseInt(t[0])>=4&&parseInt(t[1])>=7;return!(r&&n)&&i},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();tp.CorrelationContextManager=sP;var aP=function(){function e(t){this.props=[],this.addHeaderData(t)}return e.prototype.addHeaderData=function(t){var r=t?t.split(", "):[];this.props=r.map(function(n){var i=n.split("=");return{key:i[0],value:i[1]}}).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map(function(t){return t.key+"="+t.value}).join(", ")},e.prototype.getProperty=function(t){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===t)return n.value}},e.prototype.setProperty=function(t,r){if(e.bannedCharacters.test(t)||e.bannedCharacters.test(r)){Fy.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+t+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var i=this.props[n];if(i.key===t){i.value=r;return}}this.props.push({key:t,value:r})},e.bannedCharacters=/[,=]/,e}()});var Uy=d(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});var jy=wt(),rp=Oe(),Mn=[],np=function(e){var t=e.data.message;Mn.forEach(function(r){t instanceof Error?r.trackException({exception:t}):(t.lastIndexOf(`
`)==t.length-1&&(t=t.substring(0,t.length-1)),r.trackTrace({message:t,severity:e.data.stderr?jy.SeverityLevel.Warning:jy.SeverityLevel.Information}))})};function oP(e,t){e?(Mn.length===0&&rp.channel.subscribe("console",np),Mn.push(t)):(Mn=Mn.filter(function(r){return r!=t}),Mn.length===0&&rp.channel.unsubscribe("console",np))}Pu.enable=oP;function uP(){rp.channel.unsubscribe("console",np),Mn=[]}Pu.dispose=uP});var $y=d(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});var Ui=wt(),ip=Oe(),Hn=[],cP={10:Ui.SeverityLevel.Verbose,20:Ui.SeverityLevel.Verbose,30:Ui.SeverityLevel.Information,40:Ui.SeverityLevel.Warning,50:Ui.SeverityLevel.Error,60:Ui.SeverityLevel.Critical},sp=function(e){var t=e.data.result;Hn.forEach(function(r){var n=cP[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})})};function lP(e,t){e?(Hn.length===0&&ip.channel.subscribe("bunyan",sp),Hn.push(t)):(Hn=Hn.filter(function(r){return r!=t}),Hn.length===0&&ip.channel.unsubscribe("bunyan",sp))}Du.enable=lP;function fP(){ip.channel.unsubscribe("bunyan",sp),Hn=[]}Du.dispose=fP});var Vy=d(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});var Ze=wt(),ap=Oe(),Fn=[],pP={syslog:function(e){var t={emerg:Ze.SeverityLevel.Critical,alert:Ze.SeverityLevel.Critical,crit:Ze.SeverityLevel.Critical,error:Ze.SeverityLevel.Error,warning:Ze.SeverityLevel.Warning,notice:Ze.SeverityLevel.Information,info:Ze.SeverityLevel.Information,debug:Ze.SeverityLevel.Verbose};return t[e]===void 0?Ze.SeverityLevel.Information:t[e]},npm:function(e){var t={error:Ze.SeverityLevel.Error,warn:Ze.SeverityLevel.Warning,info:Ze.SeverityLevel.Information,verbose:Ze.SeverityLevel.Verbose,debug:Ze.SeverityLevel.Verbose,silly:Ze.SeverityLevel.Verbose};return t[e]===void 0?Ze.SeverityLevel.Information:t[e]},unknown:function(e){return Ze.SeverityLevel.Information}},op=function(e){var t=e.data.message;Fn.forEach(function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=pP[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}})};function dP(e,t){e?(Fn.length===0&&ap.channel.subscribe("winston",op),Fn.push(t)):(Fn=Fn.filter(function(r){return r!=t}),Fn.length===0&&ap.channel.unsubscribe("winston",op))}ku.enable=dP;function hP(){ap.channel.unsubscribe("winston",op),Fn=[]}ku.dispose=hP});var Gy=d((Jj,By)=>{"use strict";var vP=fu(),gP=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(t,r){vP.IsInitialized&&(Uy().enable(t&&r,this._client),$y().enable(t,this._client),Vy().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();By.exports=gP});var Qy=d((Zj,zy)=>{"use strict";var mP=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){this._isInitialized=!0;var n=this;if(!this._exceptionListenerHandle){var i=function(s,a,o){o===void 0&&(o=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:o}),r._client.flush({isAppCrashing:!0}),s&&a&&process.listeners(a).length===1&&(console.error(o),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=i.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();zy.exports=mP});var cn=d(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";Z.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";Z.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var at;(function(e){e.COMMITTED_BYTES="\\Memory\\Committed Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",e.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",e.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",e.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",e.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",e.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",e.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(at=Z.QuickPulseCounter||(Z.QuickPulseCounter={}));var Ou;(function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(Ou=Z.PerformanceCounter||(Z.PerformanceCounter={}));Z.PerformanceToQuickPulseCounter=(nr={},nr[Ou.PROCESSOR_TIME]=at.PROCESSOR_TIME,nr[Ou.REQUEST_RATE]=at.REQUEST_RATE,nr[Ou.REQUEST_DURATION]=at.REQUEST_DURATION,nr[at.COMMITTED_BYTES]=at.COMMITTED_BYTES,nr[at.REQUEST_FAILURE_RATE]=at.REQUEST_FAILURE_RATE,nr[at.DEPENDENCY_RATE]=at.DEPENDENCY_RATE,nr[at.DEPENDENCY_FAILURE_RATE]=at.DEPENDENCY_FAILURE_RATE,nr[at.DEPENDENCY_DURATION]=at.DEPENDENCY_DURATION,nr[at.EXCEPTION_RATE]=at.EXCEPTION_RATE,nr);Z.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};Z.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};Z.TelemetryTypeStringToQuickPulseType={EventData:Z.QuickPulseType.Event,ExceptionData:Z.QuickPulseType.Exception,MessageData:Z.QuickPulseType.Trace,MetricData:Z.QuickPulseType.Metric,RequestData:Z.QuickPulseType.Request,RemoteDependencyData:Z.QuickPulseType.Dependency,AvailabilityData:Z.QuickPulseType.Availability,PageViewData:Z.QuickPulseType.PageView};Z.TelemetryTypeStringToQuickPulseDocumentType={EventData:Z.QuickPulseDocumentType.Event,ExceptionData:Z.QuickPulseDocumentType.Exception,MessageData:Z.QuickPulseDocumentType.Trace,MetricData:Z.QuickPulseDocumentType.Metric,RequestData:Z.QuickPulseDocumentType.Request,RemoteDependencyData:Z.QuickPulseDocumentType.Dependency,AvailabilityData:Z.QuickPulseDocumentType.Availability,PageViewData:Z.QuickPulseDocumentType.PageView};Z.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"};Z.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"};Z.HeartBeatMetricName="HeartBeat";var nr});var qu=d((tU,Xy)=>{"use strict";var Nu=require("os"),Ut=cn(),yP=function(){function e(t,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=Nu.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalRequestExecutionTime+=n,r===!1&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalDependencyExecutionTime+=n,r===!1&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var t=Nu.cpus();if(t&&t.length&&this._lastCpus&&t.length===this._lastCpus.length){for(var r=0,n=0,i=0,s=0,a=0,o=0;!!t&&o<t.length;o++){var u=t[o],c=this._lastCpus[o],l="% cpu("+o+") ",f=u.model,p=u.speed,h=u.times,v=c.times,T=h.user-v.user||0;r+=T;var S=h.sys-v.sys||0;n+=S;var x=h.nice-v.nice||0;i+=x;var m=h.idle-v.idle||0;s+=m;var A=h.irq-v.irq||0;a+=A}var Y=void 0;if(typeof process.cpuUsage=="function"){var J=process.cpuUsage(),de=process.hrtime(),nt=J.user-this._lastAppCpuUsage.user+(J.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var Mt=(de[0]-this._lastHrtime[0])*1e6+(de[1]-this._lastHrtime[1])/1e3||0;Y=100*nt/(Mt*t.length)}this._lastAppCpuUsage=J,this._lastHrtime=de}var dt=r+n+i+s+a||1;this._client.trackMetric({name:Ut.PerformanceCounter.PROCESSOR_TIME,value:(dt-s)/dt*100}),this._client.trackMetric({name:Ut.PerformanceCounter.PROCESS_TIME,value:Y||r/dt*100})}this._lastCpus=t},e.prototype._trackMemory=function(){var t=Nu.freemem(),r=process.memoryUsage().rss,n=Nu.totalmem()-t;this._client.trackMetric({name:Ut.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:Ut.PerformanceCounter.AVAILABLE_BYTES,value:t}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Ut.QuickPulseCounter.COMMITTED_BYTES,value:n})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,s>0){var u=n/a,c=i/a;this._client.trackMetric({name:Ut.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Ut.PerformanceCounter.REQUEST_DURATION,value:o}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Ut.QuickPulseCounter.REQUEST_FAILURE_RATE,value:c})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,s>0){var u=n/a,c=i/a;this._client.trackMetric({name:Ut.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:Ut.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:c}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Ut.QuickPulseCounter.DEPENDENCY_DURATION,value:o})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time,s=i/1e3;if(i>0){var a=n/s;this._client.trackMetric({name:Ut.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._lastRequestExecutionTime=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._lastDependencyExecutionTime=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();Xy.exports=yP});var Ca=d((rU,Jy)=>{"use strict";var Hr=require("os"),Wy=require("fs"),Ky=require("path"),_P=wt(),Yy=Qe(),EP=function(){function e(t){this.keys=new _P.ContextTagKeys,this.tags={},this._loadApplicationContext(t),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||Ky.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(Wy.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.appVersion[t]=r.version)}catch(n){Yy.info("unable to read app version: ",n)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=Hr&&Hr.hostname(),this.tags[this.keys.deviceOSVersion]=Hr&&Hr.type()+" "+Hr.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=Hr&&Hr.arch(),this.tags["ai.device.osPlatform"]=Hr&&Hr.platform()},e.prototype._loadInternalContext=function(){var t=Ky.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(Wy.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.sdkVersion=r.version)}catch(n){Yy.info("unable to read app version: ",n)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();Jy.exports=EP});var e_=d((cp,Zy)=>{"use strict";var CP=cp&&cp.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ir=require("url"),up=wt(),TP=kt(),IP=qi(),bP=Tf(),wP=Dn(),SP=function(e){CP(t,e);function t(r,n){var i=e.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=t._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return t.prototype.onError=function(r){this._setStatus(void 0,r)},t.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=TP.getCorrelationContextTarget(r,IP.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(r,n){var i=ir.parse(this.url);i.search=void 0,i.hash=void 0;var s=this.method.toUpperCase()+" "+i.pathname,a=up.RemoteDependencyDataConstants.TYPE_HTTP,o=i.hostname;i.port&&(o+=":"+i.port),this.correlationId?(a=up.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==wP.correlationIdPrefix&&(o+=" | "+this.correlationId)):a=up.RemoteDependencyDataConstants.TYPE_HTTP;var u={id:n,name:s,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:a,target:o};if(r&&r.time?u.time=r.time:this.startTime&&(u.time=new Date(this.startTime)),r){for(var c in r)u[c]||(u[c]=r[c]);if(r.properties)for(var c in r.properties)u.properties[c]=r.properties[c]}return u},t._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)r=ir.parse(r);else{var i=ir.parse(r);i.host==="443"?r=ir.parse("https://"+r):r=ir.parse("http://"+r)}else{if(r&&typeof ir.URL=="function"&&r instanceof ir.URL)return ir.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(u){r[u]=s[u]})}if(r.path){var a=ir.parse(r.path);r.pathname=a.pathname,r.search=a.search}if(r.host&&r.port){var o=ir.parse("http://"+r.host);!o.port&&r.port&&(r.hostname=r.host,delete r.host)}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",ir.format(r)},t}(bP);Zy.exports=SP});var r_=d(Ta=>{"use strict";var t_=Ta&&Ta.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Ta,"__esModule",{value:!0});var xP=Xo(),xt=cn();function lp(e){var t=t_({},e);return Object.keys(xt.SpanAttribute).forEach(function(r){delete t[r]}),t}function AP(e){var t="|"+e.context().traceId+"."+e.context().spanId+".",r=Math.round(e._duration[0]*1e3+e._duration[1]/1e6),n=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",i=e.attributes.component?e.attributes.component.toString():"",s=i.toUpperCase()===xt.DependencyTypeName.Http||!!e.attributes[xt.SpanAttribute.HttpUrl],a=i.toLowerCase()===xt.DependencyTypeName.Grpc;if(s){var o=e.attributes[xt.SpanAttribute.HttpMethod]||"GET",u=new URL(e.attributes[xt.SpanAttribute.HttpUrl].toString()),c=e.attributes[xt.SpanAttribute.HttpHost]||u.host,l=e.attributes[xt.SpanAttribute.HttpPort]||u.port||null,f=u.pathname||"/",p=o+" "+f,h=xt.DependencyTypeName.Http,v=l?(c+":"+l).toString():c.toString(),T=u.toString(),S=e.attributes[xt.SpanAttribute.HttpStatusCode]||e.status.code||0,x=S<400;return{id:t,name:p,dependencyTypeName:h,target:v,data:T,success:x,duration:r,url:T,resultCode:String(S),properties:lp(e.attributes)}}else if(a){var o=e.attributes[xt.SpanAttribute.GrpcMethod]||"rpc",m=e.attributes[xt.SpanAttribute.GrpcService],A=m?o+" "+m:e.name;return{id:t,duration:r,name:A,target:m.toString(),data:m.toString()||A,url:m.toString()||A,dependencyTypeName:xt.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:e.status.code===0,properties:lp(e.attributes)}}else{var Y=e.name,J=e.links&&e.links.map(function(de){return{operation_Id:de.context.traceId,id:de.context.spanId}});return{id:t,duration:r,name:Y,target:n,data:n||Y,url:n||Y,dependencyTypeName:e.kind===xP.SpanKind.INTERNAL?xt.DependencyTypeName.InProc:i||e.name,resultCode:String(e.status.code||0),success:e.status.code===0,properties:t_({},lp(e.attributes),{"_MS.links":J||void 0})}}}Ta.spanToTelemetryContract=AP});var i_=d(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});var n_=Oe(),RP=aa(),PP=r_(),Lu=Xo(),$i=[];Vi.subscriber=function(e){var t=e.data,r=PP.spanToTelemetryContract(t),n=t.context(),i=new RP;i.traceId=n.traceId,i.spanId=n.spanId,i.traceFlag=n.traceFlags.toString(),i.parentId=t.parentSpanId?"|"+n.traceId+"."+t.parentSpanId+".":null,Lu.AsyncScopeManager.with(t,function(){$i.forEach(function(s){t.kind===Lu.SpanKind.SERVER?s.trackRequest(r):(t.kind===Lu.SpanKind.CLIENT||t.kind===Lu.SpanKind.INTERNAL)&&s.trackDependency(r)})})};function DP(e,t){e?($i.length===0&&n_.channel.subscribe("azure-coretracing",Vi.subscriber),$i.push(t)):($i=$i.filter(function(r){return r!=t}),$i.length===0&&n_.channel.unsubscribe("azure-coretracing",Vi.subscriber))}Vi.enable=DP});var a_=d(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});var s_=Oe(),Bi=[];Gi.subscriber=function(e){e.data.event.commandName!=="ismaster"&&Bi.forEach(function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})})};function kP(e,t){e?(Bi.length===0&&s_.channel.subscribe("mongodb",Gi.subscriber),Bi.push(t)):(Bi=Bi.filter(function(r){return r!=t}),Bi.length===0&&s_.channel.unsubscribe("mongodb",Gi.subscriber))}Gi.enable=kP});var u_=d(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});var o_=Oe(),zi=[];Qi.subscriber=function(e){zi.forEach(function(t){var r=e.data.query||{},n=r.sql||"Unknown query",i=!e.data.err,s=r._connection||{},a=s.config||{},o=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})})};function OP(e,t){e?(zi.length===0&&o_.channel.subscribe("mysql",Qi.subscriber),zi.push(t)):(zi=zi.filter(function(r){return r!=t}),zi.length===0&&o_.channel.unsubscribe("mysql",Qi.subscriber))}Qi.enable=OP});var l_=d(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});var c_=Oe(),Xi=[];Wi.subscriber=function(e){Xi.forEach(function(t){e.data.commandObj.command!=="info"&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})})};function NP(e,t){e?(Xi.length===0&&c_.channel.subscribe("redis",Wi.subscriber),Xi.push(t)):(Xi=Xi.filter(function(r){return r!=t}),Xi.length===0&&c_.channel.unsubscribe("redis",Wi.subscriber))}Wi.enable=NP});var p_=d(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});var f_=Oe(),Ki=[];Yi.subscriber=function(e){Ki.forEach(function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!e.data.error,s=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:s,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})})};function qP(e,t){e?(Ki.length===0&&f_.channel.subscribe("postgres",Yi.subscriber),Ki.push(t)):(Ki=Ki.filter(function(r){return r!=t}),Ki.length===0&&f_.channel.unsubscribe("postgres",Yi.subscriber))}Yi.enable=qP});var Zi=d((cU,g_)=>{"use strict";var jn=require("http"),Ji=require("https"),fp=Qe(),d_=kt(),ln=qi(),LP=e_(),h_=wn(),v_=Dn(),pp=aa(),MP=fu(),HP=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,this._isEnabled&&!this._isInitialized&&this._initialize(),MP.IsInitialized&&(i_().enable(!0,this._client),a_().enable(t,this._client),u_().enable(t,this._client),l_().enable(t,this._client),p_().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=jn.get,n=jn.request,i=Ji.request,s=function(a,o){var u=!o[e.disableCollectionRequestOption]&&!a[e.alreadyAutoCollectedFlag];o.headers&&o.headers["user-agent"]&&o.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(u=!1),a[e.alreadyAutoCollectedFlag]=!0,a&&o&&u&&(h_.CorrelationContextManager.wrapEmitter(a),e.trackRequest(t._client,{options:o,request:a}))};jn.request=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=n.call.apply(n,[jn,a].concat(o));return s(c,a),c},Ji.request=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=i.call.apply(i,[Ji,a].concat(o));return s(c,a),c},jn.get=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(l=jn.request).call.apply(l,[jn,a].concat(o));return c.end(),c;var l},Ji.get=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(l=Ji.request).call.apply(l,[Ji,a].concat(o));return c.end(),c;var l}},e.trackRequest=function(t,r){if(!r.options||!r.request||!t){fp.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t);return}var n=new LP(r.options,r.request),i=h_.CorrelationContextManager.getCurrentContext(),s,a;if(i&&i.operation&&i.operation.traceparent&&pp.isValidTraceId(i.operation.traceparent.traceId))i.operation.traceparent.updateSpanId(),s=i.operation.traceparent.getBackCompatRequestId();else if(v_.w3cEnabled){var o=new pp;a=o.toString(),s=o.getBackCompatRequestId()}else s=i&&i.operation&&i.operation.parentId+e.requestNumber+++".";if(d_.canIncludeCorrelationHeader(t,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var u=r.request.getHeader(ln.requestContextHeader);try{d_.safeIncludeCorrelationHeader(t,r.request,u)}catch(f){fp.warn("Request-Context header could not be set. Correlation of requests may be lost",f)}if(i&&i.operation)try{if(r.request.setHeader(ln.requestIdHeader,s),t.config.ignoreLegacyHeaders||(r.request.setHeader(ln.parentIdHeader,i.operation.id),r.request.setHeader(ln.rootIdHeader,s)),a||i.operation.traceparent)r.request.setHeader(ln.traceparentHeader,a||i.operation.traceparent.toString());else if(v_.w3cEnabled){var o=new pp().toString();r.request.setHeader(ln.traceparentHeader,o)}if(i.operation.tracestate){var c=i.operation.tracestate.toString();c&&r.request.setHeader(ln.traceStateHeader,c)}var l=i.customProperties.serializeToHeader();l&&r.request.setHeader(ln.correlationContextHeader,l)}catch(f){fp.warn("Correlation headers could not be set. Correlation of requests may be lost.",f)}}r.request.on&&(r.request.on("response",function(f){n.onResponse(f);var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,p.contextObjects["http.ClientResponse"]=f,t.trackDependency(p)}),r.request.on("error",function(f){n.onError(f);var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,p.contextObjects.Error=f,t.trackDependency(p)}))},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();g_.exports=HP});var __=d((lU,y_)=>{"use strict";var FP=require("os"),m_=cn(),jP=kt(),UP=Ca(),$P=Zi(),VP="http://169.254.169.254/metadata/instance/compute",BP="api-version=2017-12-01",GP="format=json",zP="ENETUNREACH",QP=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._handle=setInterval(function(){return n.trackHeartBeat(r,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(t,r){var n=this,i=!1,s={},a=UP.sdkVersion;s.sdk=a,s.osType=FP.type(),process.env.WEBSITE_SITE_NAME?(s.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",s.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",s.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?s.azfunction_appId=process.env.WEBSITE_HOSTNAME:t&&(this._isVM===void 0?(i=!0,this._getAzureComputeMetadata(t,function(){n._isVM&&Object.keys(n._vmData).length>0&&(s.azInst_vmId=n._vmData.vmId||"",s.azInst_subscriptionId=n._vmData.subscriptionId||"",s.azInst_osType=n._vmData.osType||"",n._azInst_vmId=n._vmData.vmId||"",n._azInst_subscriptionId=n._vmData.subscriptionId||"",n._azInst_osType=n._vmData.osType||""),n._client.trackMetric({name:m_.HeartBeatMetricName,value:0,properties:s}),r()})):this._isVM&&(s.azInst_vmId=this._azInst_vmId,s.azInst_subscriptionId=this._azInst_subscriptionId,s.azInst_osType=this._azInst_osType)),i||(this._client.trackMetric({name:m_.HeartBeatMetricName,value:0,properties:s}),r())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(t,r){var n=this,i=VP+"?"+BP+"&"+GP,s=(o={method:"GET"},o[$P.disableCollectionRequestOption]=!0,o.headers={Metadata:"True"},o),a=jP.makeRequest(t,i,s,function(u){if(u.statusCode===200){n._isVM=!0;var c="";u.on("data",function(l){c+=l}),u.on("end",function(){n._vmData=n._isJSON(c)?JSON.parse(c):{},r()})}else r()});a&&(a.on("error",function(u){u&&u.message&&u.message.indexOf(zP)>-1&&(n._isVM=!1),r()}),a.end());var o},e.prototype._isJSON=function(t){try{return JSON.parse(t)&&!!t}catch{return!1}},e}();y_.exports=QP});var hp=d((fU,b_)=>{"use strict";var E_=require("http"),C_=require("https"),T_=Qe(),I_=kt(),XP=qi(),dp=wf(),Fr=wn(),WP=qu(),KP=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,(this._isAutoCorrelating||this._isEnabled||WP.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(t,r){t&&!this._isAutoCorrelating?Fr.CorrelationContextManager.enable(r):!t&&this._isAutoCorrelating&&Fr.CorrelationContextManager.disable(),this._isAutoCorrelating=t},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(t){if(!!this._isAutoCorrelating)return Fr.CorrelationContextManager.generateContextObject(t.getOperationId(this._client.context.tags),t.getRequestId(),t.getOperationName(this._client.context.tags),t.getCorrelationContextHeader(),t.getTraceparent(),t.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(a){if(!!a){if(typeof a!="function")throw new Error("onRequest handler must be a function");return function(o,u){Fr.CorrelationContextManager.wrapEmitter(o),Fr.CorrelationContextManager.wrapEmitter(u);var c=o&&!o[e.alreadyAutoCollectedFlag];if(o&&c){var l=new dp(o),f=t._generateCorrelationContext(l);Fr.CorrelationContextManager.runWithContext(f,function(){t._isEnabled&&(o[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:o,response:u},l)),typeof a=="function"&&a(o,u)})}else typeof a=="function"&&a(o,u)}}},n=function(a){var o=a.addListener.bind(a);a.addListener=function(u,c){switch(u){case"request":case"checkContinue":return o(u,r(c));default:return o(u,c)}},a.on=a.addListener},i=E_.createServer;E_.createServer=function(a,o){if(o&&typeof o=="function"){var u=i(a,r(o));return n(u),u}else{var u=i(r(a));return n(u),u}};var s=C_.createServer;C_.createServer=function(a,o){var u=s(a,r(o));return n(u),u}},e.trackRequestSync=function(t,r){if(!r.request||!r.response||!t){T_.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t);return}e.addResponseCorrelationIdHeader(t,r.response);var n=Fr.CorrelationContextManager.getCurrentContext(),i=new dp(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(t.context.tags)||n.operation.id,n.operation.name=i.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),e.endRequest(t,i,r,r.duration,r.error)},e.trackRequest=function(t,r,n){if(!r.request||!r.response||!t){T_.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t);return}var i=Fr.CorrelationContextManager.getCurrentContext(),s=n||new dp(r.request,i&&i.operation.parentId);I_.canIncludeCorrelationHeader(t,s.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),i&&!n&&(i.operation.id=s.getOperationId(t.context.tags)||i.operation.id,i.operation.name=s.getOperationName(t.context.tags)||i.operation.name,i.operation.parentId=s.getOperationParentId(t.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){e.endRequest(t,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){e.endRequest(t,s,r,null,a)})},e.addResponseCorrelationIdHeader=function(t,r){if(t.config&&t.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(XP.requestContextHeader);I_.safeIncludeCorrelationHeader(t,r,n)}},e.endRequest=function(t,r,n,i,s){s?r.onError(s,i):r.onResponse(n.response,i);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(t.context.tags),n.tagOverrides)for(var o in n.tagOverrides)a.tagOverrides[o]=n.tagOverrides[o];var u=r.getLegacyRootId();u&&(a.properties.ai_legacyRootId=u),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,t.trackRequest(a)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,Fr.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();b_.exports=KP});var x_=d((pU,S_)=>{"use strict";var w_=cn(),YP=function(){function e(){}return e.parse=function(t){if(!t)return{};var r=t.split(e._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var o=a.split(e._FIELD_KEY_VALUE_SEPARATOR);if(o.length===2){var u=o[0].toLowerCase(),c=o[1];s[u]=c}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||w_.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||w_.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();S_.exports=YP});var Mu=d((dU,P_)=>{"use strict";var vp=Dn(),A_=x_(),JP=Qe(),R_=cn(),ZP=require("url"),eD=function(){function e(t){var r=this;this.endpointBase=R_.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],i=A_.parse(t),s=A_.parse(n),a=!i.instrumentationkey&&Object.keys(i).length>0?null:t;this.instrumentationKey=i.instrumentationkey||a||s.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey)||JP.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this.endpointUrl=(i.ingestionendpoint||s.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(o){return r.correlationId=o},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=i.ingestionendpoint||s.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=i.liveendpoint||s.liveendpoint||process.env[e.ENV_quickPulseHost]||R_.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=ZP.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(t){vp.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=t,this.correlationId=vp.correlationIdPrefix,vp.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(t){this._quickPulseHost=t},enumerable:!0,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||t=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(t){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(t)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();P_.exports=eD});var O_=d((mp,k_)=>{"use strict";var Ia=mp&&mp.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},gp=require("os"),Un=wt(),D_=cn(),tD=kt(),rD=Qe(),nD=tD.w3cTraceId(),iD=function(){function e(){}return e.createQuickPulseEnvelope=function(t,r,n,i){var s=gp&&typeof gp.hostname=="function"&&gp.hostname()||"Unknown",a=i.tags&&i.keys&&i.keys.cloudRoleInstance&&i.tags[i.keys.cloudRoleInstance]||s,o={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:t.length>0?t:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:i.tags[i.keys.internalSdkVersion],StreamId:nD,MachineName:s,Instance:a};return o},e.createQuickPulseMetric=function(t){var r;return r={Name:t.name,Value:t.value,Weight:t.count||1},r},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case Un.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case Un.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case Un.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case Un.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case Un.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.name,i=Ia({},r,{Name:n});return i},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.severityLevel||0,i=Ia({},r,{Message:t.data.baseData.message,SeverityLevel:Un.SeverityLevel[n]});return i},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.exceptions,i="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(u){i+=u.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(i=n[0].stack),s=n[0].message,a=n[0].typeName);var o=Ia({},r,{Exception:i,ExceptionMessage:s,ExceptionType:a});return o},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=Ia({},r,{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return i},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=Ia({},r,{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return i},e.createQuickPulseDocument=function(t){var r,n,i,s;t.data.baseType?(n=D_.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=D_.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):rD.warn("Document type invalid; not sending live metric document",t.data.baseType),i=t.tags[e.keys.operationId],s=e.aggregateProperties(t);var a={DocumentType:r,__type:n,OperationId:i,Version:"1.0",Properties:s};return a},e.aggregateProperties=function(t){var r=[],n=t.data.baseData.measurements||{};for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],a={key:i,value:s};r.push(a)}var o=t.data.baseData.properties||{};for(var i in o)if(o.hasOwnProperty(i)){var s=o[i],a={key:i,value:s};r.push(a)}return r},e.keys=new Un.ContextTagKeys,e}();k_.exports=iD});var q_=d((hU,N_)=>{"use strict";var sD=function(){return(Date.now()+621355968e5)*1e4};N_.exports={getTransmissionTime:sD}});var H_=d((vU,M_)=>{"use strict";var aD=require("https"),oD=Zi(),L_=Qe(),uD=q_(),cD=kt(),yp={method:"POST",time:"x-ms-qps-transmission-time",subscribed:"x-ms-qps-subscribed"},lD=function(){function e(t){this._config=t,this._consecutiveErrors=0}return e.prototype.ping=function(t,r){this._submitData(t,r,"ping")},e.prototype.post=function(t,r){this._submitData([t],r,"post")},e.prototype._submitData=function(t,r,n){var i=this,s=JSON.stringify(t),a=(u={},u[oD.disableCollectionRequestOption]=!0,u.host=this._config.quickPulseHost,u.method=yp.method,u.path="/QuickPulseService.svc/"+n+"?ikey="+this._config.instrumentationKey,u.headers=(c={Expect:"100-continue"},c[yp.time]=uD.getTransmissionTime(),c["Content-Type"]="application/json",c["Content-Length"]=Buffer.byteLength(s),c),u);this._config.httpsAgent?a.agent=this._config.httpsAgent:a.agent=cD.tlsRestrictedAgent;var o=aD.request(a,function(l){var f=l.headers[yp.subscribed]==="true";i._consecutiveErrors=0,r(f,l)});o.on("error",function(l){i._consecutiveErrors++;var f="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";i._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN===0?(f="Live Metrics endpoint could not be reached "+i._consecutiveErrors+" consecutive times. Most recent error:",L_.warn(e.TAG,f,l)):L_.info(e.TAG,f,l),r()}),o.write(s),o.end();var u,c},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();M_.exports=lD});var j_=d((gU,F_)=>{"use strict";var fD=Qe(),pD=Mu(),_p=O_(),dD=H_(),hD=cn(),vD=Ca(),gD=function(){function e(t,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new pD(t),this.context=r||new vD,this._sender=new dD(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(t){this._collectors.push(t)},e.prototype.trackMetric=function(t){this._addMetric(t)},e.prototype.addDocument=function(t){var r=_p.telemetryEnvelopeToQuickPulseDocument(t);r&&this._documents.push(r)},e.prototype.enable=function(t){t&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!t&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(t){this._collectors.forEach(function(r){r.enable(t)})},e.prototype._addMetric=function(t){var r=t.value,n=t.count||1,i=hD.PerformanceToQuickPulseCounter[t.name];i&&(this._metrics[i]?(this._metrics[i].Value=(this._metrics[i].Value*this._metrics[i].Weight+r*n)/(this._metrics[i].Weight+n),this._metrics[i].Weight+=n):(this._metrics[i]=_p.createQuickPulseMetric(t),this._metrics[i].Name=i,this._metrics[i].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){var t=this,r=Object.keys(this._metrics).map(function(s){return t._metrics[s]}),n=_p.createQuickPulseEnvelope(r,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(n):this._ping(n);var i=this._isCollectingData?e.POST_INTERVAL:e.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,i=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(i=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),i),this._handle.unref()},e.prototype._ping=function(t){this._sender.ping(t,this._quickPulseDone.bind(this))},e.prototype._post=function(t){this._sender.post(t,this._quickPulseDone.bind(this))},e.prototype._quickPulseDone=function(t,r){t!=null?(this._isCollectingData!==t&&(fD.info("Live Metrics sending data",t),this.enableCollectors(t)),this._isCollectingData=t,r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();F_.exports=gD});var $_=d(wa=>{"use strict";var mD=wa&&wa.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(wa,"__esModule",{value:!0});var U_=Mu(),ba=Ca(),yD=Qe(),_D=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>=6},e.prototype.enable=function(t,r,n){var i=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),!!e.isNodeVersionCompatible()){if(e._metricsAvailable==null&&t&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");e._emitter=new s,e._metricsAvailable=!0,yD.info("Native metrics module successfully loaded!")}catch{e._metricsAvailable=!1;return}this._isEnabled=t,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,n),this._handle=setInterval(function(){return i._trackNativeMetrics()},n),this._handle.unref()):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(t){var r=process.env[U_.ENV_nativeMetricsDisableAll],n=process.env[U_.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(n){var i=n.split(","),s={};if(i.length>0)for(var a=0,o=i;a<o.length;a++){var u=o[a];s[u]=!0}return typeof t=="object"?{isEnabled:!0,disabledMetrics:mD({},t,s)}:{isEnabled:t,disabledMetrics:s}}return typeof t=="boolean"?{isEnabled:t,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:t}},e.prototype._trackNativeMetrics=function(){var t=!0;typeof this._isEnabled!="object"&&(t=this._isEnabled),t&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var t=e._emitter.getGCData();for(var r in t){var n=t[r].metrics,i=r+" Garbage Collection Duration",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:i,value:n.total,count:n.count,max:n.max,min:n.min,stdDev:s,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+ba.sdkVersion,a)})}var a}},e.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var t=e._emitter.getLoopData(),r=t.loopUsage;if(r.count!=0){var n="Event Loop CPU Time",i=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:n,value:r.total,count:r.count,min:r.min,max:r.max,stdDev:i,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+ba.sdkVersion,s)});var s}}},e.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var t=process.memoryUsage(),r=t.heapUsed,n=t.heapTotal,i=t.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:r,count:1,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+ba.sdkVersion,s)}),this._client.trackMetric({name:"Memory Total (Heap)",value:n,count:1,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+ba.sdkVersion,a)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:i-n,count:1,tagOverrides:(o={},o[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+ba.sdkVersion,o)});var s,a,o}},e}();wa.AutoCollectNativePerformance=_D});var G_=d((yU,B_)=>{"use strict";var V_=Qe(),ED=function(){function e(t,r,n,i){this._buffer=[],this._lastSend=0,this._isDisabled=t,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=i}return e.prototype.setUseDiskRetryCaching=function(t,r,n){this._sender.setDiskRetryMode(t,r,n)},e.prototype.send=function(t){var r=this;if(!this._isDisabled()){if(!t){V_.warn("Cannot send null/undefined telemetry");return}var n=this._stringify(t);if(typeof n=="string"){if(this._buffer.push(n),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}}},e.prototype.triggerSend=function(t,r){var n=this._buffer.length<1;if(!n){var i=this._buffer.join(`
`);t?(this._sender.saveOnCrash(i),typeof r=="function"&&r("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(i):new Buffer(i),r)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},e.prototype._stringify=function(t){try{return JSON.stringify(t)}catch(r){V_.warn("Failed to serialize payload",r,t)}},e}();B_.exports=ED});var z_=d(Ep=>{"use strict";Object.defineProperty(Ep,"__esModule",{value:!0});function CD(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}Ep.azureRoleEnvironmentTelemetryProcessor=CD});var W_=d(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});var Q_=wt();function TD(e,t){var r=e.sampleRate,n=!1;return r==null||r>=100||e.data&&Q_.TelemetryType.Metric===Q_.baseTypeToTelemetryType(e.data.baseType)?!0:(t.correlationContext&&t.correlationContext.operation?n=X_(t.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}Hu.samplingTelemetryProcessor=TD;function X_(e){var t=-2147483648,r=2147483647,n=5381;if(!e)return 0;for(;e.length<8;)e=e+e;for(var i=0;i<e.length;i++)n=((n<<5)+n|0)+e.charCodeAt(i)|0;return n=n<=t?r:Math.abs(n),n/r*100}Hu.getSamplingHashCode=X_});var K_=d(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});var Cp=qu(),Tp=wt();function ID(e,t){switch(t&&t.addDocument(e),e.data.baseType){case Tp.TelemetryTypeString.Exception:Cp.countException();break;case Tp.TelemetryTypeString.Request:var r=e.data.baseData;Cp.countRequest(r.duration,r.success);break;case Tp.TelemetryTypeString.Dependency:var n=e.data.baseData;Cp.countDependency(n.duration,n.success);break}return!0}Ip.performanceMetricsTelemetryProcessor=ID});var Y_=d(Fu=>{"use strict";function bp(e){for(var t in e)Fu.hasOwnProperty(t)||(Fu[t]=e[t])}Object.defineProperty(Fu,"__esModule",{value:!0});bp(z_());bp(W_());bp(K_())});var Z_=d((IU,J_)=>{"use strict";var gt=require("fs"),ju=require("os"),jr=require("path"),bD=require("zlib"),es=require("child_process"),ot=Qe(),wD=Zi(),SD=kt(),xD=function(){function e(t,r,n){if(this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._resendTimer=null,!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=gt.existsSync(e.ICACLS_PATH)}catch{}e.OS_PROVIDES_FILE_PROTECTION||ot.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,ot.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},e.prototype.send=function(t,r){var n=this,i=this._config.endpointUrl,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};bD.gzip(t,function(a,o){var u=o;a?(ot.warn(a),u=t,s.headers["Content-Length"]=t.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=o.length),ot.info(e.TAG,s),s[wD.disableCollectionRequestOption]=!0;var c=function(f){f.setEncoding("utf-8");var p="";f.on("data",function(h){p+=h}),f.on("end",function(){n._numConsecutiveFailures=0,ot.info(e.TAG,p),typeof n._onSuccess=="function"&&n._onSuccess(p),typeof r=="function"&&r(p),n._enableDiskRetryMode&&(f.statusCode===200?n._resendTimer||(n._resendTimer=setTimeout(function(){n._resendTimer=null,n._sendFirstFileOnDisk()},n._resendInterval),n._resendTimer.unref()):(f.statusCode===408||f.statusCode===429||f.statusCode===439||f.statusCode===500||f.statusCode===503)&&n._storeToDisk(t))})},l=SD.makeRequest(n._config,i,s,c);l.on("error",function(f){if(n._numConsecutiveFailures++,!n._enableDiskRetryMode||n._numConsecutiveFailures>0&&n._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var p="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";n._enableDiskRetryMode&&(p="Ingestion endpoint could not be reached "+n._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),ot.warn(e.TAG,p,f)}else{var p="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";ot.info(e.TAG,p,f)}if(n._onErrorHelper(f),typeof r=="function"){var h="error sending telemetry";f&&typeof f.toString=="function"&&(h=f.toString()),r(h)}n._enableDiskRetryMode&&n._storeToDisk(t)}),l.write(u),l.end()})},e.prototype.saveOnCrash=function(t){this._enableDiskRetryMode&&this._storeToDiskSync(t)},e.prototype._runICACLS=function(t,r){var n=es.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",function(i){return r(i)}),n.on("close",function(i,s){return r(i===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+i+")"))})},e.prototype._runICACLSSync=function(t){if(es.spawnSync){var r=es.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=es.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",function(i){return n+=i}),r.on("error",function(i){return t(i,null)}),r.on("close",function(i,s){return e.ACL_IDENTITY=n&&n.trim(),t(i===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+i+")"),e.ACL_IDENTITY)})},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(es.spawnSync){var t=es.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(t.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(t,r){return[t,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;if(!e.USE_ICACLS)return r(null);if(e.ACLED_DIRECTORIES[t]===void 0)e.ACLED_DIRECTORIES[t]=!1,this._getACLIdentity(function(i,s){if(i)return e.ACLED_DIRECTORIES[t]=!1,r(i);n._runICACLS(n._getACLArguments(t,s),function(a){return e.ACLED_DIRECTORIES[t]=!a,r(a)})});else return r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(e.ACLED_DIRECTORIES[t]===void 0){this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),e.ACLED_DIRECTORIES[t]=!0;return}else if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(t,r){var n=this;gt.lstat(t,function(i,s){i&&i.code==="ENOENT"?gt.mkdir(t,function(a){a&&a.code!=="EEXIST"?r(a):n._applyACLRules(t,r)}):!i&&s.isDirectory()?n._applyACLRules(t,r):r(i||new Error("Path existed but was not a directory"))})},e.prototype._getShallowDirectorySize=function(t,r){gt.readdir(t,function(n,i){if(n)return r(n,-1);var s=null,a=0,o=0;if(i.length===0){r(null,0);return}for(var u=0;u<i.length;u++)gt.stat(jr.join(t,i[u]),function(c,l){o++,c?s=c:l.isFile()&&(a+=l.size),o===i.length&&(s?r(s,-1):r(s,a))})})},e.prototype._getShallowDirectorySizeSync=function(t){for(var r=gt.readdirSync(t),n=0,i=0;i<r.length;i++)n+=gt.statSync(jr.join(t,r[i])).size;return n},e.prototype._storeToDisk=function(t){var r=this,n=jr.join(ju.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);ot.info(e.TAG,"Checking existence of data storage directory: "+n),this._confirmDirExists(n,function(i){if(i){ot.warn(e.TAG,"Error while checking/creating directory: "+(i&&i.message)),r._onErrorHelper(i);return}r._getShallowDirectorySize(n,function(s,a){if(s||a<0){ot.warn(e.TAG,"Error while checking directory size: "+(s&&s.message)),r._onErrorHelper(s);return}else if(a>r._maxBytesOnDisk){ot.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+a);return}var o=new Date().getTime()+".ai.json",u=jr.join(n,o);ot.info(e.TAG,"saving data to disk at: "+u),gt.writeFile(u,t,{mode:384},function(c){return r._onErrorHelper(c)})})})},e.prototype._storeToDiskSync=function(t){var r=jr.join(ju.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);try{ot.info(e.TAG,"Checking existence of data storage directory: "+r),gt.existsSync(r)||gt.mkdirSync(r),this._applyACLRulesSync(r);var n=this._getShallowDirectorySizeSync(r);if(n>this._maxBytesOnDisk){ot.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+n);return}var i=new Date().getTime()+".ai.json",s=jr.join(r,i);ot.info(e.TAG,"saving data before crash to disk at: "+s),gt.writeFileSync(s,t,{mode:384})}catch(a){ot.warn(e.TAG,"Error while saving data to disk: "+(a&&a.message)),this._onErrorHelper(a)}},e.prototype._sendFirstFileOnDisk=function(){var t=this,r=jr.join(ju.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);gt.exists(r,function(n){n&&gt.readdir(r,function(i,s){if(i)t._onErrorHelper(i);else if(s=s.filter(function(u){return jr.basename(u).indexOf(".ai.json")>-1}),s.length>0){var a=s[0],o=jr.join(r,a);gt.readFile(o,function(u,c){u?t._onErrorHelper(u):gt.unlink(o,function(l){l?t._onErrorHelper(l):t.send(c)})})}})})},e.prototype._onErrorHelper=function(t){typeof this._onError=="function"&&this._onError(t)},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=60*1e3,e.MAX_BYTES_ON_DISK=50*1e3*1e3,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS=ju.type()==="Windows_NT",e}();J_.exports=xD});var rE=d((bU,tE)=>{"use strict";var k=wt(),$t=kt(),AD=wn(),RD=function(){function e(){}return e.createEnvelope=function(t,r,n,i,s){var a=null;switch(r){case k.TelemetryType.Trace:a=e.createTraceData(t);break;case k.TelemetryType.Dependency:a=e.createDependencyData(t);break;case k.TelemetryType.Event:a=e.createEventData(t);break;case k.TelemetryType.Exception:a=e.createExceptionData(t);break;case k.TelemetryType.Request:a=e.createRequestData(t);break;case k.TelemetryType.Metric:a=e.createMetricData(t);break;case k.TelemetryType.Availability:a=e.createAvailabilityData(t);break;case k.TelemetryType.PageView:a=e.createPageViewData(t);break}if(n&&k.domainSupportsProperties(a.baseData)){if(a&&a.baseData)if(!a.baseData.properties)a.baseData.properties=n;else for(var o in n)a.baseData.properties[o]||(a.baseData.properties[o]=n[o]);a.baseData.properties=$t.validateStringMap(a.baseData.properties)}var u=s&&s.instrumentationKey||"",c=new k.Envelope;return c.data=a,c.iKey=u,c.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),c.tags=this.getTags(i,t.tagOverrides),c.time=new Date().toISOString(),c.ver=1,c.sampleRate=s?s.samplingPercentage:100,r===k.TelemetryType.Metric&&(c.sampleRate=100),c},e.createTraceData=function(t){var r=new k.MessageData;r.message=t.message,r.properties=t.properties,isNaN(t.severity)?r.severityLevel=k.SeverityLevel.Information:r.severityLevel=t.severity;var n=new k.Data;return n.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Trace),n.baseData=r,n},e.createDependencyData=function(t){var r=new k.RemoteDependencyData;typeof t.name=="string"&&(r.name=t.name.length>1024?t.name.slice(0,1021)+"...":t.name),r.data=t.data,r.target=t.target,r.duration=$t.msToTimeSpan(t.duration),r.success=t.success,r.type=t.dependencyTypeName,r.properties=t.properties,r.resultCode=t.resultCode?t.resultCode+"":"",t.id?r.id=t.id:r.id=$t.w3cTraceId();var n=new k.Data;return n.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Dependency),n.baseData=r,n},e.createEventData=function(t){var r=new k.EventData;r.name=t.name,r.properties=t.properties,r.measurements=t.measurements;var n=new k.Data;return n.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Event),n.baseData=r,n},e.createExceptionData=function(t){var r=new k.ExceptionData;r.properties=t.properties,isNaN(t.severity)?r.severityLevel=k.SeverityLevel.Error:r.severityLevel=t.severity,r.measurements=t.measurements,r.exceptions=[];var n=t.exception.stack,i=new k.ExceptionDetails;i.message=t.exception.message,i.typeName=t.exception.name,i.parsedStack=this.parseStack(n),i.hasFullStack=$t.isArray(i.parsedStack)&&i.parsedStack.length>0,r.exceptions.push(i);var s=new k.Data;return s.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Exception),s.baseData=r,s},e.createRequestData=function(t){var r=new k.RequestData;t.id?r.id=t.id:r.id=$t.w3cTraceId(),r.name=t.name,r.url=t.url,r.source=t.source,r.duration=$t.msToTimeSpan(t.duration),r.responseCode=t.resultCode?t.resultCode+"":"",r.success=t.success,r.properties=t.properties;var n=new k.Data;return n.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Request),n.baseData=r,n},e.createMetricData=function(t){var r=new k.MetricData;r.metrics=[];var n=new k.DataPoint;n.count=isNaN(t.count)?1:t.count,n.kind=k.DataPointType.Aggregation,n.max=isNaN(t.max)?t.value:t.max,n.min=isNaN(t.min)?t.value:t.min,n.name=t.name,n.stdDev=isNaN(t.stdDev)?0:t.stdDev,n.value=t.value,r.metrics.push(n),r.properties=t.properties;var i=new k.Data;return i.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Metric),i.baseData=r,i},e.createAvailabilityData=function(t){var r=new k.AvailabilityData;t.id?r.id=t.id:r.id=$t.w3cTraceId(),r.name=t.name,r.duration=$t.msToTimeSpan(t.duration),r.success=t.success,r.runLocation=t.runLocation,r.message=t.message,r.measurements=t.measurements,r.properties=t.properties;var n=new k.Data;return n.baseType=k.telemetryTypeToBaseType(k.TelemetryType.Availability),n.baseData=r,n},e.createPageViewData=function(t){var r=new k.PageViewData;r.name=t.name,r.duration=$t.msToTimeSpan(t.duration),r.url=t.url,r.measurements=t.measurements,r.properties=t.properties;var n=new k.Data;return n.baseType=k.telemetryTypeToBaseType(k.TelemetryType.PageView),n.baseData=r,n},e.getTags=function(t,r){var n=AD.CorrelationContextManager.getCurrentContext(),i={};if(t&&t.tags)for(var s in t.tags)i[s]=t.tags[s];if(r)for(var s in r)i[s]=r[s];return n&&(i[t.keys.operationId]=i[t.keys.operationId]||n.operation.id,i[t.keys.operationName]=i[t.keys.operationName]||n.operation.name,i[t.keys.operationParentId]=i[t.keys.operationParentId]||n.operation.parentId),i},e.parseStack=function(t){var r=void 0;if(typeof t=="string"){var n=t.split(`
`);r=[];for(var i=0,s=0,a=0;a<=n.length;a++){var o=n[a];if(eE.regex.test(o)){var u=new eE(n[a],i++);s+=u.sizeInBytes,r.push(u)}}var c=32*1024;if(s>c)for(var l=0,f=r.length-1,p=0,h=l,v=f;l<f;){var T=r[l].sizeInBytes,S=r[f].sizeInBytes;if(p+=T+S,p>c){var x=v-h+1;r.splice(h,x);break}h=l,v=f,l++,f--}}return r},e}(),eE=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=$t.trim(t);var n=t.match(e.regex);n&&n.length>=5&&(this.method=$t.trim(n[2])||this.method,this.fileName=$t.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();tE.exports=RD});var aE=d((wU,sE)=>{"use strict";var PD=require("url"),DD=Mu(),kD=Ca(),Ur=wt(),OD=G_(),wp=Y_(),nE=wn(),ND=Z_(),qD=kt(),iE=Qe(),LD=rE(),MD=function(){function e(t){this._telemetryProcessors=[],this._enableAzureProperties=!1;var r=new DD(t);this.config=r,this.context=new kD,this.commonProperties={};var n=new ND(this.config);this.channel=new OD(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return e.prototype.trackAvailability=function(t){this.track(t,Ur.TelemetryType.Availability)},e.prototype.trackPageView=function(t){this.track(t,Ur.TelemetryType.PageView)},e.prototype.trackTrace=function(t){this.track(t,Ur.TelemetryType.Trace)},e.prototype.trackMetric=function(t){this.track(t,Ur.TelemetryType.Metric)},e.prototype.trackException=function(t){t&&t.exception&&!qD.isError(t.exception)&&(t.exception=new Error(t.exception.toString())),this.track(t,Ur.TelemetryType.Exception)},e.prototype.trackEvent=function(t){this.track(t,Ur.TelemetryType.Event)},e.prototype.trackRequest=function(t){this.track(t,Ur.TelemetryType.Request)},e.prototype.trackDependency=function(t){t&&!t.target&&t.data&&(t.target=PD.parse(t.data).host),this.track(t,Ur.TelemetryType.Dependency)},e.prototype.flush=function(t){this.channel.triggerSend(t?!!t.isAppCrashing:!1,t?t.callback:void 0)},e.prototype.track=function(t,r){if(t&&Ur.telemetryTypeToBaseType(r)){var n=LD.createEnvelope(t,r,this.commonProperties,this.context,this.config);t.time&&(n.time=t.time.toISOString()),this._enableAzureProperties&&wp.azureRoleEnvironmentTelemetryProcessor(n,this.context);var i=this.runTelemetryProcessors(n,t.contextObjects);i=i&&wp.samplingTelemetryProcessor(n,{correlationContext:nE.CorrelationContextManager.getCurrentContext()}),i&&(wp.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else iE.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(t){this._enableAzureProperties=t},e.prototype.addTelemetryProcessor=function(t){this._telemetryProcessors.push(t)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(t,r){var n=!0,i=this._telemetryProcessors.length;if(i===0)return n;r=r||{},r.correlationContext=nE.CorrelationContextManager.getCurrentContext();for(var s=0;s<i;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[t,r])===!1){n=!1;break}}catch(o){n=!0,iE.warn("One of telemetry processors failed, telemetry item will be sent.",o,t)}return n},e}();sE.exports=MD});var cE=d((Sp,uE)=>{"use strict";var HD=Sp&&Sp.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),FD=aE(),oE=hp(),jD=Zi(),Uu=Qe(),UD=function(e){HD(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?oE.trackRequestSync(this,r):Uu.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&Uu.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?oE.trackRequest(this,r):Uu.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(r){r&&r.request?jD.trackRequest(this,r):Uu.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(FD);uE.exports=UD});var fE=d(lE=>{"use strict";Object.defineProperty(lE,"__esModule",{value:!0})});var DE=d(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});var xp=wn(),$D=Gy(),VD=Qy(),dE=qu(),BD=__(),GD=Zi(),zD=hp(),hE=Dn(),Sa=Qe(),QD=j_(),vE=$_();P.TelemetryClient=cE();P.Contracts=wt();P.azureFunctionsTypes=fE();var gE;(function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C"})(gE=P.DistributedTracingModes||(P.DistributedTracingModes={}));var mE=!0,yE=!1,_E=!0,EE=!0,CE=!1,TE=!0,IE=!0,bE=!0,Ap=!0,wE,$u=!1,SE=!0,xE,AE=void 0,RE=void 0,xa,Aa,Ra,Pa,ts,$n,Da,$r=!1,pE;function XD(e){return P.defaultClient?Sa.info("The default client is already setup"):(P.defaultClient=new P.TelemetryClient(e),xa=new $D(P.defaultClient),Aa=new VD(P.defaultClient),Ra=new dE(P.defaultClient),Pa=new BD(P.defaultClient),$n=new zD(P.defaultClient),Da=new GD(P.defaultClient),ts||(ts=new vE.AutoCollectNativePerformance(P.defaultClient))),P.defaultClient&&P.defaultClient.channel&&P.defaultClient.channel.setUseDiskRetryCaching(bE,AE,RE),Rp}P.setup=XD;function PE(){return P.defaultClient?($r=!0,xa.enable(mE,yE),Aa.enable(_E),Ra.enable(EE),Pa.enable(CE,P.defaultClient.config),ts.enable(SE,xE),$n.useAutoCorrelation(Ap,wE),$n.enable(TE),Da.enable(IE),P.liveMetricsClient&&$u&&P.liveMetricsClient.enable($u)):Sa.warn("Start cannot be called before setup"),Rp}P.start=PE;function WD(){return Ap?xp.CorrelationContextManager.getCurrentContext():null}P.getCorrelationContext=WD;function KD(e,t){return xp.CorrelationContextManager.startOperation(e,t)}P.startOperation=KD;function YD(e,t){return xp.CorrelationContextManager.wrapCallback(e,t)}P.wrapWithCorrelationContext=YD;var Rp=function(){function e(){}return e.setDistributedTracingMode=function(t){return hE.w3cEnabled=t===gE.AI_AND_W3C,e},e.setAutoCollectConsole=function(t,r){return r===void 0&&(r=!1),mE=t,yE=r,$r&&xa.enable(t,r),e},e.setAutoCollectExceptions=function(t){return _E=t,$r&&Aa.enable(t),e},e.setAutoCollectPerformance=function(t,r){r===void 0&&(r=!0),EE=t;var n=vE.AutoCollectNativePerformance.parseEnabled(r);return SE=n.isEnabled,xE=n.disabledMetrics,$r&&(Ra.enable(t),ts.enable(n.isEnabled,n.disabledMetrics)),e},e.setAutoCollectHeartbeat=function(t){return CE=t,$r&&Pa.enable(t,P.defaultClient.config),e},e.setAutoCollectRequests=function(t){return TE=t,$r&&$n.enable(t),e},e.setAutoCollectDependencies=function(t){return IE=t,$r&&Da.enable(t),e},e.setAutoDependencyCorrelation=function(t,r){return Ap=t,wE=r,$r&&$n.useAutoCorrelation(t,r),e},e.setUseDiskRetryCaching=function(t,r,n){return bE=t,AE=r,RE=n,P.defaultClient&&P.defaultClient.channel&&P.defaultClient.channel.setUseDiskRetryCaching(t,r,n),e},e.setInternalLogging=function(t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),Sa.enableDebug=t,Sa.disableWarnings=!r,e},e.setSendLiveMetrics=function(t){return t===void 0&&(t=!1),P.defaultClient?(!P.liveMetricsClient&&t?(P.liveMetricsClient=new QD(P.defaultClient.config.instrumentationKey),pE=new dE(P.liveMetricsClient,1e3,!0),P.liveMetricsClient.addCollector(pE),P.defaultClient.quickPulseClient=P.liveMetricsClient):P.liveMetricsClient&&P.liveMetricsClient.enable(t),$u=t,e):(Sa.warn("Live metrics client cannot be setup without the default client"),e)},e.start=PE,e}();P.Configuration=Rp;function JD(){hE.w3cEnabled=!0,P.defaultClient=null,$r=!1,xa&&xa.dispose(),Aa&&Aa.dispose(),Ra&&Ra.dispose(),Pa&&Pa.dispose(),ts&&ts.dispose(),$n&&$n.dispose(),Da&&Da.dispose(),P.liveMetricsClient&&(P.liveMetricsClient.enable(!1),$u=!1,P.liveMetricsClient=void 0)}P.dispose=JD});var Pp=d((Vu,kE)=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});Vu.default=tk;var ZD=ek(require("crypto"));function ek(e){return e&&e.__esModule?e:{default:e}}function tk(){return ZD.default.randomBytes(16)}kE.exports=Vu.default});var Bu=d((Oa,NE)=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.default=void 0;var OE=[];for(ka=0;ka<256;++ka)OE[ka]=(ka+256).toString(16).substr(1);var ka;function rk(e,t){var r=t||0,n=OE;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var nk=rk;Oa.default=nk;NE.exports=Oa.default});var HE=d((Na,ME)=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.default=void 0;var ik=LE(Pp()),sk=LE(Bu());function LE(e){return e&&e.__esModule?e:{default:e}}var qE,Dp,kp=0,Op=0;function ak(e,t,r){var n=t&&r||0,i=t||[];e=e||{};var s=e.node||qE,a=e.clockseq!==void 0?e.clockseq:Dp;if(s==null||a==null){var o=e.random||(e.rng||ik.default)();s==null&&(s=qE=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),a==null&&(a=Dp=(o[6]<<8|o[7])&16383)}var u=e.msecs!==void 0?e.msecs:new Date().getTime(),c=e.nsecs!==void 0?e.nsecs:Op+1,l=u-kp+(c-Op)/1e4;if(l<0&&e.clockseq===void 0&&(a=a+1&16383),(l<0||u>kp)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");kp=u,Op=c,Dp=a,u+=122192928e5;var f=((u&268435455)*1e4+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;var p=u/4294967296*1e4&268435455;i[n++]=p>>>8&255,i[n++]=p&255,i[n++]=p>>>24&15|16,i[n++]=p>>>16&255,i[n++]=a>>>8|128,i[n++]=a&255;for(var h=0;h<6;++h)i[n+h]=s[h];return t||(0,sk.default)(i)}var ok=ak;Na.default=ok;ME.exports=Na.default});var Np=d(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.default=pk;Vn.URL=Vn.DNS=void 0;var uk=ck(Bu());function ck(e){return e&&e.__esModule?e:{default:e}}function lk(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(r){t.push(parseInt(r,16))}),t}function fk(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}var FE="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Vn.DNS=FE;var jE="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Vn.URL=jE;function pk(e,t,r){var n=function(i,s,a,o){var u=a&&o||0;if(typeof i=="string"&&(i=fk(i)),typeof s=="string"&&(s=lk(s)),!Array.isArray(i))throw TypeError("value must be an array of bytes");if(!Array.isArray(s)||s.length!==16)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=r(s.concat(i));if(c[6]=c[6]&15|t,c[8]=c[8]&63|128,a)for(var l=0;l<16;++l)a[u+l]=c[l];return a||(0,uk.default)(c)};try{n.name=e}catch{}return n.DNS=FE,n.URL=jE,n}});var $E=d((qa,UE)=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.default=void 0;var dk=hk(require("crypto"));function hk(e){return e&&e.__esModule?e:{default:e}}function vk(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),dk.default.createHash("md5").update(e).digest()}var gk=vk;qa.default=gk;UE.exports=qa.default});var GE=d((La,BE)=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.default=void 0;var mk=VE(Np()),yk=VE($E());function VE(e){return e&&e.__esModule?e:{default:e}}var _k=(0,mk.default)("v3",48,yk.default),Ek=_k;La.default=Ek;BE.exports=La.default});var XE=d((Ma,QE)=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.default=void 0;var Ck=zE(Pp()),Tk=zE(Bu());function zE(e){return e&&e.__esModule?e:{default:e}}function Ik(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||Ck.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var s=0;s<16;++s)t[n+s]=i[s];return t||(0,Tk.default)(i)}var bk=Ik;Ma.default=bk;QE.exports=Ma.default});var KE=d((Ha,WE)=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.default=void 0;var wk=Sk(require("crypto"));function Sk(e){return e&&e.__esModule?e:{default:e}}function xk(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),wk.default.createHash("sha1").update(e).digest()}var Ak=xk;Ha.default=Ak;WE.exports=Ha.default});var ZE=d((Fa,JE)=>{"use strict";Object.defineProperty(Fa,"__esModule",{value:!0});Fa.default=void 0;var Rk=YE(Np()),Pk=YE(KE());function YE(e){return e&&e.__esModule?e:{default:e}}var Dk=(0,Rk.default)("v5",80,Pk.default),kk=Dk;Fa.default=kk;JE.exports=Fa.default});var eC=d(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});Object.defineProperty(rs,"v1",{enumerable:!0,get:function(){return Ok.default}});Object.defineProperty(rs,"v3",{enumerable:!0,get:function(){return Nk.default}});Object.defineProperty(rs,"v4",{enumerable:!0,get:function(){return qk.default}});Object.defineProperty(rs,"v5",{enumerable:!0,get:function(){return Lk.default}});var Ok=Gu(HE()),Nk=Gu(GE()),qk=Gu(XE()),Lk=Gu(ZE());function Gu(e){return e&&e.__esModule?e:{default:e}}});var rC=d((PU,tC)=>{"use strict";function Mk(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}tC.exports=Mk});var gC=d(()=>{"use strict";var vC=require("url"),Gn=require("https"),hC="__agent_base_https_request_patched__";Gn.request[hC]||(Gn.request=function(e){return function(t,r){let n;return typeof t=="string"?n=vC.parse(t):n=Object.assign({},t),n.port==null&&(n.port=443),n.secureEndpoint=!0,e.call(Gn,n,r)}}(Gn.request),Gn.request[hC]=!0);Gn.get=function(e,t,r){let n;typeof e=="string"&&t&&typeof t!="function"?n=Object.assign({},vC.parse(e),t):!t&&!r?n=e:r||(n=e,r=t);let i=Gn.request(n,r);return i.end(),i}});var mC=d((Up,$p)=>{(function(e,t){typeof Up=="object"&&typeof $p<"u"?$p.exports=t():typeof define=="function"&&define.amd?define(t):e.ES6Promise=t()})(Up,function(){"use strict";function e(g){var I=typeof g;return g!==null&&(I==="object"||I==="function")}function t(g){return typeof g=="function"}var r=void 0;Array.isArray?r=Array.isArray:r=function(g){return Object.prototype.toString.call(g)==="[object Array]"};var n=r,i=0,s=void 0,a=void 0,o=function(I,b){Y[i]=I,Y[i+1]=b,i+=2,i===2&&(a?a(J):nt())};function u(g){a=g}function c(g){o=g}var l=typeof window<"u"?window:void 0,f=l||{},p=f.MutationObserver||f.WebKitMutationObserver,h=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",v=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function T(){return function(){return process.nextTick(J)}}function S(){return typeof s<"u"?function(){s(J)}:A()}function x(){var g=0,I=new p(J),b=document.createTextNode("");return I.observe(b,{characterData:!0}),function(){b.data=g=++g%2}}function m(){var g=new MessageChannel;return g.port1.onmessage=J,function(){return g.port2.postMessage(0)}}function A(){var g=setTimeout;return function(){return g(J,1)}}var Y=new Array(1e3);function J(){for(var g=0;g<i;g+=2){var I=Y[g],b=Y[g+1];I(b),Y[g]=void 0,Y[g+1]=void 0}i=0}function de(){try{var g=Function("return this")().require("vertx");return s=g.runOnLoop||g.runOnContext,S()}catch{return A()}}var nt=void 0;h?nt=T():p?nt=x():v?nt=m():l===void 0&&typeof require=="function"?nt=de():nt=A();function Mt(g,I){var b=this,R=new this.constructor(xr);R[Ei]===void 0&&jv(R);var F=b._state;if(F){var j=arguments[F-1];o(function(){return Hv(F,R,j,b._result)})}else _l(b,R,g,I);return R}function dt(g){var I=this;if(g&&typeof g=="object"&&g.constructor===I)return g;var b=new I(xr);return Yt(b,g),b}var Ei=Math.random().toString(36).substring(2);function xr(){}var Ar=void 0,_n=1,Rr=2;function En(){return new TypeError("You cannot resolve a promise with itself")}function Cn(){return new TypeError("A promises callback cannot return that same promise.")}function ml(g,I,b,R){try{g.call(I,b,R)}catch(F){return F}}function yl(g,I,b){o(function(R){var F=!1,j=ml(b,I,function(ze){F||(F=!0,I!==ze?Yt(R,ze):Jt(R,ze))},function(ze){F||(F=!0,Fe(R,ze))},"Settle: "+(R._label||" unknown promise"));!F&&j&&(F=!0,Fe(R,j))},g)}function Tn(g,I){I._state===_n?Jt(g,I._result):I._state===Rr?Fe(g,I._result):_l(I,void 0,function(b){return Yt(g,b)},function(b){return Fe(g,b)})}function pr(g,I,b){I.constructor===g.constructor&&b===Mt&&I.constructor.resolve===dt?Tn(g,I):b===void 0?Jt(g,I):t(b)?yl(g,I,b):Jt(g,I)}function Yt(g,I){if(g===I)Fe(g,En());else if(e(I)){var b=void 0;try{b=I.then}catch(R){Fe(g,R);return}pr(g,I,b)}else Jt(g,I)}function Ci(g){g._onerror&&g._onerror(g._result),El(g)}function Jt(g,I){g._state===Ar&&(g._result=I,g._state=_n,g._subscribers.length!==0&&o(El,g))}function Fe(g,I){g._state===Ar&&(g._state=Rr,g._result=I,o(Ci,g))}function _l(g,I,b,R){var F=g._subscribers,j=F.length;g._onerror=null,F[j]=I,F[j+_n]=b,F[j+Rr]=R,j===0&&g._state&&o(El,g)}function El(g){var I=g._subscribers,b=g._state;if(I.length!==0){for(var R=void 0,F=void 0,j=g._result,ze=0;ze<I.length;ze+=3)R=I[ze],F=I[ze+b],R?Hv(b,R,F,j):F(j);g._subscribers.length=0}}function Hv(g,I,b,R){var F=t(b),j=void 0,ze=void 0,Ti=!0;if(F){try{j=b(R)}catch(Bo){Ti=!1,ze=Bo}if(I===j){Fe(I,Cn());return}}else j=R;I._state!==Ar||(F&&Ti?Yt(I,j):Ti===!1?Fe(I,ze):g===_n?Jt(I,j):g===Rr&&Fe(I,j))}function TS(g,I){try{I(function(R){Yt(g,R)},function(R){Fe(g,R)})}catch(b){Fe(g,b)}}var Fv=0;function IS(){return Fv++}function jv(g){g[Ei]=Fv++,g._state=void 0,g._result=void 0,g._subscribers=[]}function bS(){return new Error("Array Methods must be provided an Array")}var wS=function(){function g(I,b){this._instanceConstructor=I,this.promise=new I(xr),this.promise[Ei]||jv(this.promise),n(b)?(this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),this.length===0?Jt(this.promise,this._result):(this.length=this.length||0,this._enumerate(b),this._remaining===0&&Jt(this.promise,this._result))):Fe(this.promise,bS())}return g.prototype._enumerate=function(b){for(var R=0;this._state===Ar&&R<b.length;R++)this._eachEntry(b[R],R)},g.prototype._eachEntry=function(b,R){var F=this._instanceConstructor,j=F.resolve;if(j===dt){var ze=void 0,Ti=void 0,Bo=!1;try{ze=b.then}catch(Tl){Bo=!0,Ti=Tl}if(ze===Mt&&b._state!==Ar)this._settledAt(b._state,R,b._result);else if(typeof ze!="function")this._remaining--,this._result[R]=b;else if(F===It){var Cl=new F(xr);Bo?Fe(Cl,Ti):pr(Cl,b,ze),this._willSettleAt(Cl,R)}else this._willSettleAt(new F(function(Tl){return Tl(b)}),R)}else this._willSettleAt(j(b),R)},g.prototype._settledAt=function(b,R,F){var j=this.promise;j._state===Ar&&(this._remaining--,b===Rr?Fe(j,F):this._result[R]=F),this._remaining===0&&Jt(j,this._result)},g.prototype._willSettleAt=function(b,R){var F=this;_l(b,void 0,function(j){return F._settledAt(_n,R,j)},function(j){return F._settledAt(Rr,R,j)})},g}();function SS(g){return new wS(this,g).promise}function xS(g){var I=this;return n(g)?new I(function(b,R){for(var F=g.length,j=0;j<F;j++)I.resolve(g[j]).then(b,R)}):new I(function(b,R){return R(new TypeError("You must pass an array to race."))})}function AS(g){var I=this,b=new I(xr);return Fe(b,g),b}function RS(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function PS(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var It=function(){function g(I){this[Ei]=IS(),this._result=this._state=void 0,this._subscribers=[],xr!==I&&(typeof I!="function"&&RS(),this instanceof g?TS(this,I):PS())}return g.prototype.catch=function(b){return this.then(null,b)},g.prototype.finally=function(b){var R=this,F=R.constructor;return t(b)?R.then(function(j){return F.resolve(b()).then(function(){return j})},function(j){return F.resolve(b()).then(function(){throw j})}):R.then(b,b)},g}();It.prototype.then=Mt,It.all=SS,It.race=xS,It.resolve=dt,It.reject=AS,It._setScheduler=u,It._setAsap=c,It._asap=o;function DS(){var g=void 0;if(typeof global<"u")g=global;else if(typeof self<"u")g=self;else try{g=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var I=g.Promise;if(I){var b=null;try{b=Object.prototype.toString.call(I.resolve())}catch{}if(b==="[object Promise]"&&!I.cast)return}g.Promise=It}return It.polyfill=DS,It.Promise=It,It})});var _C=d((B3,yC)=>{"use strict";yC.exports=function(){"use strict";var e=void 0;function t(n){return typeof n=="function"}global!==void 0?e=global:window!==void 0&&window.document?e=window:e=self;var r=function(){if(!e.hasOwnProperty("Promise"))return!1;var n=e.Promise;return!n.hasOwnProperty("resolve")||!n.hasOwnProperty("reject")||!n.hasOwnProperty("all")||!n.hasOwnProperty("race")?!1:function(){var i=void 0,s=new e.Promise(function(a){i=a});return s?t(i):!1}()}();return r?e.Promise:mC().Promise}()});var CC=d((G3,EC)=>{"use strict";EC.exports=function(){"use strict";var e=_C();function t(r){return r&&typeof r.then=="function"&&typeof r.catch=="function"}return function(n,i){return function(){for(var s=arguments.length,a=Array(s),o=0;o<s;o++)a[o]=arguments[o];var u=i&&i.multiArgs,c=void 0;return i&&i.thisArg?c=i.thisArg:i&&(c=i),new e(function(l,f){a.push(function(v){if(v)return f(v);for(var T=arguments.length,S=Array(T>1?T-1:0),x=1;x<T;x++)S[x-1]=arguments[x];if(!u)return l(S[0]);l(S)});var p=n.apply(c,a);t(p)&&l(p)})}}}()});var Vp=d((z3,IC)=>{"use strict";gC();var Bk=require("util").inherits,Gk=CC(),TC=require("events").EventEmitter;IC.exports=zn;function zk(e){return e&&typeof e.addRequest=="function"}function zn(e,t){if(!(this instanceof zn))return new zn(e,t);TC.call(this),this._promisifiedCallback=!1;let r=t;typeof e=="function"?this.callback=e:e&&(r=e),this.timeout=r&&r.timeout||null,this.options=r}Bk(zn,TC);zn.prototype.callback=function(t,r){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')};zn.prototype.addRequest=function(t,r){let n=Object.assign({},r);n.host==null&&(n.host="localhost"),n.port==null&&(n.port=n.secureEndpoint?443:80);let i=Object.assign({},this.options,n);i.host&&i.path&&delete i.path,delete i.agent,delete i.hostname,delete i._defaultAgent,delete i.defaultPort,delete i.createConnection,t._last=!0,t.shouldKeepAlive=!1;let s,a=!1,o=this.timeout,u=this.freeSocket;function c(h){t._hadError||(t.emit("error",h),t._hadError=!0)}function l(){s=null,a=!0;let h=new Error('A "socket" was not created for HTTP request before '+o+"ms");h.code="ETIMEOUT",c(h)}function f(h){a||(s!=null&&(clearTimeout(s),s=null),c(h))}function p(h){if(!a)if(s!=null&&(clearTimeout(s),s=null),zk(h))h.addRequest(t,i);else if(h){let v=function(){u(h,i)};h.on("free",v),t.onSocket(h)}else{let v=new Error("no Duplex stream was returned to agent-base for `"+t.method+" "+t.path+"`");c(v)}}!this._promisifiedCallback&&this.callback.length>=3&&(this.callback=Gk(this.callback,this),this._promisifiedCallback=!0),o>0&&(s=setTimeout(l,o));try{Promise.resolve(this.callback(t,i)).then(p,f)}catch(h){Promise.reject(h).catch(f)}};zn.prototype.freeSocket=function(t,r){t.destroy()}});var wC=d((Q3,bC)=>{var Va=1e3,Ba=Va*60,Ga=Ba*60,za=Ga*24,Qk=za*365.25;bC.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Xk(e);if(r==="number"&&isNaN(e)===!1)return t.long?Kk(e):Wk(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Xk(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Qk;case"days":case"day":case"d":return r*za;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ga;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ba;case"seconds":case"second":case"secs":case"sec":case"s":return r*Va;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Wk(e){return e>=za?Math.round(e/za)+"d":e>=Ga?Math.round(e/Ga)+"h":e>=Ba?Math.round(e/Ba)+"m":e>=Va?Math.round(e/Va)+"s":e+"ms"}function Kk(e){return Ju(e,za,"day")||Ju(e,Ga,"hour")||Ju(e,Ba,"minute")||Ju(e,Va,"second")||e+" ms"}function Ju(e,t,r){if(!(e<t))return e<t*1.5?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}});var Gp=d((U,SC)=>{U=SC.exports=Bp.debug=Bp.default=Bp;U.coerce=rO;U.disable=eO;U.enable=Zk;U.enabled=tO;U.humanize=wC();U.instances=[];U.names=[];U.skips=[];U.formatters={};function Yk(e){var t=0,r;for(r in e)t=(t<<5)-t+e.charCodeAt(r),t|=0;return U.colors[Math.abs(t)%U.colors.length]}function Bp(e){var t;function r(){if(!!r.enabled){var n=r,i=+new Date,s=i-(t||i);n.diff=s,n.prev=t,n.curr=i,t=i;for(var a=new Array(arguments.length),o=0;o<a.length;o++)a[o]=arguments[o];a[0]=U.coerce(a[0]),typeof a[0]!="string"&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(l,f){if(l==="%%")return l;u++;var p=U.formatters[f];if(typeof p=="function"){var h=a[u];l=p.call(n,h),a.splice(u,1),u--}return l}),U.formatArgs.call(n,a);var c=r.log||U.log||console.log.bind(console);c.apply(n,a)}}return r.namespace=e,r.enabled=U.enabled(e),r.useColors=U.useColors(),r.color=Yk(e),r.destroy=Jk,typeof U.init=="function"&&U.init(r),U.instances.push(r),r}function Jk(){var e=U.instances.indexOf(this);return e!==-1?(U.instances.splice(e,1),!0):!1}function Zk(e){U.save(e),U.names=[],U.skips=[];var t,r=(typeof e=="string"?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)!r[t]||(e=r[t].replace(/\*/g,".*?"),e[0]==="-"?U.skips.push(new RegExp("^"+e.substr(1)+"$")):U.names.push(new RegExp("^"+e+"$")));for(t=0;t<U.instances.length;t++){var i=U.instances[t];i.enabled=U.enabled(i.namespace)}}function eO(){U.enable("")}function tO(e){if(e[e.length-1]==="*")return!0;var t,r;for(t=0,r=U.skips.length;t<r;t++)if(U.skips[t].test(e))return!1;for(t=0,r=U.names.length;t<r;t++)if(U.names[t].test(e))return!0;return!1}function rO(e){return e instanceof Error?e.stack||e.message:e}});var RC=d((mt,AC)=>{mt=AC.exports=Gp();mt.log=sO;mt.formatArgs=iO;mt.save=aO;mt.load=xC;mt.useColors=nO;mt.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:oO();mt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function nO(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}mt.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function iO(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+mt.humanize(this.diff),!!t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(s){s!=="%%"&&(n++,s==="%c"&&(i=n))}),e.splice(i,0,r)}}function sO(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function aO(e){try{e==null?mt.storage.removeItem("debug"):mt.storage.debug=e}catch{}}function xC(){var e;try{e=mt.storage.debug}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}mt.enable(xC());function oO(){try{return window.localStorage}catch{}}});var DC=d((X3,PC)=>{"use strict";PC.exports=(e,t)=>{t=t||process.argv;let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return n!==-1&&(i===-1?!0:n<i)}});var OC=d((W3,kC)=>{"use strict";var uO=require("os"),sr=DC(),ut=process.env,ns;sr("no-color")||sr("no-colors")||sr("color=false")?ns=!1:(sr("color")||sr("colors")||sr("color=true")||sr("color=always"))&&(ns=!0);"FORCE_COLOR"in ut&&(ns=ut.FORCE_COLOR.length===0||parseInt(ut.FORCE_COLOR,10)!==0);function cO(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function lO(e){if(ns===!1)return 0;if(sr("color=16m")||sr("color=full")||sr("color=truecolor"))return 3;if(sr("color=256"))return 2;if(e&&!e.isTTY&&ns!==!0)return 0;let t=ns?1:0;if(process.platform==="win32"){let r=uO.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in ut)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in ut)||ut.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in ut)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(ut.TEAMCITY_VERSION)?1:0;if(ut.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in ut){let r=parseInt((ut.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(ut.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(ut.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(ut.TERM)||"COLORTERM"in ut?1:(ut.TERM==="dumb",t)}function zp(e){let t=lO(e);return cO(t)}kC.exports={supportsColor:zp,stdout:zp(process.stdout),stderr:zp(process.stderr)}});var LC=d(($e,qC)=>{var fO=require("tty"),Zu=require("util");$e=qC.exports=Gp();$e.init=mO;$e.log=vO;$e.formatArgs=dO;$e.save=gO;$e.load=NC;$e.useColors=pO;$e.colors=[6,2,3,4,5,1];try{Qp=OC(),Qp&&Qp.level>=2&&($e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}var Qp;$e.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(i,s){return s.toUpperCase()}),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function pO(){return"colors"in $e.inspectOpts?Boolean($e.inspectOpts.colors):fO.isatty(process.stderr.fd)}$e.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,Zu.inspect(e,this.inspectOpts).split(`
`).map(function(t){return t.trim()}).join(" ")};$e.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,Zu.inspect(e,this.inspectOpts)};function dO(e){var t=this.namespace,r=this.useColors;if(r){var n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s="  "+i+";1m"+t+" \x1B[0m";e[0]=s+e[0].split(`
`).join(`
`+s),e.push(i+"m+"+$e.humanize(this.diff)+"\x1B[0m")}else e[0]=hO()+t+" "+e[0]}function hO(){return $e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function vO(){return process.stderr.write(Zu.format.apply(Zu,arguments)+`
`)}function gO(e){e==null?delete process.env.DEBUG:process.env.DEBUG=e}function NC(){return process.env.DEBUG}function mO(e){e.inspectOpts={};for(var t=Object.keys($e.inspectOpts),r=0;r<t.length;r++)e.inspectOpts[t[r]]=$e.inspectOpts[t[r]]}$e.enable(NC())});var Wp=d((K3,Xp)=>{typeof process>"u"||process.type==="renderer"?Xp.exports=RC():Xp.exports=LC()});var FC=d((Y3,HC)=>{var yO=require("net"),_O=require("tls"),Kp=require("url"),MC=Vp(),EO=require("util").inherits,ec=Wp()("http-proxy-agent");HC.exports=Qa;function Qa(e){if(!(this instanceof Qa))return new Qa(e);if(typeof e=="string"&&(e=Kp.parse(e)),!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");ec("creating new HttpProxyAgent instance: %o",e),MC.call(this,e);var t=Object.assign({},e);this.secureProxy=t.protocol?/^https:?$/i.test(t.protocol):!1,t.host=t.hostname||t.host,t.port=+t.port||(this.secureProxy?443:80),t.host&&t.path&&(delete t.path,delete t.pathname),this.proxy=t}EO(Qa,MC);Qa.prototype.callback=function(t,r,n){var i=this.proxy,s=Kp.parse(t.path);s.protocol==null&&(s.protocol="http:"),s.hostname==null&&(s.hostname=r.hostname||r.host),s.port==null&&(s.port=r.port),s.port==80&&delete s.port;var a=Kp.format(s);t.path=a,i.auth&&t.setHeader("Proxy-Authorization","Basic "+Buffer.from(i.auth).toString("base64"));var o;if(this.secureProxy?o=_O.connect(i):o=yO.connect(i),t._header&&(ec("regenerating stored HTTP header string for request"),t._header=null,t._implicitHeader(),t.output&&t.output.length>0)){ec("patching connection write() output buffer with updated header");var u=t.output[0],c=u.indexOf(`\r
\r
`)+4;t.output[0]=t._header+u.substring(c),ec("output buffer: %o",t.output)}n(null,o)}});var BC=d((J3,VC)=>{var jC=require("net"),UC=require("tls"),CO=require("url"),TO=require("assert"),$C=Vp(),IO=require("util").inherits,Qn=Wp()("https-proxy-agent");VC.exports=Xa;function Xa(e){if(!(this instanceof Xa))return new Xa(e);if(typeof e=="string"&&(e=CO.parse(e)),!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Qn("creating new HttpsProxyAgent instance: %o",e),$C.call(this,e);var t=Object.assign({},e);this.secureProxy=t.protocol?/^https:?$/i.test(t.protocol):!1,t.host=t.hostname||t.host,t.port=+t.port||(this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in t)&&(t.ALPNProtocols=["http 1.1"]),t.host&&t.path&&(delete t.path,delete t.pathname),this.proxy=t,this.defaultPort=443}IO(Xa,$C);Xa.prototype.callback=function(t,r,n){var i=this.proxy,s;this.secureProxy?s=UC.connect(i):s=jC.connect(i);var a=[],o=0;function u(){var A=s.read();A?h(A):s.once("readable",u)}function c(){s.removeListener("end",f),s.removeListener("error",p),s.removeListener("close",l),s.removeListener("readable",u)}function l(A){Qn("onclose had error %o",A)}function f(){Qn("onend")}function p(A){c(),n(A)}function h(A){a.push(A),o+=A.length;var Y=Buffer.concat(a,o),J=Y.toString("ascii");if(!~J.indexOf(`\r
\r
`)){Qn("have not received end of HTTP headers yet..."),u();return}var de=J.substring(0,J.indexOf(`\r
`)),nt=+de.split(" ")[1];if(Qn("got proxy server response: %o",de),nt==200){var Mt=s;a=Y=null,r.secureEndpoint&&(Qn("upgrading proxy-connected socket to TLS connection: %o",r.host),r.socket=s,r.servername=r.servername||r.host,r.host=null,r.hostname=null,r.port=null,Mt=UC.connect(r)),c(),t.once("socket",bO),n(null,Mt)}else c(),s.destroy(),s=new jC.Socket,s.readable=!0,a=Y,t.once("socket",v),n(null,s)}function v(A){Qn("replaying proxy buffer for failed request"),TO(A.listenerCount("data")>0),A.push(a),a=null}s.on("error",p),s.on("close",l),s.on("end",f),u();var T=r.host+":"+r.port,S="CONNECT "+T+` HTTP/1.1\r
`,x=Object.assign({},i.headers);i.auth&&(x["Proxy-Authorization"]="Basic "+Buffer.from(i.auth).toString("base64"));var m=r.host;wO(r.port,r.secureEndpoint)||(m+=":"+r.port),x.Host=m,x.Connection="close",Object.keys(x).forEach(function(A){S+=A+": "+x[A]+`\r
`}),s.write(S+`\r
`)};function bO(e){e.resume()}function wO(e,t){return Boolean(!t&&e===80||t&&e===443)}});var Ke=d((S$,r0)=>{"use strict";var NO=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();r0.exports=NO});var sc=d(pn=>{"use strict";var n0=pn&&pn.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(pn,"__esModule",{value:!0});var Wn=Kn(),qO=require("events"),LO;(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(LO=pn.SpanKind||(pn.SpanKind={}));var i0=function(){function e(){}return e.prototype.active=function(){var t=this,r=Wn.CorrelationContextManager.getCurrentContext();return n0({},r,{getValue:function(n){return t._activeSymbol?n===t._activeSymbol?r:!1:(t._activeSymbol=n,r)},setValue:function(){}})},e.prototype.with=function(t,r){var n=t.parentSpanId,i=t.name,s=e._spanToContext(t,n,i);return Wn.CorrelationContextManager.runWithContext(s,r)()},e.prototype.bind=function(t){return typeof t=="function"?Wn.CorrelationContextManager.wrapCallback(t):(t instanceof qO.EventEmitter&&Wn.CorrelationContextManager.wrapEmitter(t),t)},e.prototype.enable=function(){return Wn.CorrelationContextManager.enable(),this},e.prototype.disable=function(){return Wn.CorrelationContextManager.disable(),this},e._spanToContext=function(t,r,n){var i=r?"|"+t.context().traceId+"."+r+".":t.context().traceId,s=n0({},t.context(),{traceFlags:t.context().traceFlags.toString()}),a=Wn.CorrelationContextManager.spanToContextObject(s,i,n);return a},e}();pn.OpenTelemetryScopeManagerWrapper=i0;pn.AsyncScopeManager=new i0});var C0=d((q,E0)=>{q=E0.exports=X;var oe;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?oe=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:oe=function(){};q.SEMVER_SPEC_VERSION="2.0.0";var Wa=256,ac=Number.MAX_SAFE_INTEGER||9007199254740991,Jp=16,MO=Wa-6,Ka=q.re=[],ge=q.safeRe=[],_=q.src=[],V=0,nd="[a-zA-Z0-9-]",Zp=[["\\s",1],["\\d",Wa],[nd,MO]];function pc(e){for(var t=0;t<Zp.length;t++){var r=Zp[t][0],n=Zp[t][1];e=e.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return e}var is=V++;_[is]="0|[1-9]\\d*";var ss=V++;_[ss]="\\d+";var id=V++;_[id]="\\d*[a-zA-Z-]"+nd+"*";var a0=V++;_[a0]="("+_[is]+")\\.("+_[is]+")\\.("+_[is]+")";var o0=V++;_[o0]="("+_[ss]+")\\.("+_[ss]+")\\.("+_[ss]+")";var ed=V++;_[ed]="(?:"+_[is]+"|"+_[id]+")";var td=V++;_[td]="(?:"+_[ss]+"|"+_[id]+")";var sd=V++;_[sd]="(?:-("+_[ed]+"(?:\\."+_[ed]+")*))";var ad=V++;_[ad]="(?:-?("+_[td]+"(?:\\."+_[td]+")*))";var rd=V++;_[rd]=nd+"+";var Ja=V++;_[Ja]="(?:\\+("+_[rd]+"(?:\\."+_[rd]+")*))";var od=V++,u0="v?"+_[a0]+_[sd]+"?"+_[Ja]+"?";_[od]="^"+u0+"$";var ud="[v=\\s]*"+_[o0]+_[ad]+"?"+_[Ja]+"?",cd=V++;_[cd]="^"+ud+"$";var ls=V++;_[ls]="((?:<|>)?=?)";var oc=V++;_[oc]=_[ss]+"|x|X|\\*";var uc=V++;_[uc]=_[is]+"|x|X|\\*";var Yn=V++;_[Yn]="[v=\\s]*("+_[uc]+")(?:\\.("+_[uc]+")(?:\\.("+_[uc]+")(?:"+_[sd]+")?"+_[Ja]+"?)?)?";var os=V++;_[os]="[v=\\s]*("+_[oc]+")(?:\\.("+_[oc]+")(?:\\.("+_[oc]+")(?:"+_[ad]+")?"+_[Ja]+"?)?)?";var c0=V++;_[c0]="^"+_[ls]+"\\s*"+_[Yn]+"$";var l0=V++;_[l0]="^"+_[ls]+"\\s*"+_[os]+"$";var f0=V++;_[f0]="(?:^|[^\\d])(\\d{1,"+Jp+"})(?:\\.(\\d{1,"+Jp+"}))?(?:\\.(\\d{1,"+Jp+"}))?(?:$|[^\\d])";var dc=V++;_[dc]="(?:~>?)";var us=V++;_[us]="(\\s*)"+_[dc]+"\\s+";Ka[us]=new RegExp(_[us],"g");ge[us]=new RegExp(pc(_[us]),"g");var HO="$1~",p0=V++;_[p0]="^"+_[dc]+_[Yn]+"$";var d0=V++;_[d0]="^"+_[dc]+_[os]+"$";var hc=V++;_[hc]="(?:\\^)";var cs=V++;_[cs]="(\\s*)"+_[hc]+"\\s+";Ka[cs]=new RegExp(_[cs],"g");ge[cs]=new RegExp(pc(_[cs]),"g");var FO="$1^",h0=V++;_[h0]="^"+_[hc]+_[Yn]+"$";var v0=V++;_[v0]="^"+_[hc]+_[os]+"$";var ld=V++;_[ld]="^"+_[ls]+"\\s*("+ud+")$|^$";var fd=V++;_[fd]="^"+_[ls]+"\\s*("+u0+")$|^$";var Jn=V++;_[Jn]="(\\s*)"+_[ls]+"\\s*("+ud+"|"+_[Yn]+")";Ka[Jn]=new RegExp(_[Jn],"g");ge[Jn]=new RegExp(pc(_[Jn]),"g");var jO="$1$2$3",g0=V++;_[g0]="^\\s*("+_[Yn]+")\\s+-\\s+("+_[Yn]+")\\s*$";var m0=V++;_[m0]="^\\s*("+_[os]+")\\s+-\\s+("+_[os]+")\\s*$";var y0=V++;_[y0]="(<|>)?=?\\s*\\*";for(Cr=0;Cr<V;Cr++)oe(Cr,_[Cr]),Ka[Cr]||(Ka[Cr]=new RegExp(_[Cr]),ge[Cr]=new RegExp(pc(_[Cr])));var Cr;q.parse=Zn;function Zn(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof X)return e;if(typeof e!="string"||e.length>Wa)return null;var r=t.loose?ge[cd]:ge[od];if(!r.test(e))return null;try{return new X(e,t)}catch{return null}}q.valid=UO;function UO(e,t){var r=Zn(e,t);return r?r.version:null}q.clean=$O;function $O(e,t){var r=Zn(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}q.SemVer=X;function X(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof X){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>Wa)throw new TypeError("version is longer than "+Wa+" characters");if(!(this instanceof X))return new X(e,t);oe("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?ge[cd]:ge[od]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>ac||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ac||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ac||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<ac)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}X.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};X.prototype.toString=function(){return this.version};X.prototype.compare=function(e){return oe("SemVer.compare",this.version,this.options,e),e instanceof X||(e=new X(e,this.options)),this.compareMain(e)||this.comparePre(e)};X.prototype.compareMain=function(e){return e instanceof X||(e=new X(e,this.options)),as(this.major,e.major)||as(this.minor,e.minor)||as(this.patch,e.patch)};X.prototype.comparePre=function(e){if(e instanceof X||(e=new X(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(oe("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return as(r,n)}while(++t)};X.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};q.inc=VO;function VO(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new X(e,r).inc(t,n).version}catch{return null}}q.diff=BO;function BO(e,t){if(pd(e,t))return null;var r=Zn(e),n=Zn(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return i+a;return s}q.compareIdentifiers=as;var s0=/^[0-9]+$/;function as(e,t){var r=s0.test(e),n=s0.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}q.rcompareIdentifiers=GO;function GO(e,t){return as(t,e)}q.major=zO;function zO(e,t){return new X(e,t).major}q.minor=QO;function QO(e,t){return new X(e,t).minor}q.patch=XO;function XO(e,t){return new X(e,t).patch}q.compare=Vr;function Vr(e,t,r){return new X(e,r).compare(new X(t,r))}q.compareLoose=WO;function WO(e,t){return Vr(e,t,!0)}q.rcompare=KO;function KO(e,t,r){return Vr(t,e,r)}q.sort=YO;function YO(e,t){return e.sort(function(r,n){return q.compare(r,n,t)})}q.rsort=JO;function JO(e,t){return e.sort(function(r,n){return q.rcompare(r,n,t)})}q.gt=Ya;function Ya(e,t,r){return Vr(e,t,r)>0}q.lt=cc;function cc(e,t,r){return Vr(e,t,r)<0}q.eq=pd;function pd(e,t,r){return Vr(e,t,r)===0}q.neq=_0;function _0(e,t,r){return Vr(e,t,r)!==0}q.gte=dd;function dd(e,t,r){return Vr(e,t,r)>=0}q.lte=hd;function hd(e,t,r){return Vr(e,t,r)<=0}q.cmp=lc;function lc(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return pd(e,r,n);case"!=":return _0(e,r,n);case">":return Ya(e,r,n);case">=":return dd(e,r,n);case"<":return cc(e,r,n);case"<=":return hd(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}q.Comparator=Bt;function Bt(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Bt){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof Bt))return new Bt(e,t);e=e.trim().split(/\s+/).join(" "),oe("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Za?this.value="":this.value=this.operator+this.semver.version,oe("comp",this)}var Za={};Bt.prototype.parse=function(e){var t=this.options.loose?ge[ld]:ge[fd],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new X(r[2],this.options.loose):this.semver=Za};Bt.prototype.toString=function(){return this.value};Bt.prototype.test=function(e){return oe("Comparator.test",e,this.options.loose),this.semver===Za?!0:(typeof e=="string"&&(e=new X(e,this.options)),lc(e,this.operator,this.semver,this.options))};Bt.prototype.intersects=function(e,t){if(!(e instanceof Bt))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new Se(e.value,t),fc(this.value,r,t);if(e.operator==="")return r=new Se(this.value,t),fc(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,a=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=lc(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),u=lc(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||s&&a||o||u};q.Range=Se;function Se(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Se(e.raw,t);if(e instanceof Bt)return new Se(e.value,t);if(!(this instanceof Se))return new Se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Se.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};Se.prototype.toString=function(){return this.range};Se.prototype.parseRange=function(e){var t=this.options.loose,r=t?ge[m0]:ge[g0];e=e.replace(r,uN),oe("hyphen replace",e),e=e.replace(ge[Jn],jO),oe("comparator trim",e,ge[Jn]),e=e.replace(ge[us],HO),e=e.replace(ge[cs],FO);var n=t?ge[ld]:ge[fd],i=e.split(" ").map(function(s){return eN(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new Bt(s,this.options)},this),i};Se.prototype.intersects=function(e,t){if(!(e instanceof Se))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(s){return n.intersects(s,t)})})})})};q.toComparators=ZO;function ZO(e,t){return new Se(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function eN(e,t){return oe("comp",e,t),e=nN(e,t),oe("caret",e),e=tN(e,t),oe("tildes",e),e=sN(e,t),oe("xrange",e),e=oN(e,t),oe("stars",e),e}function yt(e){return!e||e.toLowerCase()==="x"||e==="*"}function tN(e,t){return e.trim().split(/\s+/).map(function(r){return rN(r,t)}).join(" ")}function rN(e,t){var r=t.loose?ge[d0]:ge[p0];return e.replace(r,function(n,i,s,a,o){oe("tilde",e,n,i,s,a,o);var u;return yt(i)?u="":yt(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":yt(a)?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":o?(oe("replaceTilde pr",o),u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0"):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0",oe("tilde return",u),u})}function nN(e,t){return e.trim().split(/\s+/).map(function(r){return iN(r,t)}).join(" ")}function iN(e,t){oe("caret",e,t);var r=t.loose?ge[v0]:ge[h0];return e.replace(r,function(n,i,s,a,o){oe("caret",e,n,i,s,a,o);var u;return yt(i)?u="":yt(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":yt(a)?i==="0"?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+".0 <"+(+i+1)+".0.0":o?(oe("replaceCaret pr",o),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+"-"+o+" <"+(+i+1)+".0.0"):(oe("no pr"),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+" <"+(+i+1)+".0.0"),oe("caret return",u),u})}function sN(e,t){return oe("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return aN(r,t)}).join(" ")}function aN(e,t){e=e.trim();var r=t.loose?ge[l0]:ge[c0];return e.replace(r,function(n,i,s,a,o,u){oe("xRange",e,n,i,s,a,o,u);var c=yt(s),l=c||yt(a),f=l||yt(o),p=f;return i==="="&&p&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&p?(l&&(a=0),o=0,i===">"?(i=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):i==="<="&&(i="<",l?s=+s+1:a=+a+1),n=i+s+"."+a+"."+o):l?n=">="+s+".0.0 <"+(+s+1)+".0.0":f&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),oe("xRange return",n),n})}function oN(e,t){return oe("replaceStars",e,t),e.trim().replace(ge[y0],"")}function uN(e,t,r,n,i,s,a,o,u,c,l,f,p){return yt(r)?t="":yt(n)?t=">="+r+".0.0":yt(i)?t=">="+r+"."+n+".0":t=">="+t,yt(u)?o="":yt(c)?o="<"+(+u+1)+".0.0":yt(l)?o="<"+u+"."+(+c+1)+".0":f?o="<="+u+"."+c+"."+l+"-"+f:o="<="+o,(t+" "+o).trim()}Se.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new X(e,this.options));for(var t=0;t<this.set.length;t++)if(cN(this.set[t],e,this.options))return!0;return!1};function cN(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(oe(e[n].semver),e[n].semver!==Za&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}q.satisfies=fc;function fc(e,t,r){try{t=new Se(t,r)}catch{return!1}return t.test(e)}q.maxSatisfying=lN;function lN(e,t,r){var n=null,i=null;try{var s=new Se(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new X(n,r))}),n}q.minSatisfying=fN;function fN(e,t,r){var n=null,i=null;try{var s=new Se(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new X(n,r))}),n}q.minVersion=pN;function pN(e,t){e=new Se(e,t);var r=new X("0.0.0");if(e.test(r)||(r=new X("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(s){var a=new X(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Ya(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&e.test(r)?r:null}q.validRange=dN;function dN(e,t){try{return new Se(e,t).range||"*"}catch{return null}}q.ltr=hN;function hN(e,t,r){return vd(e,t,"<",r)}q.gtr=vN;function vN(e,t,r){return vd(e,t,">",r)}q.outside=vd;function vd(e,t,r,n){e=new X(e,n),t=new Se(t,n);var i,s,a,o,u;switch(r){case">":i=Ya,s=hd,a=cc,o=">",u=">=";break;case"<":i=cc,s=dd,a=Ya,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(fc(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],f=null,p=null;if(l.forEach(function(h){h.semver===Za&&(h=new Bt(">=0.0.0")),f=f||h,p=p||h,i(h.semver,f.semver,n)?f=h:a(h.semver,p.semver,n)&&(p=h)}),f.operator===o||f.operator===u||(!p.operator||p.operator===o)&&s(e,p.semver))return!1;if(p.operator===u&&a(e,p.semver))return!1}return!0}q.prerelease=gN;function gN(e,t){var r=Zn(e,t);return r&&r.prerelease.length?r.prerelease:null}q.intersects=mN;function mN(e,t,r){return e=new Se(e,r),t=new Se(t,r),e.intersects(t)}q.coerce=yN;function yN(e){if(e instanceof X)return e;if(typeof e!="string")return null;var t=e.match(ge[f0]);return t==null?null:Zn(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var md=d(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});var _N=require("path"),EN=C0(),I0=require("module"),CN=Object.keys(process.binding("natives")),T0=I0.prototype.require;function TN(e){var t={};return function(n){var i=T0.apply(this,arguments);if(e[n]){var s=I0._resolveFilename(n,this);if(t.hasOwnProperty(s))return t[s];var a=void 0;if(CN.indexOf(n)<0)try{a=T0.call(this,_N.join(n,"package.json")).version}catch{return i}else a=process.version.substring(1);var o=a.indexOf("-");o>=0&&(a=a.substring(0,o));for(var u=i,c=0,l=e[n];c<l.length;c++){var f=l[c];EN.satisfies(a,f.versionSpecifier)&&(u=f.patch(u,s))}return t[s]=u}return i}}gd.makePatchingRequire=TN});var b0=d((R$,IN)=>{IN.exports={name:"diagnostic-channel",version:"0.3.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"^7.0.12",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"^2.2.1"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var Le=d(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});var bN=md(),wN=md();vc.makePatchingRequire=wN.makePatchingRequire;var w0=function(e){return!0},SN=function(){function e(){this.version=b0().version,this.subscribers={},this.contextPreservationFunction=function(t){return t},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(t){var r=this.subscribers[t];return r?r.some(function(n){var i=n.filter;return!i||i(!1)}):!1},e.prototype.publish=function(t,r){if(!this.currentlyPublishing){var n=this.subscribers[t];if(n){var i={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,o=s.filter;try{o&&o(!0)&&a(i)}catch{}}),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(t,r,n){n===void 0&&(n=w0),this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push({listener:r,filter:n})},e.prototype.unsubscribe=function(t,r,n){n===void 0&&(n=w0);var i=this.subscribers[t];if(i){for(var s=0;s<i.length;++s)if(i[s].listener===r&&i[s].filter===n)return i.splice(s,1),!0}return!1},e.prototype.reset=function(){var t=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete t.knownPatches[r]})},e.prototype.bindToContext=function(t){return this.contextPreservationFunction(t)},e.prototype.addContextPreservation=function(t){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return t(r(n))}},e.prototype.registerMonkeyPatch=function(t,r){this.knownPatches[t]||(this.knownPatches[t]=[]),this.knownPatches[t].push(r)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new SN,S0=require("module"),S0.prototype.require=bN.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var S0;vc.channel=global.diagnosticsSource});var A0=d(Br=>{"use strict";var xN=Br&&Br.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Br,"__esModule",{value:!0});var gc=Le();Br.AzureMonitorSymbol="Azure_Monitor_Tracer";var x0=!1,AN=function(e){if(x0)return e;try{var t=require("@opentelemetry/tracing"),r=require("@opentelemetry/api"),n=gc.channel.spanContextPropagator?{contextManager:gc.channel.spanContextPropagator}:void 0;new t.BasicTracerProvider().register(n);var i=r.trace.getTracer("applicationinsights tracer"),s=i.startSpan;i.startSpan=function(a,o){if(!o||!o.parent){var u=r.getSpan(r.context.active());u&&u.operation&&u.operation.traceparent&&(o=xN({},o,{parent:{traceId:u.operation.traceparent.traceId,spanId:u.operation.traceparent.spanId,traceFlags:1}}))}var c=s.call(this,a,o),l=c.end;return c.end=function(){var f=l.apply(this,arguments);return gc.channel.publish("azure-coretracing",c),f},c},r.getSpan(r.context.active()),i[Br.AzureMonitorSymbol]=!0,e.setTracer(i),x0=!0}catch{}return e};Br.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:AN};function RN(){gc.channel.registerMonkeyPatch("@azure/core-tracing",Br.azureCoreTracing)}Br.enable=RN});var P0=d(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});var R0=Le(),PN=function(e){var t=e.prototype._emit;return e.prototype._emit=function(r,n){var i=t.apply(this,arguments);if(!n){var s=i;s||(s=t.call(this,r,!0)),R0.channel.publish("bunyan",{level:r.level,result:s})}return i},e};eo.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:PN};function DN(){R0.channel.registerMonkeyPatch("bunyan",eo.bunyan)}eo.enable=DN});var k0=d(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var yd=Le(),D0=require("stream"),kN=function(e){var t=new D0.Writable,r=new D0.Writable;t.write=function(c){if(!c)return!0;var l=c.toString();return yd.channel.publish("console",{message:l}),!0},r.write=function(c){if(!c)return!0;var l=c.toString();return yd.channel.publish("console",{message:l,stderr:!0}),!0};for(var n=new e.Console(t,r),i=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(c){var l=e[c];l&&(e[c]=function(){if(n[c])try{n[c].apply(n,arguments)}catch{}return l.apply(e,arguments)})},a=0,o=i;a<o.length;a++){var u=o[a];s(u)}return e};to.console={versionSpecifier:">= 4.0.0",patch:kN};function ON(){yd.channel.registerMonkeyPatch("console",to.console),require("console")}to.enable=ON});var O0=d(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});var _d=Le(),NN=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.pool.write;this.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=_d.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=_d.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e};ro.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:NN};function qN(){_d.channel.registerMonkeyPatch("mongodb-core",ro.mongoCore)}ro.enable=qN});var q0=d(ar=>{"use strict";var N0=ar&&ar.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(ar,"__esModule",{value:!0});var ct=Le(),LN=function(e){var t=e.instrument({operationIdGenerator:{next:function(){return ct.channel.bindToContext(function(n){return n()})}}}),r={};return t.on("started",function(n){r[n.requestId]||(r[n.requestId]=N0({},n,{time:new Date}))}),t.on("succeeded",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return ct.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}):ct.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}),t.on("failed",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return ct.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}):ct.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}),e},MN=function(e){var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=ct.channel.bindToContext(function(s){return s()}),r[i.requestId]=N0({},i,{time:new Date}))}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ct.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ct.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e},HN=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=ct.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=ct.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e},FN=function(e){HN(e);var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=ct.channel.bindToContext(function(s){return s()}),r[i.requestId]=i)}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ct.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ct.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e};ar.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:LN};ar.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:MN};ar.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:FN};function jN(){ct.channel.registerMonkeyPatch("mongodb",ar.mongo2),ct.channel.registerMonkeyPatch("mongodb",ar.mongo3),ct.channel.registerMonkeyPatch("mongodb",ar.mongo330)}ar.enable=jN});var M0=d(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});var mc=Le(),L0=require("path"),UN=function(e,t){var r=function(u,c){return function(l,f){var p=u[l];p&&(u[l]=function(){for(var v=arguments.length-1,T=arguments.length-1;T>=0;--T)if(typeof arguments[T]=="function"){v=T;break}else if(typeof arguments[T]<"u")break;var S=arguments[v],x={result:null,startTime:null,startDate:null};typeof S=="function"&&(f?(x.startTime=process.hrtime(),x.startDate=new Date,arguments[v]=mc.channel.bindToContext(f(x,S))):arguments[v]=mc.channel.bindToContext(S));var m=p.apply(this,arguments);return x.result=m,m})}},n=function(u,c){return r(u.prototype,c+".prototype")},i=["connect","changeUser","ping","statistics","end"],s=require(L0.dirname(t)+"/lib/Connection");i.forEach(function(u){return n(s,"Connection")(u)}),r(s,"Connection")("createQuery",function(u,c){return function(l){var f=process.hrtime(u.startTime),p=f[0]*1e3+f[1]/1e6|0;mc.channel.publish("mysql",{query:u.result,callbackArgs:arguments,err:l,duration:p,time:u.startDate}),c.apply(this,arguments)}});var a=["_enqueueCallback"],o=require(L0.dirname(t)+"/lib/Pool");return a.forEach(function(u){return n(o,"Pool")(u)}),e};no.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:UN};function $N(){mc.channel.registerMonkeyPatch("mysql",no.mysql)}no.enable=$N});var F0=d(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});var H0=Le();function VN(e){var t=e.prototype.connect;return e.prototype.connect=function(n){return n&&(arguments[0]=H0.channel.bindToContext(n)),t.apply(this,arguments)},e}io.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:VN};function BN(){H0.channel.registerMonkeyPatch("pg-pool",io.postgresPool1)}io.enable=BN});var U0=d(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});var fs=Le(),j0=require("events");function GN(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},c=process.hrtime(),l;function f(p){p&&p[n]&&(p=p[n]);var h=fs.channel.bindToContext(function(v,T){var S=process.hrtime(c);if(u.result=T&&{rowCount:T.rowCount,command:T.command},u.error=v,u.duration=Math.ceil(S[0]*1e3+S[1]/1e6),fs.channel.publish("postgres",u),v){if(p)return p.apply(this,arguments);l&&l instanceof j0.EventEmitter&&l.emit("error",v)}else p&&p.apply(this,arguments)});try{return Object.defineProperty(h,n,{value:p}),h}catch{return p}}try{typeof s=="string"?a instanceof Array?(u.query.preparable={text:s,args:a},o=f(o)):(u.query.text=s,o?o=f(o):a=f(a)):(typeof s.name=="string"?u.query.plan=s.name:s.values instanceof Array?u.query.preparable={text:s.text,args:s.values}:u.query.text=s.text,o?o=f(o):a?a=f(a):s.callback=f(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,l=r.apply(this,arguments),l},e}function zN(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var u=this,c=!!o,l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},f=process.hrtime(),p;function h(v){v&&v[n]&&(v=v[n]);var T=fs.channel.bindToContext(function(S,x){var m=process.hrtime(f);if(l.result=x&&{rowCount:x.rowCount,command:x.command},l.error=S,l.duration=Math.ceil(m[0]*1e3+m[1]/1e6),fs.channel.publish("postgres",l),S){if(v)return v.apply(this,arguments);p&&p instanceof j0.EventEmitter&&p.emit("error",S)}else v&&v.apply(this,arguments)});try{return Object.defineProperty(T,n,{value:v}),T}catch{return v}}try{typeof s=="string"?a instanceof Array?(l.query.preparable={text:s,args:a},c=typeof o=="function",o=c?h(o):o):(l.query.text=s,o?(c=typeof o=="function",o=c?h(o):o):(c=typeof a=="function",a=c?h(a):a)):(typeof s.name=="string"?l.query.plan=s.name:s.values instanceof Array?l.query.preparable={text:s.text,args:s.values}:l.query.text=s.text,o?(c=typeof o=="function",o=h(o)):a?(c=typeof a=="function",a=c?h(a):a):(c=typeof s.callback=="function",s.callback=c?h(s.callback):s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,p=r.apply(this,arguments),c?p:p.then(function(v){return h()(void 0,v),new u._Promise(function(T,S){T(v)})}).catch(function(v){return h()(v,void 0),new u._Promise(function(T,S){S(v)})})},e}ei.postgres6={versionSpecifier:"6.*",patch:GN};ei.postgres7={versionSpecifier:">=7.* <=8.*",patch:zN};function QN(){fs.channel.registerMonkeyPatch("pg",ei.postgres6),fs.channel.registerMonkeyPatch("pg",ei.postgres7)}ei.enable=QN});var $0=d(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});var Ed=Le(),XN=function(e){var t=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var i=this.address,s=process.hrtime(),a=new Date;r.callback=Ed.channel.bindToContext(function(o,u){var c=process.hrtime(s),l=c[0]*1e3+c[1]/1e6|0;Ed.channel.publish("redis",{duration:l,address:i,commandObj:r,err:o,result:u,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return t.call(this,r)},e};so.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:XN};function WN(){Ed.channel.registerMonkeyPatch("redis",so.redis)}so.enable=WN});var V0=d(ti=>{"use strict";var KN=ti&&ti.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(ti,"__esModule",{value:!0});var Cd=Le(),YN=function(e){var t=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),o={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return Cd.channel.bindToContext(function(u,c,l){var f=process.hrtime(a);o=KN({},o,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!u&&{rowCount:c,rows:l},query:{text:this.parametersByName.statement.value},error:u,duration:Math.ceil(f[0]*1e3+f[1]/1e6)}),Cd.channel.publish("tedious",o),s.call(this,u,c,l)})}var i=arguments[0];arguments[0].callback=n(i.callback),t.apply(this,arguments)},e};ti.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:YN};function JN(){Cd.channel.registerMonkeyPatch("tedious",ti.tedious)}ti.enable=JN});var B0=d(or=>{"use strict";var ZN=or&&or.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eq=or&&or.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(or,"__esModule",{value:!0});var yc=Le(),tq=function(e){var t=e.Logger.prototype.log,r,n=function(i,s,a){var o;return r===e.config.npm.levels?o="npm":r===e.config.syslog.levels?o="syslog":o="unknown",yc.channel.publish("winston",{level:i,message:s,meta:a,levelKind:o}),s};return e.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),t.apply(this,arguments)},e},rq=function(e){var t=function(a,o){var u;return a.config.npm.levels[o]!=null?u="npm":a.config.syslog.levels[o]!=null?u="syslog":u="unknown",u},r=function(a){ZN(o,a);function o(u,c){var l=a.call(this,c)||this;return l.winston=u,l}return o.prototype.log=function(u,c){var l=u.message,f=u.level,p=u.meta,h=eq(u,["message","level","meta"]);f=typeof Symbol.for=="function"?u[Symbol.for("level")]:f,l=u instanceof Error?u:l;var v=t(this.winston,f);p=p||{};for(var T in h)h.hasOwnProperty(T)&&(p[T]=h[T]);yc.channel.publish("winston",{message:l,level:f,levelKind:v,meta:p}),c()},o}(e.Transport);function n(){var a=arguments[0].levels||e.config.npm.levels,o;for(var u in a)a.hasOwnProperty(u)&&(o=o===void 0||a[u]>a[o]?u:o);this.add(new r(e,{level:o}))}var i=e.createLogger;e.createLogger=function(){var o=arguments[0].levels||e.config.npm.levels,u;for(var c in o)o.hasOwnProperty(c)&&(u=u===void 0||o[c]>o[u]?c:u);var l=i.apply(this,arguments);l.add(new r(e,{level:u}));var f=l.configure;return l.configure=function(){f.apply(this,arguments),n.apply(this,arguments)},l};var s=e.configure;return e.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},e.add(new r(e)),e};or.winston3={versionSpecifier:"3.x",patch:rq};or.winston2={versionSpecifier:"2.x",patch:tq};function nq(){yc.channel.registerMonkeyPatch("winston",or.winston2),yc.channel.registerMonkeyPatch("winston",or.winston3)}or.enable=nq});var rT=d(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});var G0=A0();At.azuresdk=G0;var z0=P0();At.bunyan=z0;var Q0=k0();At.console=Q0;var X0=O0();At.mongodbCore=X0;var W0=q0();At.mongodb=W0;var K0=M0();At.mysql=K0;var Y0=F0();At.pgPool=Y0;var J0=U0();At.pg=J0;var Z0=$0();At.redis=Z0;var eT=V0();At.tedious=eT;var tT=B0();At.winston=tT;function iq(){z0.enable(),Q0.enable(),X0.enable(),W0.enable(),K0.enable(),J0.enable(),Y0.enable(),Z0.enable(),tT.enable(),G0.enable(),eT.enable()}At.enable=iq});var Cc=d(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});var sq=sc(),Td=Ke();ps.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var Id="DiagnosticChannel";if(ps.IsInitialized){ur=rT(),nT=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",_c=nT.split(","),bd={bunyan:ur.bunyan,console:ur.console,mongodb:ur.mongodb,mongodbCore:ur.mongodbCore,mysql:ur.mysql,redis:ur.redis,pg:ur.pg,pgPool:ur.pgPool,winston:ur.winston,azuresdk:ur.azuresdk};for(Ec in bd)_c.indexOf(Ec)===-1&&(bd[Ec].enable(),Td.info(Id,"Subscribed to "+Ec+" events"));_c.length>0&&Td.info(Id,"Some modules will not be patched",_c)}else Td.info(Id,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var ur,nT,_c,bd,Ec;function aq(e){if(!!ps.IsInitialized){var t=Le();t.channel.addContextPreservation(e),t.channel.spanContextPropagator=sq.AsyncScopeManager}}ps.registerContextPreservation=aq});var ds=d((B$,iT)=>{"use strict";iT.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var Nt=d((xd,aT)=>{"use strict";var wd=xd&&xd.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},oq=require("http"),sT=require("https"),Sd=require("url"),Tc=require("constants"),ao=Ke(),hs=ds(),uq=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&typeof r=="string")for(var i=t+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=e.trim(r),r&&r.indexOf(i)===0){n=r.substring(i.length,s[a].length);break}}return n},e.trim=function(t){return typeof t=="string"?t.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(t){var r=function(o,u){return String.fromCharCode(o>>u&255)},n=function(o){return r(o,24)+r(o,16)+r(o,8)+r(o,0)},i=t.map(n).join(""),s=Buffer.from?Buffer.from(i,"binary"):new Buffer(i,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,i=0;i<4;i++)n=e.random32(),r+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var s=t[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(t){return t.length===32&&t!=="00000000000000000000000000000000"},e.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"},e.isError=function(t){return t instanceof Error},e.isPrimitive=function(t){var r=typeof t;return r==="string"||r==="number"||r==="boolean"},e.isDate=function(t){return Object.prototype.toString.call(t)==="[object Date]"},e.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var r=(t/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i;var a=s>0?s+".":"";return a+i+":"+n+":"+r},e.extractError=function(t){var r=t;return{message:t.message,code:r.code||r.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):typeof t.toJSON=="function"?t.toJSON():t},e.validateStringMap=function(t){if(typeof t!="object"){ao.info("Invalid properties dropped from payload");return}var r={};for(var n in t){var i="",s=t[n],a=typeof s;if(e.isPrimitive(s))i=s.toString();else if(s===null||a==="undefined")i="";else if(a==="function"){ao.info("key: "+n+" was function; will not serialize");continue}else{var o=e.isArray(s)?s:e.extractObject(s);try{e.isPrimitive(o)?i=o:i=JSON.stringify(o)}catch(u){i=s.constructor.name.toString()+" (Error: "+u.message+")",ao.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,e.MAX_PROPERTY_LENGTH)}return r},e.canIncludeCorrelationHeader=function(t,r){var n=t&&t.config&&t.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var i=0;i<n.length;i++){var s=new RegExp(n[i].replace(/\./g,".").replace(/\*/g,".*"));if(s.test(Sd.parse(r).hostname))return!1}return!0},e.getCorrelationContextTarget=function(t,r){var n=t.headers&&t.headers[hs.requestContextHeader];if(n)for(var i=n.split(","),s=0;s<i.length;++s){var a=i[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},e.makeRequest=function(t,r,n,i){r&&r.indexOf("//")===0&&(r="https:"+r);var s=Sd.parse(r),a=wd({},n,{host:s.hostname,port:s.port,path:s.pathname}),o=void 0;if(s.protocol==="https:"&&(o=t.proxyHttpsUrl||void 0),s.protocol==="http:"&&(o=t.proxyHttpUrl||void 0),o){o.indexOf("//")===0&&(o="http:"+o);var u=Sd.parse(o);u.protocol==="https:"?(ao.info("Proxies that use HTTPS are not supported"),o=void 0):a=wd({},a,{host:u.hostname,port:u.port||"80",path:r,headers:wd({},a.headers,{Host:s.hostname})})}var c=s.protocol==="https:"&&!o;return c&&t.httpsAgent!==void 0?a.agent=t.httpsAgent:!c&&t.httpAgent!==void 0?a.agent=t.httpAgent:c&&(a.agent=e.tlsRestrictedAgent),c?sT.request(a,i):oq.request(a,i)},e.safeIncludeCorrelationHeader=function(t,r,n){var i;if(typeof n=="string")i=n;else if(n instanceof Array)i=n.join(",");else if(n&&typeof n.toString=="function")try{i=n.toString()}catch(s){ao.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}i?e.addCorrelationIdHeaderFromString(t,r,i):r.setHeader(hs.requestContextHeader,hs.requestContextSourceKey+"="+t.config.correlationId)},e.addCorrelationIdHeaderFromString=function(t,r,n){var i=n.split(","),s=hs.requestContextSourceKey+"=",a=i.some(function(o){return o.substring(0,s.length)===s});a||r.setHeader(hs.requestContextHeader,n+","+hs.requestContextSourceKey+"="+t.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new sT.Agent({secureOptions:Tc.SSL_OP_NO_SSLv2|Tc.SSL_OP_NO_SSLv3|Tc.SSL_OP_NO_TLSv1|Tc.SSL_OP_NO_TLSv1_1}),e}();aT.exports=uq});var ri=d((G$,oT)=>{"use strict";var Ic=Nt(),Ad=Ke(),cq=function(){function e(){}return e.queryCorrelationId=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(n)){r(e.completedLookups[n]);return}else if(e.pendingLookups[n]){e.pendingLookups[n].push(r);return}e.pendingLookups[n]=[r];var i=function(){if(!!e.pendingLookups[n]){var s={method:"GET",disableAppInsightsAutoCollection:!0};Ad.info(e.TAG,s);var a=Ic.makeRequest(t,n,s,function(o){if(o.statusCode===200){var u="";o.setEncoding("utf-8"),o.on("data",function(c){u+=c}),o.on("end",function(){Ad.info(e.TAG,u);var c=e.correlationIdPrefix+u;e.completedLookups[n]=c,e.pendingLookups[n]&&e.pendingLookups[n].forEach(function(l){return l(c)}),delete e.pendingLookups[n]})}else o.statusCode>=400&&o.statusCode<500?(e.completedLookups[n]=void 0,delete e.pendingLookups[n]):setTimeout(i,t.correlationIdRetryIntervalMs)});a&&(a.on("error",function(o){Ad.warn(e.TAG,o)}),a.end())}};setTimeout(i,0)},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",i=e.pendingLookups[n];i&&(e.pendingLookups[n]=i.filter(function(s){return s!=r}),e.pendingLookups[n].length==0&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){t=t[0]=="|"?t:"|"+t,t[t.length-1]!=="."&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}else return e.generateRootId()},e.getRootId=function(t){var r=t.indexOf(".");r<0&&(r=t.length);var n=t[0]==="|"?1:0;return t.substring(n,r)},e.generateRootId=function(){return"|"+Ic.w3cTraceId()+"."},e.appendSuffix=function(t,r,n){if(t.length+r.length<e.requestIdMaxLength)return t+r+n;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var s=t[i-1];if(s==="."||s==="_")break}if(i<=1)return e.generateRootId();for(r=Ic.randomu32().toString(16);r.length<8;)r="0"+r;return t.substring(0,i)+r+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=Ic.randomu32(),e}();oT.exports=cq});var oo=d((z$,uT)=>{"use strict";var et=Nt(),lq=ri(),fq=function(){function e(t,r){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&typeof t=="string")if(t.split(",").length>1)this.traceId=et.w3cTraceId(),this.spanId=et.w3cTraceId().substr(0,16);else{var n=t.trim().split("-"),i=n.length;i>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=et.w3cTraceId(),this.spanId=et.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=et.w3cTraceId()),this.version==="00"&&i!==4&&(this.traceId=et.w3cTraceId(),this.spanId=et.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=e.DEFAULT_VERSION,this.traceId=et.w3cTraceId(),this.spanId=et.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=et.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=et.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=et.w3cTraceId().substr(0,16),this.traceId=et.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=lq.getRootId(r);e.isValidTraceId(s)||(this.legacyRootId=s,s=et.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=et.w3cTraceId(),this.spanId=et.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&t!=="00000000000000000000000000000000"},e.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&t!=="0000000000000000"},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=et.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();uT.exports=fq});var Rd=d((Q$,cT)=>{"use strict";var pq=function(){function e(t){this.fieldmap=[],t&&(this.fieldmap=this.parseHeader(t))}return e.prototype.toString=function(){var t=this.fieldmap;return!t||t.length==0?null:t.join(", ")},e.validateKeyChars=function(t){var r=t.split("@");if(r.length==2){var n=r[0].trim(),i=r[1].trim(),s=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),a=Boolean(i.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return s&&a}else if(r.length==1)return Boolean(t.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},e.prototype.parseHeader=function(t){var r=[],n={},i=t.split(",");if(i.length>32)return null;for(var s=0,a=i;s<a.length;s++){var o=a[s],u=o.trim();if(u.length!==0){var c=u.split("=");if(c.length!==2||!e.validateKeyChars(c[0])||n[c[0]])return null;n[c[0]]=!0,r.push(u)}}return r},e.strict=!0,e}();cT.exports=pq});var Gr=d((X$,lT)=>{"use strict";var dq=function(){function e(){}return e}();lT.exports=dq});var pT=d((Pd,fT)=>{"use strict";var hq=Pd&&Pd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vq=Gr(),gq=function(e){hq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(vq);fT.exports=gq});var Dd=d((W$,dT)=>{"use strict";var mq=function(){function e(){}return e}();dT.exports=mq});var vT=d((K$,hT)=>{"use strict";var yq=function(){function e(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return e}();hT.exports=yq});var mT=d((kd,gT)=>{"use strict";var _q=kd&&kd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Eq=Dd(),Cq=function(e){_q(t,e);function t(){return e.call(this)||this}return t}(Eq);gT.exports=Cq});var Nd=d((Y$,yT)=>{"use strict";var Od;(function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"})(Od||(Od={}));yT.exports=Od});var ET=d((J$,_T)=>{"use strict";var Tq=Nd(),Iq=function(){function e(){this.kind=Tq.Measurement}return e}();_T.exports=Iq});var TT=d((Z$,CT)=>{"use strict";var bq=function(){function e(){this.ver=1,this.sampleRate=100,this.tags={}}return e}();CT.exports=bq});var Ld=d((qd,IT)=>{"use strict";var wq=qd&&qd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sq=Gr(),xq=function(e){wq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(Sq);IT.exports=xq});var wT=d((Md,bT)=>{"use strict";var Aq=Md&&Md.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Rq=Gr(),Pq=function(e){Aq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return t}(Rq);bT.exports=Pq});var xT=d((eV,ST)=>{"use strict";var Dq=function(){function e(){this.hasFullStack=!0,this.parsedStack=[]}return e}();ST.exports=Dq});var RT=d((Hd,AT)=>{"use strict";var kq=Hd&&Hd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Oq=Gr(),Nq=function(e){kq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r}return t}(Oq);AT.exports=Nq});var DT=d((Fd,PT)=>{"use strict";var qq=Fd&&Fd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Lq=Gr(),Mq=function(e){qq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return t}(Lq);PT.exports=Mq});var OT=d((jd,kT)=>{"use strict";var Hq=jd&&jd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fq=Ld(),jq=function(e){Hq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(Fq);kT.exports=jq});var qT=d((Ud,NT)=>{"use strict";var Uq=Ud&&Ud.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$q=Gr(),Vq=function(e){Uq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return t}($q);NT.exports=Vq});var MT=d(($d,LT)=>{"use strict";var Bq=$d&&$d.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gq=Gr(),zq=function(e){Bq(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(Gq);LT.exports=zq});var Bd=d((tV,HT)=>{"use strict";var Vd;(function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"})(Vd||(Vd={}));HT.exports=Vd});var jT=d((rV,FT)=>{"use strict";var Qq=function(){function e(){}return e}();FT.exports=Qq});var Gd=d(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.AvailabilityData=pT();Ve.Base=Dd();Ve.ContextTagKeys=vT();Ve.Data=mT();Ve.DataPoint=ET();Ve.DataPointType=Nd();Ve.Domain=Gr();Ve.Envelope=TT();Ve.EventData=Ld();Ve.ExceptionData=wT();Ve.ExceptionDetails=xT();Ve.MessageData=RT();Ve.MetricData=DT();Ve.PageViewData=OT();Ve.RemoteDependencyData=qT();Ve.RequestData=MT();Ve.SeverityLevel=Bd();Ve.StackFrame=jT()});var UT=d(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});var ni=Gd(),Xq=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();bc.RemoteDependencyDataConstants=Xq;function Wq(e){return"properties"in e||e instanceof ni.EventData||e instanceof ni.ExceptionData||e instanceof ni.MessageData||e instanceof ni.MetricData||e instanceof ni.PageViewData||e instanceof ni.RemoteDependencyData||e instanceof ni.RequestData}bc.domainSupportsProperties=Wq});var $T=d(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});function Kq(e){switch(e){case tt.Event:return"EventData";case tt.Exception:return"ExceptionData";case tt.Trace:return"MessageData";case tt.Metric:return"MetricData";case tt.Request:return"RequestData";case tt.Dependency:return"RemoteDependencyData";case tt.Availability:return"AvailabilityData";case tt.PageView:return"PageViewData"}}ii.telemetryTypeToBaseType=Kq;function Yq(e){switch(e){case"EventData":return tt.Event;case"ExceptionData":return tt.Exception;case"MessageData":return tt.Trace;case"MetricData":return tt.Metric;case"RequestData":return tt.Request;case"RemoteDependencyData":return tt.Dependency;case"AvailabilityData":return tt.Availability;case"PageViewData":return tt.PageView}}ii.baseTypeToTelemetryType=Yq;ii.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var tt;(function(e){e[e.Event=0]="Event",e[e.Exception=1]="Exception",e[e.Trace=2]="Trace",e[e.Metric=3]="Metric",e[e.Request=4]="Request",e[e.Dependency=5]="Dependency",e[e.Availability=6]="Availability",e[e.PageView=7]="PageView"})(tt=ii.TelemetryType||(ii.TelemetryType={}))});var VT=d(wc=>{"use strict";function Jq(e){for(var t in e)wc.hasOwnProperty(t)||(wc[t]=e[t])}Object.defineProperty(wc,"__esModule",{value:!0});Jq($T())});var qt=d(Sc=>{"use strict";function zd(e){for(var t in e)Sc.hasOwnProperty(t)||(Sc[t]=e[t])}Object.defineProperty(Sc,"__esModule",{value:!0});zd(UT());zd(Gd());zd(VT())});var Qd=d((uV,BT)=>{"use strict";var Zq=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(t,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=t;var i=this.properties||{};if(r){if(typeof r=="string")i.error=r;else if(r instanceof Error)i.error=r.message;else if(typeof r=="object")for(var s in r)i[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=i},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();BT.exports=Zq});var Kd=d((Wd,zT)=>{"use strict";var e1=Wd&&Wd.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xc=require("url"),t1=qt(),GT=Nt(),si=ds(),r1=Qd(),dn=ri(),n1=Rd(),Xd=oo(),i1=function(e){e1(t,e);function t(r,n){var i=e.call(this)||this;return r&&(i.method=r.method,i.url=i._getAbsoluteUrl(r),i.startTime=+new Date,i.socketRemoteAddress=r.socket&&r.socket.remoteAddress,i.parseHeaders(r,n),r.connection&&(i.connectionRemoteAddress=r.connection.remoteAddress,i.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),i}return t.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},t.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},t.prototype.getRequestTelemetry=function(r){var n={id:this.requestId,name:this.method+" "+xc.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?n.time=r.time:this.startTime&&(n.time=new Date(this.startTime)),r){for(var i in r)n[i]||(n[i]=r[i]);if(r.properties)for(var i in r.properties)n.properties[i]=r.properties[i]}return n},t.prototype.getRequestTags=function(r){var n={};for(var i in r)n[i]=r[i];return n[t.keys.locationIp]=r[t.keys.locationIp]||this._getIp(),n[t.keys.sessionId]=r[t.keys.sessionId]||this._getId("ai_session"),n[t.keys.userId]=r[t.keys.userId]||this._getId("ai_user"),n[t.keys.userAuthUserId]=r[t.keys.userAuthUserId]||this._getId("ai_authUser"),n[t.keys.operationName]=this.getOperationName(r),n[t.keys.operationParentId]=this.getOperationParentId(r),n[t.keys.operationId]=this.getOperationId(r),n},t.prototype.getOperationId=function(r){return r[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(r){return r[t.keys.operationParentId]||this.parentId||this.getOperationId(r)},t.prototype.getOperationName=function(r){return r[t.keys.operationName]||this.method+" "+xc.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,i=xc.parse(r.url),s=i.pathname,a=i.search,o=xc.format({protocol:n?"https":"http",host:r.headers.host,pathname:s,search:a});return o},t.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},i=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!i&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(i="127.0.0.1"),i},t.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",i=t.parseId(GT.getCookie(r,n));return i},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=GT.getCorrelationContextTarget(r,si.requestContextSourceKey),r.headers){var i=r.headers[si.traceStateHeader],s=r.headers[si.traceparentHeader],a=r.headers[si.requestIdHeader],o=r.headers[si.parentIdHeader],u=r.headers[si.rootIdHeader];this.correlationContextHeader=r.headers[si.correlationContextHeader],dn.w3cEnabled&&(s||i)?(this.traceparent=new Xd(s),this.tracestate=s&&i&&new n1(i),this.setBackCompatFromThisTraceContext()):a?dn.w3cEnabled?(this.traceparent=new Xd(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=dn.generateRequestId(this.parentId),this.operationId=dn.getRootId(this.requestId)):dn.w3cEnabled?(this.traceparent=new Xd,this.traceparent.parentId=o,this.traceparent.legacyRootId=u||o,this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=dn.generateRequestId(u||this.parentId),this.correlationContextHeader=null,this.operationId=dn.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=dn.getRootId(this.requestId))}},t.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},t.keys=new t1.ContextTagKeys,t}(r1);zT.exports=i1});var cI=d((L,uI)=>{L=uI.exports=W;var ue;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?ue=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:ue=function(){};L.SEMVER_SPEC_VERSION="2.0.0";var uo=256,Ac=Number.MAX_SAFE_INTEGER||9007199254740991,Yd=16,s1=uo-6,co=L.re=[],me=L.safeRe=[],E=L.src=[],B=0,rh="[a-zA-Z0-9-]",Jd=[["\\s",1],["\\d",uo],[rh,s1]];function Nc(e){for(var t=0;t<Jd.length;t++){var r=Jd[t][0],n=Jd[t][1];e=e.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return e}var vs=B++;E[vs]="0|[1-9]\\d*";var gs=B++;E[gs]="\\d+";var nh=B++;E[nh]="\\d*[a-zA-Z-]"+rh+"*";var XT=B++;E[XT]="("+E[vs]+")\\.("+E[vs]+")\\.("+E[vs]+")";var WT=B++;E[WT]="("+E[gs]+")\\.("+E[gs]+")\\.("+E[gs]+")";var Zd=B++;E[Zd]="(?:"+E[vs]+"|"+E[nh]+")";var eh=B++;E[eh]="(?:"+E[gs]+"|"+E[nh]+")";var ih=B++;E[ih]="(?:-("+E[Zd]+"(?:\\."+E[Zd]+")*))";var sh=B++;E[sh]="(?:-?("+E[eh]+"(?:\\."+E[eh]+")*))";var th=B++;E[th]=rh+"+";var fo=B++;E[fo]="(?:\\+("+E[th]+"(?:\\."+E[th]+")*))";var ah=B++,KT="v?"+E[XT]+E[ih]+"?"+E[fo]+"?";E[ah]="^"+KT+"$";var oh="[v=\\s]*"+E[WT]+E[sh]+"?"+E[fo]+"?",uh=B++;E[uh]="^"+oh+"$";var Cs=B++;E[Cs]="((?:<|>)?=?)";var Rc=B++;E[Rc]=E[gs]+"|x|X|\\*";var Pc=B++;E[Pc]=E[vs]+"|x|X|\\*";var ai=B++;E[ai]="[v=\\s]*("+E[Pc]+")(?:\\.("+E[Pc]+")(?:\\.("+E[Pc]+")(?:"+E[ih]+")?"+E[fo]+"?)?)?";var ys=B++;E[ys]="[v=\\s]*("+E[Rc]+")(?:\\.("+E[Rc]+")(?:\\.("+E[Rc]+")(?:"+E[sh]+")?"+E[fo]+"?)?)?";var YT=B++;E[YT]="^"+E[Cs]+"\\s*"+E[ai]+"$";var JT=B++;E[JT]="^"+E[Cs]+"\\s*"+E[ys]+"$";var ZT=B++;E[ZT]="(?:^|[^\\d])(\\d{1,"+Yd+"})(?:\\.(\\d{1,"+Yd+"}))?(?:\\.(\\d{1,"+Yd+"}))?(?:$|[^\\d])";var qc=B++;E[qc]="(?:~>?)";var _s=B++;E[_s]="(\\s*)"+E[qc]+"\\s+";co[_s]=new RegExp(E[_s],"g");me[_s]=new RegExp(Nc(E[_s]),"g");var a1="$1~",eI=B++;E[eI]="^"+E[qc]+E[ai]+"$";var tI=B++;E[tI]="^"+E[qc]+E[ys]+"$";var Lc=B++;E[Lc]="(?:\\^)";var Es=B++;E[Es]="(\\s*)"+E[Lc]+"\\s+";co[Es]=new RegExp(E[Es],"g");me[Es]=new RegExp(Nc(E[Es]),"g");var o1="$1^",rI=B++;E[rI]="^"+E[Lc]+E[ai]+"$";var nI=B++;E[nI]="^"+E[Lc]+E[ys]+"$";var ch=B++;E[ch]="^"+E[Cs]+"\\s*("+oh+")$|^$";var lh=B++;E[lh]="^"+E[Cs]+"\\s*("+KT+")$|^$";var oi=B++;E[oi]="(\\s*)"+E[Cs]+"\\s*("+oh+"|"+E[ai]+")";co[oi]=new RegExp(E[oi],"g");me[oi]=new RegExp(Nc(E[oi]),"g");var u1="$1$2$3",iI=B++;E[iI]="^\\s*("+E[ai]+")\\s+-\\s+("+E[ai]+")\\s*$";var sI=B++;E[sI]="^\\s*("+E[ys]+")\\s+-\\s+("+E[ys]+")\\s*$";var aI=B++;E[aI]="(<|>)?=?\\s*\\*";for(Tr=0;Tr<B;Tr++)ue(Tr,E[Tr]),co[Tr]||(co[Tr]=new RegExp(E[Tr]),me[Tr]=new RegExp(Nc(E[Tr])));var Tr;L.parse=ui;function ui(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof W)return e;if(typeof e!="string"||e.length>uo)return null;var r=t.loose?me[uh]:me[ah];if(!r.test(e))return null;try{return new W(e,t)}catch{return null}}L.valid=c1;function c1(e,t){var r=ui(e,t);return r?r.version:null}L.clean=l1;function l1(e,t){var r=ui(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}L.SemVer=W;function W(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof W){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>uo)throw new TypeError("version is longer than "+uo+" characters");if(!(this instanceof W))return new W(e,t);ue("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?me[uh]:me[ah]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Ac||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ac||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ac||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<Ac)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}W.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};W.prototype.toString=function(){return this.version};W.prototype.compare=function(e){return ue("SemVer.compare",this.version,this.options,e),e instanceof W||(e=new W(e,this.options)),this.compareMain(e)||this.comparePre(e)};W.prototype.compareMain=function(e){return e instanceof W||(e=new W(e,this.options)),ms(this.major,e.major)||ms(this.minor,e.minor)||ms(this.patch,e.patch)};W.prototype.comparePre=function(e){if(e instanceof W||(e=new W(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(ue("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return ms(r,n)}while(++t)};W.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};L.inc=f1;function f1(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new W(e,r).inc(t,n).version}catch{return null}}L.diff=p1;function p1(e,t){if(fh(e,t))return null;var r=ui(e),n=ui(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return i+a;return s}L.compareIdentifiers=ms;var QT=/^[0-9]+$/;function ms(e,t){var r=QT.test(e),n=QT.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}L.rcompareIdentifiers=d1;function d1(e,t){return ms(t,e)}L.major=h1;function h1(e,t){return new W(e,t).major}L.minor=v1;function v1(e,t){return new W(e,t).minor}L.patch=g1;function g1(e,t){return new W(e,t).patch}L.compare=zr;function zr(e,t,r){return new W(e,r).compare(new W(t,r))}L.compareLoose=m1;function m1(e,t){return zr(e,t,!0)}L.rcompare=y1;function y1(e,t,r){return zr(t,e,r)}L.sort=_1;function _1(e,t){return e.sort(function(r,n){return L.compare(r,n,t)})}L.rsort=E1;function E1(e,t){return e.sort(function(r,n){return L.rcompare(r,n,t)})}L.gt=lo;function lo(e,t,r){return zr(e,t,r)>0}L.lt=Dc;function Dc(e,t,r){return zr(e,t,r)<0}L.eq=fh;function fh(e,t,r){return zr(e,t,r)===0}L.neq=oI;function oI(e,t,r){return zr(e,t,r)!==0}L.gte=ph;function ph(e,t,r){return zr(e,t,r)>=0}L.lte=dh;function dh(e,t,r){return zr(e,t,r)<=0}L.cmp=kc;function kc(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return fh(e,r,n);case"!=":return oI(e,r,n);case">":return lo(e,r,n);case">=":return ph(e,r,n);case"<":return Dc(e,r,n);case"<=":return dh(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}L.Comparator=Gt;function Gt(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Gt){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof Gt))return new Gt(e,t);e=e.trim().split(/\s+/).join(" "),ue("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===po?this.value="":this.value=this.operator+this.semver.version,ue("comp",this)}var po={};Gt.prototype.parse=function(e){var t=this.options.loose?me[ch]:me[lh],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new W(r[2],this.options.loose):this.semver=po};Gt.prototype.toString=function(){return this.value};Gt.prototype.test=function(e){return ue("Comparator.test",e,this.options.loose),this.semver===po?!0:(typeof e=="string"&&(e=new W(e,this.options)),kc(e,this.operator,this.semver,this.options))};Gt.prototype.intersects=function(e,t){if(!(e instanceof Gt))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new xe(e.value,t),Oc(this.value,r,t);if(e.operator==="")return r=new xe(this.value,t),Oc(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,a=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=kc(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),u=kc(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||s&&a||o||u};L.Range=xe;function xe(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof xe)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new xe(e.raw,t);if(e instanceof Gt)return new xe(e.value,t);if(!(this instanceof xe))return new xe(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}xe.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};xe.prototype.toString=function(){return this.range};xe.prototype.parseRange=function(e){var t=this.options.loose,r=t?me[sI]:me[iI];e=e.replace(r,P1),ue("hyphen replace",e),e=e.replace(me[oi],u1),ue("comparator trim",e,me[oi]),e=e.replace(me[_s],a1),e=e.replace(me[Es],o1);var n=t?me[ch]:me[lh],i=e.split(" ").map(function(s){return T1(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new Gt(s,this.options)},this),i};xe.prototype.intersects=function(e,t){if(!(e instanceof xe))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(s){return n.intersects(s,t)})})})})};L.toComparators=C1;function C1(e,t){return new xe(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function T1(e,t){return ue("comp",e,t),e=w1(e,t),ue("caret",e),e=I1(e,t),ue("tildes",e),e=x1(e,t),ue("xrange",e),e=R1(e,t),ue("stars",e),e}function _t(e){return!e||e.toLowerCase()==="x"||e==="*"}function I1(e,t){return e.trim().split(/\s+/).map(function(r){return b1(r,t)}).join(" ")}function b1(e,t){var r=t.loose?me[tI]:me[eI];return e.replace(r,function(n,i,s,a,o){ue("tilde",e,n,i,s,a,o);var u;return _t(i)?u="":_t(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":_t(a)?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":o?(ue("replaceTilde pr",o),u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0"):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0",ue("tilde return",u),u})}function w1(e,t){return e.trim().split(/\s+/).map(function(r){return S1(r,t)}).join(" ")}function S1(e,t){ue("caret",e,t);var r=t.loose?me[nI]:me[rI];return e.replace(r,function(n,i,s,a,o){ue("caret",e,n,i,s,a,o);var u;return _t(i)?u="":_t(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":_t(a)?i==="0"?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+".0 <"+(+i+1)+".0.0":o?(ue("replaceCaret pr",o),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+"-"+o+" <"+(+i+1)+".0.0"):(ue("no pr"),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+" <"+(+i+1)+".0.0"),ue("caret return",u),u})}function x1(e,t){return ue("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return A1(r,t)}).join(" ")}function A1(e,t){e=e.trim();var r=t.loose?me[JT]:me[YT];return e.replace(r,function(n,i,s,a,o,u){ue("xRange",e,n,i,s,a,o,u);var c=_t(s),l=c||_t(a),f=l||_t(o),p=f;return i==="="&&p&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&p?(l&&(a=0),o=0,i===">"?(i=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):i==="<="&&(i="<",l?s=+s+1:a=+a+1),n=i+s+"."+a+"."+o):l?n=">="+s+".0.0 <"+(+s+1)+".0.0":f&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),ue("xRange return",n),n})}function R1(e,t){return ue("replaceStars",e,t),e.trim().replace(me[aI],"")}function P1(e,t,r,n,i,s,a,o,u,c,l,f,p){return _t(r)?t="":_t(n)?t=">="+r+".0.0":_t(i)?t=">="+r+"."+n+".0":t=">="+t,_t(u)?o="":_t(c)?o="<"+(+u+1)+".0.0":_t(l)?o="<"+u+"."+(+c+1)+".0":f?o="<="+u+"."+c+"."+l+"-"+f:o="<="+o,(t+" "+o).trim()}xe.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new W(e,this.options));for(var t=0;t<this.set.length;t++)if(D1(this.set[t],e,this.options))return!0;return!1};function D1(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(ue(e[n].semver),e[n].semver!==po&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}L.satisfies=Oc;function Oc(e,t,r){try{t=new xe(t,r)}catch{return!1}return t.test(e)}L.maxSatisfying=k1;function k1(e,t,r){var n=null,i=null;try{var s=new xe(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new W(n,r))}),n}L.minSatisfying=O1;function O1(e,t,r){var n=null,i=null;try{var s=new xe(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new W(n,r))}),n}L.minVersion=N1;function N1(e,t){e=new xe(e,t);var r=new W("0.0.0");if(e.test(r)||(r=new W("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(s){var a=new W(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||lo(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&e.test(r)?r:null}L.validRange=q1;function q1(e,t){try{return new xe(e,t).range||"*"}catch{return null}}L.ltr=L1;function L1(e,t,r){return hh(e,t,"<",r)}L.gtr=M1;function M1(e,t,r){return hh(e,t,">",r)}L.outside=hh;function hh(e,t,r,n){e=new W(e,n),t=new xe(t,n);var i,s,a,o,u;switch(r){case">":i=lo,s=dh,a=Dc,o=">",u=">=";break;case"<":i=Dc,s=ph,a=lo,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Oc(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],f=null,p=null;if(l.forEach(function(h){h.semver===po&&(h=new Gt(">=0.0.0")),f=f||h,p=p||h,i(h.semver,f.semver,n)?f=h:a(h.semver,p.semver,n)&&(p=h)}),f.operator===o||f.operator===u||(!p.operator||p.operator===o)&&s(e,p.semver))return!1;if(p.operator===u&&a(e,p.semver))return!1}return!0}L.prerelease=H1;function H1(e,t){var r=ui(e,t);return r&&r.prerelease.length?r.prerelease:null}L.intersects=F1;function F1(e,t,r){return e=new xe(e,r),t=new xe(t,r),e.intersects(t)}L.coerce=j1;function j1(e){if(e instanceof W)return e;if(typeof e!="string")return null;var t=e.match(me[ZT]);return t==null?null:ui(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var Mc=d((cV,pI)=>{"use strict";function vh(e){return typeof e=="function"}var Et=console.error.bind(console);function ho(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function vo(e){e&&e.logger&&(vh(e.logger)?Et=e.logger:Et("new logger isn't a function, not replacing"))}function lI(e,t,r){if(!e||!e[t]){Et("no original function "+t+" to wrap");return}if(!r){Et("no wrapper function"),Et(new Error().stack);return}if(!vh(e[t])||!vh(r)){Et("original object and wrapper must be functions");return}var n=e[t],i=r(n,t);return ho(i,"__original",n),ho(i,"__unwrap",function(){e[t]===i&&ho(e,t,n)}),ho(i,"__wrapped",!0),ho(e,t,i),i}function U1(e,t,r){if(e)Array.isArray(e)||(e=[e]);else{Et("must provide one or more modules to patch"),Et(new Error().stack);return}if(!(t&&Array.isArray(t))){Et("must provide one or more functions to wrap on modules");return}e.forEach(function(n){t.forEach(function(i){lI(n,i,r)})})}function fI(e,t){if(!e||!e[t]){Et("no function to unwrap."),Et(new Error().stack);return}if(!e[t].__unwrap)Et("no original to unwrap to -- has "+t+" already been unwrapped?");else return e[t].__unwrap()}function $1(e,t){if(e)Array.isArray(e)||(e=[e]);else{Et("must provide one or more modules to patch"),Et(new Error().stack);return}if(!(t&&Array.isArray(t))){Et("must provide one or more functions to unwrap on modules");return}e.forEach(function(r){t.forEach(function(n){fI(r,n)})})}vo.wrap=lI;vo.massWrap=U1;vo.unwrap=fI;vo.massUnwrap=$1;pI.exports=vo});var jc=d((lV,gI)=>{"use strict";var hI=Mc(),Ts=hI.wrap,Hc=hI.unwrap,Qr="wrap@before";function Fc(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function V1(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n],s=e[Qr];if(typeof s=="function")s(i);else if(Array.isArray(s))for(var a=s.length,o=0;o<a;o++)s[o](i)}}function vI(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r?r=[r]:r=[]),r}function B1(e,t,r){var n=vI(e,t),i=n.filter(function(s){return r.indexOf(s)===-1});i.length>0&&V1(e,i)}function dI(e,t){if(!!e){var r=e;if(typeof e=="function")r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}gI.exports=function(t,r,n){if(!t||!t.on||!t.addListener||!t.removeListener||!t.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function i(a){return function(u,c){var l=vI(this,u).slice();try{var f=a.call(this,u,c);return B1(this,u,l),f}finally{this.on.__wrapped||Ts(this,"on",i),this.addListener.__wrapped||Ts(this,"addListener",i)}}}function s(a){return function(u){if(!this._events||!this._events[u])return a.apply(this,arguments);var c=this._events[u];function l(f){return function(){this._events[u]=c;try{return f.apply(this,arguments)}finally{c=this._events[u],this._events[u]=dI(c,n)}}}Ts(this,"removeListener",l);try{return this._events[u]=dI(c,n),a.apply(this,arguments)}finally{Hc(this,"removeListener"),this._events[u]=c}}}t[Qr]?typeof t[Qr]=="function"?Fc(t,Qr,[t[Qr],r]):Array.isArray(t[Qr])&&t[Qr].push(r):Fc(t,Qr,r),t.__wrapped||(Ts(t,"addListener",i),Ts(t,"on",i),Ts(t,"emit",s),Fc(t,"__unwrap",function(){Hc(t,"addListener"),Hc(t,"on"),Hc(t,"emit"),delete t[Qr],delete t.__wrapped}),Fc(t,"__wrapped",!0))}});var EI=d((fV,_I)=>{"use strict";var ie=require("util"),Xr=require("assert"),G1=jc(),Ee=require("async_hooks"),go="cls@contexts",mo="error@context",Ae=process.env.DEBUG_CLS_HOOKED,ne=-1;_I.exports={getNamespace:mI,createNamespace:z1,destroyNamespace:yI,reset:Q1,ERROR_SYMBOL:mo};function zt(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}zt.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[t]=r,Ae){let n=" ".repeat(this._indent<0?0:this._indent);Te(n+"CONTEXT-SET KEY:"+t+"="+r+" in ns:"+this.name+" currentUid:"+ne+" active:"+ie.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};zt.prototype.get=function(t){if(!this.active){if(Ae){let r=Ee.currentId(),n=Ee.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Te(`${i}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${t}=undefined currentUid:${ne} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(Ae){let r=Ee.executionAsyncId(),n=Ee.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Te(i+"CONTEXT-GETTING KEY:"+t+"="+this.active[t]+" ("+this.name+") currentUid:"+ne+" active:"+ie.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),Te(`${i}CONTEXT-GETTING KEY: (${this.name}) ${t}=${this.active[t]} currentUid:${ne} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${ie.inspect(this.active)}`)}return this.active[t]};zt.prototype.createContext=function(){let t=Object.create(this.active?this.active:Object.prototype);if(t._ns_name=this.name,t.id=ne,Ae){let r=Ee.executionAsyncId(),n=Ee.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Te(`${i}CONTEXT-CREATED Context: (${this.name}) currentUid:${ne} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${ie.inspect(t,{showHidden:!0,depth:2,colors:!0})}`)}return t};zt.prototype.run=function(t){let r=this.createContext();this.enter(r);try{if(Ae){let n=Ee.triggerAsyncId(),i=Ee.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Te(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${ne} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} context:${ie.inspect(r)}`)}return t(r),r}catch(n){throw n&&(n[mo]=r),n}finally{if(Ae){let n=Ee.triggerAsyncId(),i=Ee.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Te(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${ne} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} ${ie.inspect(r)}`)}this.exit(r)}};zt.prototype.runAndReturn=function(t){let r;return this.run(function(n){r=t(n)}),r};zt.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return Ae&&Te("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+ne+" len:"+this._set.length+" "+ie.inspect(r)),n.then(i=>(Ae&&Te("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+ne+" len:"+this._set.length+" "+ie.inspect(r)),this.exit(r),i)).catch(i=>{throw i[mo]=r,Ae&&Te("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+ne+" len:"+this._set.length+" "+ie.inspect(r)),this.exit(r),i})};zt.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[mo]=r),s}finally{n.exit(r)}}};zt.prototype.enter=function(t){if(Xr.ok(t,"context must be provided for entering"),Ae){let r=Ee.executionAsyncId(),n=Ee.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);Te(`${i}CONTEXT-ENTER: (${this.name}) currentUid:${ne} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${ie.inspect(t)}`)}this._set.push(this.active),this.active=t};zt.prototype.exit=function(t){if(Xr.ok(t,"context must be provided for exiting"),Ae){let n=Ee.executionAsyncId(),i=Ee.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Te(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${ne} triggerId:${i} asyncHooksCurrentId:${n} len:${this._set.length} ${ie.inspect(t)}`)}if(this.active===t){Xr.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(Ae&&Te("??ERROR?? context exiting but not entered - ignoring: "+ie.inspect(t)),Xr.ok(r>=0,`context not currently entered; can't exit. 
`+ie.inspect(this)+`
`+ie.inspect(t))):(Xr.ok(r,"can't remove top context"),this._set.splice(r,1))};zt.prototype.bindEmitter=function(t){Xr.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[go]||(a[go]=Object.create(null)),a[go][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[go]))return a;let o=a,u=a[go];return Object.keys(u).forEach(function(c){let l=u[c];o=l.namespace.bind(o,l.context)}),o}G1(t,i,s)};zt.prototype.fromException=function(t){return t[mo]};function mI(e){return process.namespaces[e]}function z1(e){Xr.ok(e,"namespace must be given a name."),Ae&&Te(`NS-CREATING NAMESPACE (${e})`);let t=new zt(e);return t.id=ne,Ee.createHook({init(n,i,s,a){if(ne=Ee.executionAsyncId(),t.active){if(t._contexts.set(n,t.active),Ae){let o=" ".repeat(t._indent<0?0:t._indent);Te(`${o}INIT [${i}] (${e}) asyncId:${n} currentUid:${ne} triggerId:${s} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(ne===0){let o=Ee.triggerAsyncId(),u=t._contexts.get(o);if(u){if(t._contexts.set(n,u),Ae){let c=" ".repeat(t._indent<0?0:t._indent);Te(`${c}INIT USING CONTEXT FROM TRIGGERID [${i}] (${e}) asyncId:${n} currentUid:${ne} triggerId:${o} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(Ae){let c=" ".repeat(t._indent<0?0:t._indent);Te(`${c}INIT MISSING CONTEXT [${i}] (${e}) asyncId:${n} currentUid:${ne} triggerId:${o} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(Ae&&i==="PROMISE"){Te(ie.inspect(a,{showHidden:!0}));let o=a.parentId,u=" ".repeat(t._indent<0?0:t._indent);Te(`${u}INIT RESOURCE-PROMISE [${i}] (${e}) parentId:${o} asyncId:${n} currentUid:${ne} triggerId:${s} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){ne=Ee.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(ne),i){if(Ae){let s=Ee.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);Te(`${a}BEFORE (${e}) asyncId:${n} currentUid:${ne} triggerId:${s} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${ie.inspect(i)}`),t._indent+=2}t.enter(i)}else if(Ae){let s=Ee.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);Te(`${a}BEFORE MISSING CONTEXT (${e}) asyncId:${n} currentUid:${ne} triggerId:${s} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${ie.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(n){ne=Ee.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(ne),i){if(Ae){let s=Ee.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);Te(`${a}AFTER (${e}) asyncId:${n} currentUid:${ne} triggerId:${s} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${ie.inspect(i)}`)}t.exit(i)}else if(Ae){let s=Ee.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);Te(`${a}AFTER MISSING CONTEXT (${e}) asyncId:${n} currentUid:${ne} triggerId:${s} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${ie.inspect(i)}`)}},destroy(n){if(ne=Ee.executionAsyncId(),Ae){let i=Ee.triggerAsyncId(),s=" ".repeat(t._indent<0?0:t._indent);Te(`${s}DESTROY (${e}) currentUid:${ne} asyncId:${n} triggerId:${i} active:${ie.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${ie.inspect(t._contexts.get(ne))}`)}t._contexts.delete(n)}}).enable(),process.namespaces[e]=t,t}function yI(e){let t=mI(e);Xr.ok(t,`can't delete nonexistent namespace! "`+e+'"'),Xr.ok(t.id,"don't assign to process.namespaces directly! "+ie.inspect(t)),process.namespaces[e]=null}function Q1(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){yI(e)}),process.namespaces=Object.create(null)}process.namespaces={};function Te(...e){Ae&&process._rawDebug(`${ie.format(...e)}`)}});var TI=d((pV,CI)=>{"use strict";function X1(){}CI.exports=function(){let t=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let u=0;u<arguments.length;u++)i[u]=arguments[u];let s=i[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new X1,o=--r.counter;return t.init.call(a,o,0,null,null),i[0]=function(){t.pre.call(a,o);let u=!0;try{s.apply(this,arguments),u=!1}finally{u&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(a,o,!0),t.destroy.call(null,o)})}t.post.call(a,o,!1),t.destroy.call(null,o)},n.apply(process,i)}}});var bI=d((dV,II)=>{"use strict";function W1(){}II.exports=function(){let t=this._hooks,r=this._state,n=global.Promise,i=n.prototype.then;n.prototype.then=u;function s(c,l,f,p){return typeof c!="function"?p?a(f):o(f):function(){t.pre.call(l,f);try{return c.apply(this,arguments)}finally{t.post.call(l,f,!1),t.destroy.call(null,f)}}}function a(c){return function(f){return t.destroy.call(null,c),f}}function o(c){return function(f){throw t.destroy.call(null,c),f}}function u(c,l){if(!r.enabled)return i.call(this,c,l);let f=new W1,p=--r.counter;return t.init.call(f,p,0,null,null),i.call(this,s(c,f,p,!0),s(l,f,p,!1))}}});var SI=d((hV,wI)=>{"use strict";var Lt=require("timers");function K1(){}function Y1(){}function J1(){}var Z1=new Map,eL=new Map,tL=new Map,gh=null,mh=!1;wI.exports=function(){yh(this._hooks,this._state,"setTimeout","clearTimeout",K1,Z1,!0),yh(this._hooks,this._state,"setInterval","clearInterval",Y1,eL,!1),yh(this._hooks,this._state,"setImmediate","clearImmediate",J1,tL,!0),global.setTimeout=Lt.setTimeout,global.setInterval=Lt.setInterval,global.setImmediate=Lt.setImmediate,global.clearTimeout=Lt.clearTimeout,global.clearInterval=Lt.clearInterval,global.clearImmediate=Lt.clearImmediate};function yh(e,t,r,n,i,s,a){let o=Lt[r],u=Lt[n];Lt[r]=function(){if(!t.enabled)return o.apply(Lt,arguments);let c=new Array(arguments.length);for(let v=0;v<arguments.length;v++)c[v]=arguments[v];let l=c[0];if(typeof l!="function")throw new TypeError('"callback" argument must be a function');let f=new i,p=--t.counter,h;return e.init.call(f,p,0,null,null),c[0]=function(){gh=h,e.pre.call(f,p);let v=!0;try{l.apply(this,arguments),v=!1}finally{v&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(f,p,!0),s.delete(h),e.destroy.call(null,p)})}e.post.call(f,p,!1),gh=null,(a||mh)&&(mh=!1,s.delete(h),e.destroy.call(null,p))},h=o.apply(Lt,c),s.set(h,p),h},Lt[n]=function(c){if(gh===c&&c!==null)mh=!0;else if(s.has(c)){let l=s.get(c);s.delete(c),e.destroy.call(null,l)}u.apply(Lt,arguments)}}});var _h=d((vV,rL)=>{rL.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}});var RI=d((gV,AI)=>{"use strict";var _o=process.binding("async_wrap"),nL=_o.Providers.TIMERWRAP,xI={nextTick:TI(),promise:bI(),timers:SI()},yo=new Set;function iL(){this.enabled=!1,this.counter=0}function Eh(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(i,s,a,o){if(s===nL){yo.add(i);return}for(let u of e)u(i,this,s,a,o)},this.pre=function(i){if(!yo.has(i))for(let s of t)s(i,this)},this.post=function(i,s){if(!yo.has(i))for(let a of r)a(i,this,s)},this.destroy=function(i){if(yo.has(i)){yo.delete(i);return}for(let s of n)s(i)}}Eh.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)};function Uc(e,t){let r=e.indexOf(t);r!==-1&&e.splice(r,1)}Eh.prototype.remove=function(e){e.init&&Uc(this.initFns,e.init),e.pre&&Uc(this.preFns,e.pre),e.post&&Uc(this.postFns,e.post),e.destroy&&Uc(this.destroyFns,e.destroy)};function Eo(){this._state=new iL,this._hooks=new Eh,this.version=_h().version,this.providers=_o.Providers;for(let e of Object.keys(xI))xI[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),_o.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}AI.exports=Eo;Eo.prototype.addHooks=function(e){this._hooks.add(e)};Eo.prototype.removeHooks=function(e){this._hooks.remove(e)};Eo.prototype.enable=function(){this._state.enabled=!0,_o.enable()};Eo.prototype.disable=function(){this._state.enabled=!1,_o.disable()}});var Ch=d((mV,sL)=>{sL.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}});var DI=d((yV,PI)=>{function aL(e){try{return Error.prototype.toString.call(e)}catch(t){try{return"<error: "+t+">"}catch{return"<error>"}}}PI.exports=function(t,r){var n=[];n.push(aL(t));for(var i=0;i<r.length;i++){var s=r[i],a;try{a=s.toString()}catch(o){try{a="<error: "+o+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var qI=d((_V,NI)=>{var $c=DI();function OI(){this.extend=new Co,this.filter=new Co,this.format=new To,this.version=Ch().version}var Ih=!1;OI.prototype.callSite=function e(t){t||(t={}),Ih=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return Ih=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var hn=new OI;function Co(){this._modifiers=[]}Co.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t};Co.prototype.attach=function(e){this._modifiers.push(e)};Co.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return t===-1?!1:(this._modifiers.splice(t,1),!0)};function To(){this._formater=$c,this._previous=void 0}To.prototype.replace=function(e){e?this._formater=e:this.restore()};To.prototype.restore=function(){this._formater=$c,this._previous=void 0};To.prototype._backup=function(){this._previous=this._formater};To.prototype._roolback=function(){this._previous===$c?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&hn.format.replace(Error.prepareStackTrace);var Th=!1;function kI(e,t){if(Ih)return t;if(Th)return $c(e,t);var r=t.concat();r=hn.extend._modify(e,r),r=hn.filter._modify(e,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&Object.getOwnPropertyDescriptor(e,"callSite")===void 0&&(e.callSite={original:t,mutated:r}),Th=!0;var n=hn.format._formater(e,r);return Th=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return kI},set:function(e){e===kI?hn.format._roolback():(hn.format._backup(),hn.format.replace(e))}});function oL(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:oL,set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0});NI.exports=hn});var wh=d((EV,bh)=>{if(global._stackChain)if(global._stackChain.version===Ch().version)bh.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else bh.exports=global._stackChain=qI()});var LI=d((CV,Sh)=>{"use strict";var uL=RI();if(global._asyncHook)if(global._asyncHook.version===_h().version)Sh.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else wh().filter.attach(function(t,r){return r.filter(function(n){let i=n.getFileName();return!(i&&i.slice(0,__dirname.length)===__dirname)})}),Sh.exports=global._asyncHook=new uL});var $I=d((TV,UI)=>{"use strict";var He=require("util"),Wr=require("assert"),cL=jc(),Is=LI(),Io="cls@contexts",bo="error@context",HI=[];for(let e in Is.providers)HI[Is.providers[e]]=e;var ke=process.env.DEBUG_CLS_HOOKED,Be=-1;UI.exports={getNamespace:FI,createNamespace:lL,destroyNamespace:jI,reset:fL,ERROR_SYMBOL:bo};function Qt(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}Qt.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return ke&&Me("    SETTING KEY:"+t+"="+r+" in ns:"+this.name+" uid:"+Be+" active:"+He.inspect(this.active,!0)),this.active[t]=r,r};Qt.prototype.get=function(t){if(!this.active){ke&&Me("    GETTING KEY:"+t+"=undefined "+this.name+" uid:"+Be+" active:"+He.inspect(this.active,!0));return}return ke&&Me("    GETTING KEY:"+t+"="+this.active[t]+" "+this.name+" uid:"+Be+" active:"+He.inspect(this.active,!0)),this.active[t]};Qt.prototype.createContext=function(){ke&&Me("   CREATING Context: "+this.name+" uid:"+Be+" len:"+this._set.length+"  active:"+He.inspect(this.active,!0,2,!0));let t=Object.create(this.active?this.active:Object.prototype);return t._ns_name=this.name,t.id=Be,ke&&Me("   CREATED Context: "+this.name+" uid:"+Be+" len:"+this._set.length+"  context:"+He.inspect(t,!0,2,!0)),t};Qt.prototype.run=function(t){let r=this.createContext();this.enter(r);try{return ke&&Me(" BEFORE RUN: "+this.name+" uid:"+Be+" len:"+this._set.length+" "+He.inspect(r)),t(r),r}catch(n){throw n&&(n[bo]=r),n}finally{ke&&Me(" AFTER RUN: "+this.name+" uid:"+Be+" len:"+this._set.length+" "+He.inspect(r)),this.exit(r)}};Qt.prototype.runAndReturn=function(t){var r;return this.run(function(n){r=t(n)}),r};Qt.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return ke&&Me(" BEFORE runPromise: "+this.name+" uid:"+Be+" len:"+this._set.length+" "+He.inspect(r)),n.then(i=>(ke&&Me(" AFTER runPromise: "+this.name+" uid:"+Be+" len:"+this._set.length+" "+He.inspect(r)),this.exit(r),i)).catch(i=>{throw i[bo]=r,ke&&Me(" AFTER runPromise: "+this.name+" uid:"+Be+" len:"+this._set.length+" "+He.inspect(r)),this.exit(r),i})};Qt.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[bo]=r),s}finally{n.exit(r)}}};Qt.prototype.enter=function(t){Wr.ok(t,"context must be provided for entering"),ke&&Me("  ENTER "+this.name+" uid:"+Be+" len:"+this._set.length+" context: "+He.inspect(t)),this._set.push(this.active),this.active=t};Qt.prototype.exit=function(t){if(Wr.ok(t,"context must be provided for exiting"),ke&&Me("  EXIT "+this.name+" uid:"+Be+" len:"+this._set.length+" context: "+He.inspect(t)),this.active===t){Wr.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(ke&&Me("??ERROR?? context exiting but not entered - ignoring: "+He.inspect(t)),Wr.ok(r>=0,`context not currently entered; can't exit. 
`+He.inspect(this)+`
`+He.inspect(t))):(Wr.ok(r,"can't remove top context"),this._set.splice(r,1))};Qt.prototype.bindEmitter=function(t){Wr.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[Io]||(a[Io]=Object.create(null)),a[Io][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[Io]))return a;let o=a,u=a[Io];return Object.keys(u).forEach(function(c){let l=u[c];o=l.namespace.bind(o,l.context)}),o}cL(t,i,s)};Qt.prototype.fromException=function(t){return t[bo]};function FI(e){return process.namespaces[e]}function lL(e){Wr.ok(e,"namespace must be given a name."),ke&&Me("CREATING NAMESPACE "+e);let t=new Qt(e);return t.id=Be,Is.addHooks({init(r,n,i,s,a){Be=r,s?(t._contexts.set(r,t._contexts.get(s)),ke&&Me("PARENTID: "+e+" uid:"+r+" parent:"+s+" provider:"+i)):t._contexts.set(Be,t.active),ke&&Me("INIT "+e+" uid:"+r+" parent:"+s+" provider:"+HI[i]+" active:"+He.inspect(t.active,!0))},pre(r,n){Be=r;let i=t._contexts.get(r);i?(ke&&Me(" PRE "+e+" uid:"+r+" handle:"+Vc(n)+" context:"+He.inspect(i)),t.enter(i)):ke&&Me(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+Vc(n))},post(r,n){Be=r;let i=t._contexts.get(r);i?(ke&&Me(" POST "+e+" uid:"+r+" handle:"+Vc(n)+" context:"+He.inspect(i)),t.exit(i)):ke&&Me(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+Vc(n))},destroy(r){Be=r,ke&&Me("DESTROY "+e+" uid:"+r+" context:"+He.inspect(t._contexts.get(Be))+" active:"+He.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t}function jI(e){let t=FI(e);Wr.ok(t,`can't delete nonexistent namespace! "`+e+'"'),Wr.ok(t.id,"don't assign to process.namespaces directly! "+He.inspect(t)),process.namespaces[e]=null}function fL(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){jI(e)}),process.namespaces=Object.create(null)}process.namespaces={};Is._state&&!Is._state.enabled&&Is.enable();function Me(e){process.env.DEBUG&&process._rawDebug(e)}function Vc(e){if(!e)return e;if(typeof e=="function")return e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(e.constructor&&e.constructor.name)return e.constructor.name}if(ke){xh=wh();for(MI in xh.filter._modifiers)xh.filter.deattach(MI)}var xh,MI});var VI=d((IV,Ah)=>{"use strict";var pL=cI();process&&pL.gte(process.versions.node,"8.0.0")?Ah.exports=EI():Ah.exports=$I()});var ab=d((M,sb)=>{M=sb.exports=K;var ce;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?ce=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:ce=function(){};M.SEMVER_SPEC_VERSION="2.0.0";var wo=256,Bc=Number.MAX_SAFE_INTEGER||9007199254740991,Rh=16,dL=wo-6,So=M.re=[],ye=M.safeRe=[],C=M.src=[],G=0,Nh="[a-zA-Z0-9-]",Ph=[["\\s",1],["\\d",wo],[Nh,dL]];function Kc(e){for(var t=0;t<Ph.length;t++){var r=Ph[t][0],n=Ph[t][1];e=e.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return e}var bs=G++;C[bs]="0|[1-9]\\d*";var ws=G++;C[ws]="\\d+";var qh=G++;C[qh]="\\d*[a-zA-Z-]"+Nh+"*";var GI=G++;C[GI]="("+C[bs]+")\\.("+C[bs]+")\\.("+C[bs]+")";var zI=G++;C[zI]="("+C[ws]+")\\.("+C[ws]+")\\.("+C[ws]+")";var Dh=G++;C[Dh]="(?:"+C[bs]+"|"+C[qh]+")";var kh=G++;C[kh]="(?:"+C[ws]+"|"+C[qh]+")";var Lh=G++;C[Lh]="(?:-("+C[Dh]+"(?:\\."+C[Dh]+")*))";var Mh=G++;C[Mh]="(?:-?("+C[kh]+"(?:\\."+C[kh]+")*))";var Oh=G++;C[Oh]=Nh+"+";var Ao=G++;C[Ao]="(?:\\+("+C[Oh]+"(?:\\."+C[Oh]+")*))";var Hh=G++,QI="v?"+C[GI]+C[Lh]+"?"+C[Ao]+"?";C[Hh]="^"+QI+"$";var Fh="[v=\\s]*"+C[zI]+C[Mh]+"?"+C[Ao]+"?",jh=G++;C[jh]="^"+Fh+"$";var Ps=G++;C[Ps]="((?:<|>)?=?)";var Gc=G++;C[Gc]=C[ws]+"|x|X|\\*";var zc=G++;C[zc]=C[bs]+"|x|X|\\*";var ci=G++;C[ci]="[v=\\s]*("+C[zc]+")(?:\\.("+C[zc]+")(?:\\.("+C[zc]+")(?:"+C[Lh]+")?"+C[Ao]+"?)?)?";var xs=G++;C[xs]="[v=\\s]*("+C[Gc]+")(?:\\.("+C[Gc]+")(?:\\.("+C[Gc]+")(?:"+C[Mh]+")?"+C[Ao]+"?)?)?";var XI=G++;C[XI]="^"+C[Ps]+"\\s*"+C[ci]+"$";var WI=G++;C[WI]="^"+C[Ps]+"\\s*"+C[xs]+"$";var KI=G++;C[KI]="(?:^|[^\\d])(\\d{1,"+Rh+"})(?:\\.(\\d{1,"+Rh+"}))?(?:\\.(\\d{1,"+Rh+"}))?(?:$|[^\\d])";var Yc=G++;C[Yc]="(?:~>?)";var As=G++;C[As]="(\\s*)"+C[Yc]+"\\s+";So[As]=new RegExp(C[As],"g");ye[As]=new RegExp(Kc(C[As]),"g");var hL="$1~",YI=G++;C[YI]="^"+C[Yc]+C[ci]+"$";var JI=G++;C[JI]="^"+C[Yc]+C[xs]+"$";var Jc=G++;C[Jc]="(?:\\^)";var Rs=G++;C[Rs]="(\\s*)"+C[Jc]+"\\s+";So[Rs]=new RegExp(C[Rs],"g");ye[Rs]=new RegExp(Kc(C[Rs]),"g");var vL="$1^",ZI=G++;C[ZI]="^"+C[Jc]+C[ci]+"$";var eb=G++;C[eb]="^"+C[Jc]+C[xs]+"$";var Uh=G++;C[Uh]="^"+C[Ps]+"\\s*("+Fh+")$|^$";var $h=G++;C[$h]="^"+C[Ps]+"\\s*("+QI+")$|^$";var li=G++;C[li]="(\\s*)"+C[Ps]+"\\s*("+Fh+"|"+C[ci]+")";So[li]=new RegExp(C[li],"g");ye[li]=new RegExp(Kc(C[li]),"g");var gL="$1$2$3",tb=G++;C[tb]="^\\s*("+C[ci]+")\\s+-\\s+("+C[ci]+")\\s*$";var rb=G++;C[rb]="^\\s*("+C[xs]+")\\s+-\\s+("+C[xs]+")\\s*$";var nb=G++;C[nb]="(<|>)?=?\\s*\\*";for(Ir=0;Ir<G;Ir++)ce(Ir,C[Ir]),So[Ir]||(So[Ir]=new RegExp(C[Ir]),ye[Ir]=new RegExp(Kc(C[Ir])));var Ir;M.parse=fi;function fi(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof K)return e;if(typeof e!="string"||e.length>wo)return null;var r=t.loose?ye[jh]:ye[Hh];if(!r.test(e))return null;try{return new K(e,t)}catch{return null}}M.valid=mL;function mL(e,t){var r=fi(e,t);return r?r.version:null}M.clean=yL;function yL(e,t){var r=fi(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}M.SemVer=K;function K(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof K){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>wo)throw new TypeError("version is longer than "+wo+" characters");if(!(this instanceof K))return new K(e,t);ce("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?ye[jh]:ye[Hh]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Bc||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Bc||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Bc||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<Bc)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}K.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};K.prototype.toString=function(){return this.version};K.prototype.compare=function(e){return ce("SemVer.compare",this.version,this.options,e),e instanceof K||(e=new K(e,this.options)),this.compareMain(e)||this.comparePre(e)};K.prototype.compareMain=function(e){return e instanceof K||(e=new K(e,this.options)),Ss(this.major,e.major)||Ss(this.minor,e.minor)||Ss(this.patch,e.patch)};K.prototype.comparePre=function(e){if(e instanceof K||(e=new K(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(ce("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Ss(r,n)}while(++t)};K.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};M.inc=_L;function _L(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new K(e,r).inc(t,n).version}catch{return null}}M.diff=EL;function EL(e,t){if(Vh(e,t))return null;var r=fi(e),n=fi(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return i+a;return s}M.compareIdentifiers=Ss;var BI=/^[0-9]+$/;function Ss(e,t){var r=BI.test(e),n=BI.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}M.rcompareIdentifiers=CL;function CL(e,t){return Ss(t,e)}M.major=TL;function TL(e,t){return new K(e,t).major}M.minor=IL;function IL(e,t){return new K(e,t).minor}M.patch=bL;function bL(e,t){return new K(e,t).patch}M.compare=Kr;function Kr(e,t,r){return new K(e,r).compare(new K(t,r))}M.compareLoose=wL;function wL(e,t){return Kr(e,t,!0)}M.rcompare=SL;function SL(e,t,r){return Kr(t,e,r)}M.sort=xL;function xL(e,t){return e.sort(function(r,n){return M.compare(r,n,t)})}M.rsort=AL;function AL(e,t){return e.sort(function(r,n){return M.rcompare(r,n,t)})}M.gt=xo;function xo(e,t,r){return Kr(e,t,r)>0}M.lt=Qc;function Qc(e,t,r){return Kr(e,t,r)<0}M.eq=Vh;function Vh(e,t,r){return Kr(e,t,r)===0}M.neq=ib;function ib(e,t,r){return Kr(e,t,r)!==0}M.gte=Bh;function Bh(e,t,r){return Kr(e,t,r)>=0}M.lte=Gh;function Gh(e,t,r){return Kr(e,t,r)<=0}M.cmp=Xc;function Xc(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Vh(e,r,n);case"!=":return ib(e,r,n);case">":return xo(e,r,n);case">=":return Bh(e,r,n);case"<":return Qc(e,r,n);case"<=":return Gh(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}M.Comparator=Xt;function Xt(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Xt){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof Xt))return new Xt(e,t);e=e.trim().split(/\s+/).join(" "),ce("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Ro?this.value="":this.value=this.operator+this.semver.version,ce("comp",this)}var Ro={};Xt.prototype.parse=function(e){var t=this.options.loose?ye[Uh]:ye[$h],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new K(r[2],this.options.loose):this.semver=Ro};Xt.prototype.toString=function(){return this.value};Xt.prototype.test=function(e){return ce("Comparator.test",e,this.options.loose),this.semver===Ro?!0:(typeof e=="string"&&(e=new K(e,this.options)),Xc(e,this.operator,this.semver,this.options))};Xt.prototype.intersects=function(e,t){if(!(e instanceof Xt))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new Re(e.value,t),Wc(this.value,r,t);if(e.operator==="")return r=new Re(this.value,t),Wc(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,a=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=Xc(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),u=Xc(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||s&&a||o||u};M.Range=Re;function Re(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Re)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Re(e.raw,t);if(e instanceof Xt)return new Re(e.value,t);if(!(this instanceof Re))return new Re(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Re.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};Re.prototype.toString=function(){return this.range};Re.prototype.parseRange=function(e){var t=this.options.loose,r=t?ye[rb]:ye[tb];e=e.replace(r,HL),ce("hyphen replace",e),e=e.replace(ye[li],gL),ce("comparator trim",e,ye[li]),e=e.replace(ye[As],hL),e=e.replace(ye[Rs],vL);var n=t?ye[Uh]:ye[$h],i=e.split(" ").map(function(s){return PL(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new Xt(s,this.options)},this),i};Re.prototype.intersects=function(e,t){if(!(e instanceof Re))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(s){return n.intersects(s,t)})})})})};M.toComparators=RL;function RL(e,t){return new Re(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function PL(e,t){return ce("comp",e,t),e=OL(e,t),ce("caret",e),e=DL(e,t),ce("tildes",e),e=qL(e,t),ce("xrange",e),e=ML(e,t),ce("stars",e),e}function Ct(e){return!e||e.toLowerCase()==="x"||e==="*"}function DL(e,t){return e.trim().split(/\s+/).map(function(r){return kL(r,t)}).join(" ")}function kL(e,t){var r=t.loose?ye[JI]:ye[YI];return e.replace(r,function(n,i,s,a,o){ce("tilde",e,n,i,s,a,o);var u;return Ct(i)?u="":Ct(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":Ct(a)?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":o?(ce("replaceTilde pr",o),u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0"):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0",ce("tilde return",u),u})}function OL(e,t){return e.trim().split(/\s+/).map(function(r){return NL(r,t)}).join(" ")}function NL(e,t){ce("caret",e,t);var r=t.loose?ye[eb]:ye[ZI];return e.replace(r,function(n,i,s,a,o){ce("caret",e,n,i,s,a,o);var u;return Ct(i)?u="":Ct(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":Ct(a)?i==="0"?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+".0 <"+(+i+1)+".0.0":o?(ce("replaceCaret pr",o),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+"-"+o+" <"+(+i+1)+".0.0"):(ce("no pr"),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+" <"+(+i+1)+".0.0"),ce("caret return",u),u})}function qL(e,t){return ce("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return LL(r,t)}).join(" ")}function LL(e,t){e=e.trim();var r=t.loose?ye[WI]:ye[XI];return e.replace(r,function(n,i,s,a,o,u){ce("xRange",e,n,i,s,a,o,u);var c=Ct(s),l=c||Ct(a),f=l||Ct(o),p=f;return i==="="&&p&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&p?(l&&(a=0),o=0,i===">"?(i=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):i==="<="&&(i="<",l?s=+s+1:a=+a+1),n=i+s+"."+a+"."+o):l?n=">="+s+".0.0 <"+(+s+1)+".0.0":f&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),ce("xRange return",n),n})}function ML(e,t){return ce("replaceStars",e,t),e.trim().replace(ye[nb],"")}function HL(e,t,r,n,i,s,a,o,u,c,l,f,p){return Ct(r)?t="":Ct(n)?t=">="+r+".0.0":Ct(i)?t=">="+r+"."+n+".0":t=">="+t,Ct(u)?o="":Ct(c)?o="<"+(+u+1)+".0.0":Ct(l)?o="<"+u+"."+(+c+1)+".0":f?o="<="+u+"."+c+"."+l+"-"+f:o="<="+o,(t+" "+o).trim()}Re.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new K(e,this.options));for(var t=0;t<this.set.length;t++)if(FL(this.set[t],e,this.options))return!0;return!1};function FL(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(ce(e[n].semver),e[n].semver!==Ro&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}M.satisfies=Wc;function Wc(e,t,r){try{t=new Re(t,r)}catch{return!1}return t.test(e)}M.maxSatisfying=jL;function jL(e,t,r){var n=null,i=null;try{var s=new Re(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new K(n,r))}),n}M.minSatisfying=UL;function UL(e,t,r){var n=null,i=null;try{var s=new Re(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new K(n,r))}),n}M.minVersion=$L;function $L(e,t){e=new Re(e,t);var r=new K("0.0.0");if(e.test(r)||(r=new K("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(s){var a=new K(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||xo(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&e.test(r)?r:null}M.validRange=VL;function VL(e,t){try{return new Re(e,t).range||"*"}catch{return null}}M.ltr=BL;function BL(e,t,r){return zh(e,t,"<",r)}M.gtr=GL;function GL(e,t,r){return zh(e,t,">",r)}M.outside=zh;function zh(e,t,r,n){e=new K(e,n),t=new Re(t,n);var i,s,a,o,u;switch(r){case">":i=xo,s=Gh,a=Qc,o=">",u=">=";break;case"<":i=Qc,s=Bh,a=xo,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Wc(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],f=null,p=null;if(l.forEach(function(h){h.semver===Ro&&(h=new Xt(">=0.0.0")),f=f||h,p=p||h,i(h.semver,f.semver,n)?f=h:a(h.semver,p.semver,n)&&(p=h)}),f.operator===o||f.operator===u||(!p.operator||p.operator===o)&&s(e,p.semver))return!1;if(p.operator===u&&a(e,p.semver))return!1}return!0}M.prerelease=zL;function zL(e,t){var r=fi(e,t);return r&&r.prerelease.length?r.prerelease:null}M.intersects=QL;function QL(e,t,r){return e=new Re(e,r),t=new Re(t,r),e.intersects(t)}M.coerce=XL;function XL(e){if(e instanceof K)return e;if(typeof e!="string")return null;var t=e.match(ye[KI]);return t==null?null:fi(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var cb=d((bV,ub)=>{var WL=Mc().wrap,Xh=1<<0,Wh=1<<1,Kh=1<<2,el=1<<3,pe=[],KL=0,lt=!1,vn=[],Ds,Yh;function Jh(e,t){var r=e.length,n=t.length,i=[];if(r===0&&n===0)return i;for(var s=0;s<r;s++)i[s]=e[s];if(n===0)return i;for(var a=0;a<n;a++){var o=!0;for(s=0;s<r;s++)if(e[s].uid===t[a].uid){o=!1;break}o&&i.push(t[a])}return i}process._fatalException?(Zc=!1,Ds=function(t){var r=pe.length;if(Zc||r===0)return!1;var n=!1;Zc=!0;for(var i=0;i<r;++i){var s=pe[i];if((s.flags&el)!==0){var a=ks&&ks[s.uid];n=s.error(a,t)||n}}return Zc=!1,vn.length>0&&(pe=vn.pop()),ks=void 0,n&&!lt},Yh=function(t,r,n){var i=[];lt=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Xh)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return lt=!1,function(){ks=i,vn.push(pe),pe=Jh(r,pe),lt=!0;for(var u=0;u<n;++u)(r[u].flags&Wh)>0&&r[u].before(this,i[r[u].uid]);lt=!1;var c=t.apply(this,arguments);for(lt=!0,u=0;u<n;++u)(r[u].flags&Kh)>0&&r[u].after(this,i[r[u].uid]);return lt=!1,pe=vn.pop(),ks=void 0,c}},WL(process,"_fatalException",function(e){return function(r){return Ds(r)||e(r)}})):(Qh=!1,Ds=function(t){if(Qh)throw t;for(var r=!1,n=pe.length,i=0;i<n;++i){var s=pe[i];(s.flags&el)!==0&&(r=s.error(null,t)||r)}if(!r&&lt)throw t},Yh=function(t,r,n){var i=[];lt=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Xh)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return lt=!1,function(){var u=!1,c=!1;vn.push(pe),pe=Jh(r,pe),lt=!0;for(var l=0;l<n;++l)(r[l].flags&Wh)>0&&r[l].before(this,i[r[l].uid]);lt=!1;var f;try{f=t.apply(this,arguments)}catch(p){u=!0;for(var l=0;l<n;++l)if((pe[l].flags&el)!=0)try{c=pe[l].error(i[r[l].uid],p)||c}catch(v){throw Qh=!0,v}if(!c)throw process.removeListener("uncaughtException",Ds),process._originalNextTick(function(){process.addListener("uncaughtException",Ds)}),p}finally{if(!u||c){for(lt=!0,l=0;l<n;++l)(r[l].flags&Kh)>0&&r[l].after(this,i[r[l].uid]);lt=!1}pe=vn.pop()}return f}},process.addListener("uncaughtException",Ds));var Zc,ks,Qh;function YL(e,t,r){lt=!0;for(var n=0;n<r;++n){var i=t[n];i.create&&i.create(i.data)}return lt=!1,function(){vn.push(pe),pe=Jh(t,pe);var s=e.apply(this,arguments);return pe=vn.pop(),s}}function JL(e){var t=pe.length;if(t===0)return e;for(var r=pe.slice(),n=0;n<t;++n)if(r[n].flags>0)return Yh(e,r,t);return YL(e,r,t)}function br(e,t){typeof e.create=="function"&&(this.create=e.create,this.flags|=Xh),typeof e.before=="function"&&(this.before=e.before,this.flags|=Wh),typeof e.after=="function"&&(this.after=e.after,this.flags|=Kh),typeof e.error=="function"&&(this.error=e.error,this.flags|=el),this.uid=++KL,this.data=t===void 0?null:t}br.prototype.create=void 0;br.prototype.before=void 0;br.prototype.after=void 0;br.prototype.error=void 0;br.prototype.data=void 0;br.prototype.uid=0;br.prototype.flags=0;function ob(e,t){if(typeof e!="object"||!e)throw new TypeError("callbacks argument must be an object");return e instanceof br?e:new br(e,t)}function ZL(e,t){var r;e instanceof br?r=e:r=ob(e,t);for(var n=!1,i=0;i<pe.length;i++)if(r===pe[i]){n=!0;break}return n||pe.push(r),r}function eM(e){for(var t=0;t<pe.length;t++)if(e===pe[t]){pe.splice(t,1);break}}process.createAsyncListener=ob;process.addAsyncListener=ZL;process.removeAsyncListener=eM;ub.exports=JL});var fb=d((SV,lb)=>{"use strict";lb.exports=(e,t)=>class extends e{constructor(n){var i,s;super(o);var a=this;try{n.apply(i,s)}catch(u){s[1](u)}return a;function o(u,c){i=this,s=[l,f];function l(p){return t(a,!1),u(p)}function f(p){return t(a,!1),c(p)}}}}});var yb=d(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var vb=Mc(),rl=ab(),Rt=vb.wrap,gn=vb.massWrap,Pe=cb(),tM=require("util"),rM=rl.gte(process.version,"6.0.0"),tv=rl.gte(process.version,"7.0.0"),nM=rl.gte(process.version,"8.0.0"),iM=rl.gte(process.version,"11.0.0"),wr=require("net");tv&&!wr._normalizeArgs?wr._normalizeArgs=function(e){if(e.length===0)return[{},null];var t=e[0],r={};typeof t=="object"&&t!==null?r=t:cM(t)?r.path=t:(r.port=t,e.length>1&&typeof e[1]=="string"&&(r.host=e[1]));var n=e[e.length-1];return typeof n!="function"?[r,null]:[r,n]}:!tv&&!wr._normalizeConnectArgs&&(wr._normalizeConnectArgs=function(e){var t={};function r(i){return(i=Number(i))>=0?i:!1}typeof e[0]=="object"&&e[0]!==null?t=e[0]:typeof e[0]=="string"&&r(e[0])===!1?t.path=e[0]:(t.port=e[0],typeof e[1]=="string"&&(t.host=e[1]));var n=e[e.length-1];return typeof n=="function"?[t,n]:[t]});"_setUpListenHandle"in wr.Server.prototype?Rt(wr.Server.prototype,"_setUpListenHandle",pb):Rt(wr.Server.prototype,"_listen2",pb);function pb(e){return function(){this.on("connection",function(t){t._handle&&(t._handle.onread=Pe(t._handle.onread))});try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=Pe(this._handle.onconnection))}}}function gb(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=Pe(t._originalOnread)}}Rt(wr.Socket.prototype,"connect",function(e){return function(){var t;nM&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?t=arguments[0]:t=tv?wr._normalizeArgs(arguments):wr._normalizeConnectArgs(arguments),t[1]&&(t[1]=Pe(t[1]));var r=e.apply(this,t);return gb(this),r}});var sM=require("http");Rt(sM.Agent.prototype,"addRequest",function(e){return function(t){var r=t.onSocket;return t.onSocket=Pe(function(n){return gb(n),r.apply(this,arguments)}),e.apply(this,arguments)}});var Zh=require("child_process");function db(e){Array.isArray(e.stdio)&&e.stdio.forEach(function(t){t&&t._handle&&(t._handle.onread=Pe(t._handle.onread),Rt(t._handle,"close",nl))}),e._handle&&(e._handle.onexit=Pe(e._handle.onexit))}Zh.ChildProcess?Rt(Zh.ChildProcess.prototype,"spawn",function(e){return function(){var t=e.apply(this,arguments);return db(this),t}}):gn(Zh,["execFile","fork","spawn"],function(e){return function(){var t=e.apply(this,arguments);return db(t),t}});process._fatalException||(process._originalNextTick=process.nextTick);var iv=[];process._nextDomainTick&&iv.push("_nextDomainTick");process._tickDomainCallback&&iv.push("_tickDomainCallback");gn(process,iv,Sr);Rt(process,"nextTick",nl);var sv=["setTimeout","setInterval"];global.setImmediate&&sv.push("setImmediate");var mb=require("timers"),aM=global.setTimeout===mb.setTimeout;gn(mb,sv,nl);aM&&gn(global,sv,nl);var rv=require("dns");gn(rv,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],Sr);rv.resolveNaptr&&Rt(rv,"resolveNaptr",Sr);var di=require("fs");gn(di,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],Sr);di.lchown&&Rt(di,"lchown",Sr);di.lchmod&&Rt(di,"lchmod",Sr);di.ftruncate&&Rt(di,"ftruncate",Sr);var Po;try{Po=require("zlib")}catch{}Po&&Po.Deflate&&Po.Deflate.prototype&&(pi=Object.getPrototypeOf(Po.Deflate.prototype),pi._transform?Rt(pi,"_transform",Sr):pi.write&&pi.flush&&pi.end&&gn(pi,["write","flush","end"],Sr));var pi,nv;try{nv=require("crypto")}catch{}nv&&(ev=["pbkdf2","randomBytes"],iM||ev.push("pseudoRandomBytes"),gn(nv,ev,Sr));var ev,tl=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";tl&&(hb=process.addAsyncListener({create:function(){tl=!1}}),global.Promise.resolve(!0).then(function(){tl=!1}),process.removeAsyncListener(hb));var hb;tl&&oM();function oM(){var e=global.Promise;function t(a){if(!(this instanceof t))return e(a);if(typeof a!="function")return new e(a);var o,u,c=new e(l);c.__proto__=t.prototype;try{a.apply(o,u)}catch(f){u[1](f)}return c;function l(f,p){o=this,u=[h,v];function h(T){return n(c,!1),f(T)}function v(T){return n(c,!1),p(T)}}}if(tM.inherits(t,e),Rt(e.prototype,"then",s),e.prototype.chain&&Rt(e.prototype,"chain",s),rM)global.Promise=fb()(e,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof e[a]=="function"&&(t[a]=e[a])}),global.Promise=t}function n(a,o){(!a.__asl_wrapper||o)&&(a.__asl_wrapper=Pe(i))}function i(a,o,u,c){var l;try{return l=o.call(a,u),{returnVal:l,error:!1}}catch(f){return{errorVal:f,error:!0}}finally{l instanceof e?c.__asl_wrapper=function(){var p=l.__asl_wrapper||i;return p.apply(this,arguments)}:n(c,!0)}}function s(a){return function(){var u=this,c=a.apply(u,Array.prototype.map.call(arguments,l));return c.__asl_wrapper=function(p,h,v,T){return u.__asl_wrapper?(u.__asl_wrapper(p,function(){},null,c),c.__asl_wrapper(p,h,v,T)):i(p,h,v,T)},c;function l(f){return typeof f!="function"?f:Pe(function(p){var h=(u.__asl_wrapper||i)(this,f,p,c);if(h.error)throw h.errorVal;return h.returnVal})}}}}function Sr(e){var t=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var i=0;i<arguments.length-1;i++)r[i]=arguments[i];r[n]=Pe(arguments[n])}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof n=="function"&&(n=Pe(n)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof i=="function"&&(i=Pe(i)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof s=="function"&&(s=Pe(s)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof a=="function"&&(a=Pe(a)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof o=="function"&&(o=Pe(o)),e.call(this,r,n,i,s,a,o))};default:return t}}function nl(e){var t=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=Pe(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof r=="function"&&(r=Pe(r)),e.call(this,r,n,i,s,a,o))};default:return t}}function uM(e){return(e=Number(e))>=0?e:!1}function cM(e){return typeof e=="string"&&uM(e)===!1}});var Ib=d((RV,Tb)=>{"use strict";var Yr=require("assert"),lM=jc(),Do="cls@contexts",av="error@context";process.addAsyncListener||yb();function cr(e){this.name=e,this.active=null,this._set=[],this.id=null}cr.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t};cr.prototype.get=function(e){if(!!this.active)return this.active[e]};cr.prototype.createContext=function(){return Object.create(this.active)};cr.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(r){throw r&&(r[av]=t),r}finally{this.exit(t)}};cr.prototype.runAndReturn=function(e){var t;return this.run(function(r){t=e(r)}),t};cr.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(n){throw n&&(n[av]=t),n}finally{r.exit(t)}}};cr.prototype.enter=function(e){Yr.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e};cr.prototype.exit=function(e){if(Yr.ok(e,"context must be provided for exiting"),this.active===e){Yr.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var t=this._set.lastIndexOf(e);Yr.ok(t>=0,"context not currently entered; can't exit"),Yr.ok(t,"can't remove top context"),this._set.splice(t,1)};cr.prototype.bindEmitter=function(e){Yr.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;function n(s){!s||(s[Do]||(s[Do]=Object.create(null)),s[Do][r]={namespace:t,context:t.active})}function i(s){if(!(s&&s[Do]))return s;var a=s,o=s[Do];return Object.keys(o).forEach(function(u){var c=o[u];a=c.namespace.bind(a,c.context)}),a}lM(e,n,i)};cr.prototype.fromException=function(e){return e[av]};function _b(e){return process.namespaces[e]}function fM(e){Yr.ok(e,"namespace must be given a name!");var t=new cr(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(r,n){n&&t.enter(n)},after:function(r,n){n&&t.exit(n)},error:function(r){r&&t.exit(r)}}),process.namespaces[e]=t,t}function Eb(e){var t=_b(e);Yr.ok(t,"can't delete nonexistent namespace!"),Yr.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function Cb(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Eb(e)}),process.namespaces=Object.create(null)}process.namespaces||Cb();Tb.exports={getNamespace:_b,createNamespace:fM,destroyNamespace:Eb,reset:Cb}});var Kn=d(uv=>{"use strict";Object.defineProperty(uv,"__esModule",{value:!0});var wb=Ke(),pM=Cc(),ko=oo(),ov=Rd(),bb=Kd(),dM=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return t===void 0?null:t},e.generateContextObject=function(t,r,n,i,s,a){return r=r||t,this.enabled?{operation:{name:n,id:t,parentId:r,traceparent:s,tracestate:a},customProperties:new hM(i)}:null},e.spanToContextObject=function(t,r,n){var i=new ko;return i.traceId=t.traceId,i.spanId=t.spanId,i.traceFlag=t.traceFlags||ko.DEFAULT_TRACE_FLAG,i.parentId=r,e.generateContextObject(i.traceId,i.parentId,n,null,i)},e.runWithContext=function(t,r){if(e.enabled)return e.session.bind(r,(n={},n[e.CONTEXT_NAME]=t,n))();return r();var n},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){if(e.enabled)return e.session.bind(t,r?(n={},n[e.CONTEXT_NAME]=r,n):void 0);return t;var n},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls>"u"&&(e.forceClsHooked===!0||e.forceClsHooked===void 0&&e.shouldUseClsHooked()?this.cls=VI():this.cls=Ib()),e.session=this.cls.createNamespace("AI-CLS-Session"),pM.registerContextPreservation(function(r){return e.session.bind(r)})),this.enabled=!0}},e.startOperation=function(t,r){var n=t&&t.traceContext||null,i=t&&t.traceId?t:null,s=t&&t.headers;if(i){var a=new ko("00-"+i.traceId+"-"+i.spanId+"-01"),o=new ov(i.tracestate),u=e.generateContextObject(i.traceId,"|"+i.traceId+"."+i.spanId+".",typeof r=="string"?r:"",void 0,a,o);return u}if(n){var a=new ko(n.traceparent),o=new ov(n.tracestate),c=typeof r=="object"?new bb(r):null,u=e.generateContextObject(a.traceId,a.parentId,typeof r=="string"?r:c.getOperationName({}),c&&c.getCorrelationContextHeader()||void 0,a,o);return u}if(s){var a=new ko(s.traceparent),o=new ov(s.tracestate),c=new bb(t),u=e.generateContextObject(a.traceId,a.parentId,c.getOperationName({}),c.getCorrelationContextHeader(),a,o);return u}return wb.warn("startOperation was called with invalid arguments",arguments),null},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>3||parseInt(t[0])>2&&parseInt(t[1])>2},e.shouldUseClsHooked=function(){var t=process.versions.node.split(".");return parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=2},e.canUseClsHooked=function(){var t=process.versions.node.split("."),r=parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=0,n=parseInt(t[0])<8||parseInt(t[0])<=8&&parseInt(t[1])<2,i=parseInt(t[0])>4||parseInt(t[0])>=4&&parseInt(t[1])>=7;return!(r&&n)&&i},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();uv.CorrelationContextManager=dM;var hM=function(){function e(t){this.props=[],this.addHeaderData(t)}return e.prototype.addHeaderData=function(t){var r=t?t.split(", "):[];this.props=r.map(function(n){var i=n.split("=");return{key:i[0],value:i[1]}}).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map(function(t){return t.key+"="+t.value}).join(", ")},e.prototype.getProperty=function(t){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===t)return n.value}},e.prototype.setProperty=function(t,r){if(e.bannedCharacters.test(t)||e.bannedCharacters.test(r)){wb.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+t+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var i=this.props[n];if(i.key===t){i.value=r;return}}this.props.push({key:t,value:r})},e.bannedCharacters=/[,=]/,e}()});var xb=d(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});var Sb=qt(),cv=Le(),hi=[],lv=function(e){var t=e.data.message;hi.forEach(function(r){t instanceof Error?r.trackException({exception:t}):(t.lastIndexOf(`
`)==t.length-1&&(t=t.substring(0,t.length-1)),r.trackTrace({message:t,severity:e.data.stderr?Sb.SeverityLevel.Warning:Sb.SeverityLevel.Information}))})};function vM(e,t){e?(hi.length===0&&cv.channel.subscribe("console",lv),hi.push(t)):(hi=hi.filter(function(r){return r!=t}),hi.length===0&&cv.channel.unsubscribe("console",lv))}il.enable=vM;function gM(){cv.channel.unsubscribe("console",lv),hi=[]}il.dispose=gM});var Ab=d(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var Os=qt(),fv=Le(),vi=[],mM={10:Os.SeverityLevel.Verbose,20:Os.SeverityLevel.Verbose,30:Os.SeverityLevel.Information,40:Os.SeverityLevel.Warning,50:Os.SeverityLevel.Error,60:Os.SeverityLevel.Critical},pv=function(e){var t=e.data.result;vi.forEach(function(r){var n=mM[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})})};function yM(e,t){e?(vi.length===0&&fv.channel.subscribe("bunyan",pv),vi.push(t)):(vi=vi.filter(function(r){return r!=t}),vi.length===0&&fv.channel.unsubscribe("bunyan",pv))}sl.enable=yM;function _M(){fv.channel.unsubscribe("bunyan",pv),vi=[]}sl.dispose=_M});var Rb=d(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var rt=qt(),dv=Le(),gi=[],EM={syslog:function(e){var t={emerg:rt.SeverityLevel.Critical,alert:rt.SeverityLevel.Critical,crit:rt.SeverityLevel.Critical,error:rt.SeverityLevel.Error,warning:rt.SeverityLevel.Warning,notice:rt.SeverityLevel.Information,info:rt.SeverityLevel.Information,debug:rt.SeverityLevel.Verbose};return t[e]===void 0?rt.SeverityLevel.Information:t[e]},npm:function(e){var t={error:rt.SeverityLevel.Error,warn:rt.SeverityLevel.Warning,info:rt.SeverityLevel.Information,verbose:rt.SeverityLevel.Verbose,debug:rt.SeverityLevel.Verbose,silly:rt.SeverityLevel.Verbose};return t[e]===void 0?rt.SeverityLevel.Information:t[e]},unknown:function(e){return rt.SeverityLevel.Information}},hv=function(e){var t=e.data.message;gi.forEach(function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=EM[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}})};function CM(e,t){e?(gi.length===0&&dv.channel.subscribe("winston",hv),gi.push(t)):(gi=gi.filter(function(r){return r!=t}),gi.length===0&&dv.channel.unsubscribe("winston",hv))}al.enable=CM;function TM(){dv.channel.unsubscribe("winston",hv),gi=[]}al.dispose=TM});var Db=d((NV,Pb)=>{"use strict";var IM=Cc(),bM=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(t,r){IM.IsInitialized&&(xb().enable(t&&r,this._client),Ab().enable(t,this._client),Rb().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();Pb.exports=bM});var Ob=d((qV,kb)=>{"use strict";var wM=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){this._isInitialized=!0;var n=this;if(!this._exceptionListenerHandle){var i=function(s,a,o){o===void 0&&(o=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:o}),r._client.flush({isAppCrashing:!0}),s&&a&&process.listeners(a).length===1&&(console.error(o),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=i.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();kb.exports=wM});var mn=d(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";ee.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";ee.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var ft;(function(e){e.COMMITTED_BYTES="\\Memory\\Committed Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",e.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",e.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",e.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",e.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",e.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",e.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(ft=ee.QuickPulseCounter||(ee.QuickPulseCounter={}));var ol;(function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(ol=ee.PerformanceCounter||(ee.PerformanceCounter={}));ee.PerformanceToQuickPulseCounter=(lr={},lr[ol.PROCESSOR_TIME]=ft.PROCESSOR_TIME,lr[ol.REQUEST_RATE]=ft.REQUEST_RATE,lr[ol.REQUEST_DURATION]=ft.REQUEST_DURATION,lr[ft.COMMITTED_BYTES]=ft.COMMITTED_BYTES,lr[ft.REQUEST_FAILURE_RATE]=ft.REQUEST_FAILURE_RATE,lr[ft.DEPENDENCY_RATE]=ft.DEPENDENCY_RATE,lr[ft.DEPENDENCY_FAILURE_RATE]=ft.DEPENDENCY_FAILURE_RATE,lr[ft.DEPENDENCY_DURATION]=ft.DEPENDENCY_DURATION,lr[ft.EXCEPTION_RATE]=ft.EXCEPTION_RATE,lr);ee.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};ee.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};ee.TelemetryTypeStringToQuickPulseType={EventData:ee.QuickPulseType.Event,ExceptionData:ee.QuickPulseType.Exception,MessageData:ee.QuickPulseType.Trace,MetricData:ee.QuickPulseType.Metric,RequestData:ee.QuickPulseType.Request,RemoteDependencyData:ee.QuickPulseType.Dependency,AvailabilityData:ee.QuickPulseType.Availability,PageViewData:ee.QuickPulseType.PageView};ee.TelemetryTypeStringToQuickPulseDocumentType={EventData:ee.QuickPulseDocumentType.Event,ExceptionData:ee.QuickPulseDocumentType.Exception,MessageData:ee.QuickPulseDocumentType.Trace,MetricData:ee.QuickPulseDocumentType.Metric,RequestData:ee.QuickPulseDocumentType.Request,RemoteDependencyData:ee.QuickPulseDocumentType.Dependency,AvailabilityData:ee.QuickPulseDocumentType.Availability,PageViewData:ee.QuickPulseDocumentType.PageView};ee.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"};ee.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"};ee.HeartBeatMetricName="HeartBeat";var lr});var cl=d((MV,Nb)=>{"use strict";var ul=require("os"),Wt=mn(),SM=function(){function e(t,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=ul.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalRequestExecutionTime+=n,r===!1&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalDependencyExecutionTime+=n,r===!1&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var t=ul.cpus();if(t&&t.length&&this._lastCpus&&t.length===this._lastCpus.length){for(var r=0,n=0,i=0,s=0,a=0,o=0;!!t&&o<t.length;o++){var u=t[o],c=this._lastCpus[o],l="% cpu("+o+") ",f=u.model,p=u.speed,h=u.times,v=c.times,T=h.user-v.user||0;r+=T;var S=h.sys-v.sys||0;n+=S;var x=h.nice-v.nice||0;i+=x;var m=h.idle-v.idle||0;s+=m;var A=h.irq-v.irq||0;a+=A}var Y=void 0;if(typeof process.cpuUsage=="function"){var J=process.cpuUsage(),de=process.hrtime(),nt=J.user-this._lastAppCpuUsage.user+(J.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var Mt=(de[0]-this._lastHrtime[0])*1e6+(de[1]-this._lastHrtime[1])/1e3||0;Y=100*nt/(Mt*t.length)}this._lastAppCpuUsage=J,this._lastHrtime=de}var dt=r+n+i+s+a||1;this._client.trackMetric({name:Wt.PerformanceCounter.PROCESSOR_TIME,value:(dt-s)/dt*100}),this._client.trackMetric({name:Wt.PerformanceCounter.PROCESS_TIME,value:Y||r/dt*100})}this._lastCpus=t},e.prototype._trackMemory=function(){var t=ul.freemem(),r=process.memoryUsage().rss,n=ul.totalmem()-t;this._client.trackMetric({name:Wt.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:Wt.PerformanceCounter.AVAILABLE_BYTES,value:t}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Wt.QuickPulseCounter.COMMITTED_BYTES,value:n})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,s>0){var u=n/a,c=i/a;this._client.trackMetric({name:Wt.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Wt.PerformanceCounter.REQUEST_DURATION,value:o}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Wt.QuickPulseCounter.REQUEST_FAILURE_RATE,value:c})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,s>0){var u=n/a,c=i/a;this._client.trackMetric({name:Wt.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:Wt.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:c}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Wt.QuickPulseCounter.DEPENDENCY_DURATION,value:o})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time,s=i/1e3;if(i>0){var a=n/s;this._client.trackMetric({name:Wt.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._lastRequestExecutionTime=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._lastDependencyExecutionTime=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();Nb.exports=SM});var Oo=d((HV,Hb)=>{"use strict";var Jr=require("os"),qb=require("fs"),Lb=require("path"),xM=qt(),Mb=Ke(),AM=function(){function e(t){this.keys=new xM.ContextTagKeys,this.tags={},this._loadApplicationContext(t),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||Lb.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(qb.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.appVersion[t]=r.version)}catch(n){Mb.info("unable to read app version: ",n)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=Jr&&Jr.hostname(),this.tags[this.keys.deviceOSVersion]=Jr&&Jr.type()+" "+Jr.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=Jr&&Jr.arch(),this.tags["ai.device.osPlatform"]=Jr&&Jr.platform()},e.prototype._loadInternalContext=function(){var t=Lb.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(qb.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.sdkVersion=r.version)}catch(n){Mb.info("unable to read app version: ",n)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();Hb.exports=AM});var jb=d((gv,Fb)=>{"use strict";var RM=gv&&gv.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fr=require("url"),vv=qt(),PM=Nt(),DM=ds(),kM=Qd(),OM=ri(),NM=function(e){RM(t,e);function t(r,n){var i=e.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=t._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return t.prototype.onError=function(r){this._setStatus(void 0,r)},t.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=PM.getCorrelationContextTarget(r,DM.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(r,n){var i=fr.parse(this.url);i.search=void 0,i.hash=void 0;var s=this.method.toUpperCase()+" "+i.pathname,a=vv.RemoteDependencyDataConstants.TYPE_HTTP,o=i.hostname;i.port&&(o+=":"+i.port),this.correlationId?(a=vv.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==OM.correlationIdPrefix&&(o+=" | "+this.correlationId)):a=vv.RemoteDependencyDataConstants.TYPE_HTTP;var u={id:n,name:s,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:a,target:o};if(r&&r.time?u.time=r.time:this.startTime&&(u.time=new Date(this.startTime)),r){for(var c in r)u[c]||(u[c]=r[c]);if(r.properties)for(var c in r.properties)u.properties[c]=r.properties[c]}return u},t._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)r=fr.parse(r);else{var i=fr.parse(r);i.host==="443"?r=fr.parse("https://"+r):r=fr.parse("http://"+r)}else{if(r&&typeof fr.URL=="function"&&r instanceof fr.URL)return fr.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(u){r[u]=s[u]})}if(r.path){var a=fr.parse(r.path);r.pathname=a.pathname,r.search=a.search}if(r.host&&r.port){var o=fr.parse("http://"+r.host);!o.port&&r.port&&(r.hostname=r.host,delete r.host)}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",fr.format(r)},t}(kM);Fb.exports=NM});var $b=d(No=>{"use strict";var Ub=No&&No.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(No,"__esModule",{value:!0});var qM=sc(),Pt=mn();function mv(e){var t=Ub({},e);return Object.keys(Pt.SpanAttribute).forEach(function(r){delete t[r]}),t}function LM(e){var t="|"+e.context().traceId+"."+e.context().spanId+".",r=Math.round(e._duration[0]*1e3+e._duration[1]/1e6),n=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",i=e.attributes.component?e.attributes.component.toString():"",s=i.toUpperCase()===Pt.DependencyTypeName.Http||!!e.attributes[Pt.SpanAttribute.HttpUrl],a=i.toLowerCase()===Pt.DependencyTypeName.Grpc;if(s){var o=e.attributes[Pt.SpanAttribute.HttpMethod]||"GET",u=new URL(e.attributes[Pt.SpanAttribute.HttpUrl].toString()),c=e.attributes[Pt.SpanAttribute.HttpHost]||u.host,l=e.attributes[Pt.SpanAttribute.HttpPort]||u.port||null,f=u.pathname||"/",p=o+" "+f,h=Pt.DependencyTypeName.Http,v=l?(c+":"+l).toString():c.toString(),T=u.toString(),S=e.attributes[Pt.SpanAttribute.HttpStatusCode]||e.status.code||0,x=S<400;return{id:t,name:p,dependencyTypeName:h,target:v,data:T,success:x,duration:r,url:T,resultCode:String(S),properties:mv(e.attributes)}}else if(a){var o=e.attributes[Pt.SpanAttribute.GrpcMethod]||"rpc",m=e.attributes[Pt.SpanAttribute.GrpcService],A=m?o+" "+m:e.name;return{id:t,duration:r,name:A,target:m.toString(),data:m.toString()||A,url:m.toString()||A,dependencyTypeName:Pt.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:e.status.code===0,properties:mv(e.attributes)}}else{var Y=e.name,J=e.links&&e.links.map(function(de){return{operation_Id:de.context.traceId,id:de.context.spanId}});return{id:t,duration:r,name:Y,target:n,data:n||Y,url:n||Y,dependencyTypeName:e.kind===qM.SpanKind.INTERNAL?Pt.DependencyTypeName.InProc:i||e.name,resultCode:String(e.status.code||0),success:e.status.code===0,properties:Ub({},mv(e.attributes),{"_MS.links":J||void 0})}}}No.spanToTelemetryContract=LM});var Bb=d(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});var Vb=Le(),MM=oo(),HM=$b(),ll=sc(),Ns=[];qs.subscriber=function(e){var t=e.data,r=HM.spanToTelemetryContract(t),n=t.context(),i=new MM;i.traceId=n.traceId,i.spanId=n.spanId,i.traceFlag=n.traceFlags.toString(),i.parentId=t.parentSpanId?"|"+n.traceId+"."+t.parentSpanId+".":null,ll.AsyncScopeManager.with(t,function(){Ns.forEach(function(s){t.kind===ll.SpanKind.SERVER?s.trackRequest(r):(t.kind===ll.SpanKind.CLIENT||t.kind===ll.SpanKind.INTERNAL)&&s.trackDependency(r)})})};function FM(e,t){e?(Ns.length===0&&Vb.channel.subscribe("azure-coretracing",qs.subscriber),Ns.push(t)):(Ns=Ns.filter(function(r){return r!=t}),Ns.length===0&&Vb.channel.unsubscribe("azure-coretracing",qs.subscriber))}qs.enable=FM});var zb=d(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});var Gb=Le(),Ls=[];Ms.subscriber=function(e){e.data.event.commandName!=="ismaster"&&Ls.forEach(function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})})};function jM(e,t){e?(Ls.length===0&&Gb.channel.subscribe("mongodb",Ms.subscriber),Ls.push(t)):(Ls=Ls.filter(function(r){return r!=t}),Ls.length===0&&Gb.channel.unsubscribe("mongodb",Ms.subscriber))}Ms.enable=jM});var Xb=d(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});var Qb=Le(),Hs=[];Fs.subscriber=function(e){Hs.forEach(function(t){var r=e.data.query||{},n=r.sql||"Unknown query",i=!e.data.err,s=r._connection||{},a=s.config||{},o=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})})};function UM(e,t){e?(Hs.length===0&&Qb.channel.subscribe("mysql",Fs.subscriber),Hs.push(t)):(Hs=Hs.filter(function(r){return r!=t}),Hs.length===0&&Qb.channel.unsubscribe("mysql",Fs.subscriber))}Fs.enable=UM});var Kb=d(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});var Wb=Le(),js=[];Us.subscriber=function(e){js.forEach(function(t){e.data.commandObj.command!=="info"&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})})};function $M(e,t){e?(js.length===0&&Wb.channel.subscribe("redis",Us.subscriber),js.push(t)):(js=js.filter(function(r){return r!=t}),js.length===0&&Wb.channel.unsubscribe("redis",Us.subscriber))}Us.enable=$M});var Jb=d(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});var Yb=Le(),$s=[];Vs.subscriber=function(e){$s.forEach(function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!e.data.error,s=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:s,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})})};function VM(e,t){e?($s.length===0&&Yb.channel.subscribe("postgres",Vs.subscriber),$s.push(t)):($s=$s.filter(function(r){return r!=t}),$s.length===0&&Yb.channel.unsubscribe("postgres",Vs.subscriber))}Vs.enable=VM});var Gs=d((GV,rw)=>{"use strict";var mi=require("http"),Bs=require("https"),yv=Ke(),Zb=Nt(),yn=ds(),BM=jb(),ew=Kn(),tw=ri(),_v=oo(),GM=Cc(),zM=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,this._isEnabled&&!this._isInitialized&&this._initialize(),GM.IsInitialized&&(Bb().enable(!0,this._client),zb().enable(t,this._client),Xb().enable(t,this._client),Kb().enable(t,this._client),Jb().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=mi.get,n=mi.request,i=Bs.request,s=function(a,o){var u=!o[e.disableCollectionRequestOption]&&!a[e.alreadyAutoCollectedFlag];o.headers&&o.headers["user-agent"]&&o.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(u=!1),a[e.alreadyAutoCollectedFlag]=!0,a&&o&&u&&(ew.CorrelationContextManager.wrapEmitter(a),e.trackRequest(t._client,{options:o,request:a}))};mi.request=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=n.call.apply(n,[mi,a].concat(o));return s(c,a),c},Bs.request=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=i.call.apply(i,[Bs,a].concat(o));return s(c,a),c},mi.get=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(l=mi.request).call.apply(l,[mi,a].concat(o));return c.end(),c;var l},Bs.get=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(l=Bs.request).call.apply(l,[Bs,a].concat(o));return c.end(),c;var l}},e.trackRequest=function(t,r){if(!r.options||!r.request||!t){yv.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t);return}var n=new BM(r.options,r.request),i=ew.CorrelationContextManager.getCurrentContext(),s,a;if(i&&i.operation&&i.operation.traceparent&&_v.isValidTraceId(i.operation.traceparent.traceId))i.operation.traceparent.updateSpanId(),s=i.operation.traceparent.getBackCompatRequestId();else if(tw.w3cEnabled){var o=new _v;a=o.toString(),s=o.getBackCompatRequestId()}else s=i&&i.operation&&i.operation.parentId+e.requestNumber+++".";if(Zb.canIncludeCorrelationHeader(t,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var u=r.request.getHeader(yn.requestContextHeader);try{Zb.safeIncludeCorrelationHeader(t,r.request,u)}catch(f){yv.warn("Request-Context header could not be set. Correlation of requests may be lost",f)}if(i&&i.operation)try{if(r.request.setHeader(yn.requestIdHeader,s),t.config.ignoreLegacyHeaders||(r.request.setHeader(yn.parentIdHeader,i.operation.id),r.request.setHeader(yn.rootIdHeader,s)),a||i.operation.traceparent)r.request.setHeader(yn.traceparentHeader,a||i.operation.traceparent.toString());else if(tw.w3cEnabled){var o=new _v().toString();r.request.setHeader(yn.traceparentHeader,o)}if(i.operation.tracestate){var c=i.operation.tracestate.toString();c&&r.request.setHeader(yn.traceStateHeader,c)}var l=i.customProperties.serializeToHeader();l&&r.request.setHeader(yn.correlationContextHeader,l)}catch(f){yv.warn("Correlation headers could not be set. Correlation of requests may be lost.",f)}}r.request.on&&(r.request.on("response",function(f){n.onResponse(f);var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,p.contextObjects["http.ClientResponse"]=f,t.trackDependency(p)}),r.request.on("error",function(f){n.onError(f);var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,p.contextObjects.Error=f,t.trackDependency(p)}))},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();rw.exports=zM});var sw=d((zV,iw)=>{"use strict";var QM=require("os"),nw=mn(),XM=Nt(),WM=Oo(),KM=Gs(),YM="http://169.254.169.254/metadata/instance/compute",JM="api-version=2017-12-01",ZM="format=json",eH="ENETUNREACH",tH=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._handle=setInterval(function(){return n.trackHeartBeat(r,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(t,r){var n=this,i=!1,s={},a=WM.sdkVersion;s.sdk=a,s.osType=QM.type(),process.env.WEBSITE_SITE_NAME?(s.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",s.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",s.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?s.azfunction_appId=process.env.WEBSITE_HOSTNAME:t&&(this._isVM===void 0?(i=!0,this._getAzureComputeMetadata(t,function(){n._isVM&&Object.keys(n._vmData).length>0&&(s.azInst_vmId=n._vmData.vmId||"",s.azInst_subscriptionId=n._vmData.subscriptionId||"",s.azInst_osType=n._vmData.osType||"",n._azInst_vmId=n._vmData.vmId||"",n._azInst_subscriptionId=n._vmData.subscriptionId||"",n._azInst_osType=n._vmData.osType||""),n._client.trackMetric({name:nw.HeartBeatMetricName,value:0,properties:s}),r()})):this._isVM&&(s.azInst_vmId=this._azInst_vmId,s.azInst_subscriptionId=this._azInst_subscriptionId,s.azInst_osType=this._azInst_osType)),i||(this._client.trackMetric({name:nw.HeartBeatMetricName,value:0,properties:s}),r())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(t,r){var n=this,i=YM+"?"+JM+"&"+ZM,s=(o={method:"GET"},o[KM.disableCollectionRequestOption]=!0,o.headers={Metadata:"True"},o),a=XM.makeRequest(t,i,s,function(u){if(u.statusCode===200){n._isVM=!0;var c="";u.on("data",function(l){c+=l}),u.on("end",function(){n._vmData=n._isJSON(c)?JSON.parse(c):{},r()})}else r()});a&&(a.on("error",function(u){u&&u.message&&u.message.indexOf(eH)>-1&&(n._isVM=!1),r()}),a.end());var o},e.prototype._isJSON=function(t){try{return JSON.parse(t)&&!!t}catch{return!1}},e}();iw.exports=tH});var Cv=d((QV,lw)=>{"use strict";var aw=require("http"),ow=require("https"),uw=Ke(),cw=Nt(),rH=ds(),Ev=Kd(),Zr=Kn(),nH=cl(),iH=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,(this._isAutoCorrelating||this._isEnabled||nH.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(t,r){t&&!this._isAutoCorrelating?Zr.CorrelationContextManager.enable(r):!t&&this._isAutoCorrelating&&Zr.CorrelationContextManager.disable(),this._isAutoCorrelating=t},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(t){if(!!this._isAutoCorrelating)return Zr.CorrelationContextManager.generateContextObject(t.getOperationId(this._client.context.tags),t.getRequestId(),t.getOperationName(this._client.context.tags),t.getCorrelationContextHeader(),t.getTraceparent(),t.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(a){if(!!a){if(typeof a!="function")throw new Error("onRequest handler must be a function");return function(o,u){Zr.CorrelationContextManager.wrapEmitter(o),Zr.CorrelationContextManager.wrapEmitter(u);var c=o&&!o[e.alreadyAutoCollectedFlag];if(o&&c){var l=new Ev(o),f=t._generateCorrelationContext(l);Zr.CorrelationContextManager.runWithContext(f,function(){t._isEnabled&&(o[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:o,response:u},l)),typeof a=="function"&&a(o,u)})}else typeof a=="function"&&a(o,u)}}},n=function(a){var o=a.addListener.bind(a);a.addListener=function(u,c){switch(u){case"request":case"checkContinue":return o(u,r(c));default:return o(u,c)}},a.on=a.addListener},i=aw.createServer;aw.createServer=function(a,o){if(o&&typeof o=="function"){var u=i(a,r(o));return n(u),u}else{var u=i(r(a));return n(u),u}};var s=ow.createServer;ow.createServer=function(a,o){var u=s(a,r(o));return n(u),u}},e.trackRequestSync=function(t,r){if(!r.request||!r.response||!t){uw.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t);return}e.addResponseCorrelationIdHeader(t,r.response);var n=Zr.CorrelationContextManager.getCurrentContext(),i=new Ev(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(t.context.tags)||n.operation.id,n.operation.name=i.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),e.endRequest(t,i,r,r.duration,r.error)},e.trackRequest=function(t,r,n){if(!r.request||!r.response||!t){uw.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t);return}var i=Zr.CorrelationContextManager.getCurrentContext(),s=n||new Ev(r.request,i&&i.operation.parentId);cw.canIncludeCorrelationHeader(t,s.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),i&&!n&&(i.operation.id=s.getOperationId(t.context.tags)||i.operation.id,i.operation.name=s.getOperationName(t.context.tags)||i.operation.name,i.operation.parentId=s.getOperationParentId(t.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){e.endRequest(t,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){e.endRequest(t,s,r,null,a)})},e.addResponseCorrelationIdHeader=function(t,r){if(t.config&&t.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(rH.requestContextHeader);cw.safeIncludeCorrelationHeader(t,r,n)}},e.endRequest=function(t,r,n,i,s){s?r.onError(s,i):r.onResponse(n.response,i);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(t.context.tags),n.tagOverrides)for(var o in n.tagOverrides)a.tagOverrides[o]=n.tagOverrides[o];var u=r.getLegacyRootId();u&&(a.properties.ai_legacyRootId=u),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,t.trackRequest(a)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,Zr.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();lw.exports=iH});var dw=d((XV,pw)=>{"use strict";var fw=mn(),sH=function(){function e(){}return e.parse=function(t){if(!t)return{};var r=t.split(e._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var o=a.split(e._FIELD_KEY_VALUE_SEPARATOR);if(o.length===2){var u=o[0].toLowerCase(),c=o[1];s[u]=c}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||fw.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||fw.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();pw.exports=sH});var fl=d((WV,gw)=>{"use strict";var Tv=ri(),hw=dw(),aH=Ke(),vw=mn(),oH=require("url"),uH=function(){function e(t){var r=this;this.endpointBase=vw.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],i=hw.parse(t),s=hw.parse(n),a=!i.instrumentationkey&&Object.keys(i).length>0?null:t;this.instrumentationKey=i.instrumentationkey||a||s.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey)||aH.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this.endpointUrl=(i.ingestionendpoint||s.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(o){return r.correlationId=o},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=i.ingestionendpoint||s.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=i.liveendpoint||s.liveendpoint||process.env[e.ENV_quickPulseHost]||vw.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=oH.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(t){Tv.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=t,this.correlationId=Tv.correlationIdPrefix,Tv.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(t){this._quickPulseHost=t},enumerable:!0,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||t=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(t){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(t)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();gw.exports=uH});var _w=d((bv,yw)=>{"use strict";var qo=bv&&bv.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Iv=require("os"),yi=qt(),mw=mn(),cH=Nt(),lH=Ke(),fH=cH.w3cTraceId(),pH=function(){function e(){}return e.createQuickPulseEnvelope=function(t,r,n,i){var s=Iv&&typeof Iv.hostname=="function"&&Iv.hostname()||"Unknown",a=i.tags&&i.keys&&i.keys.cloudRoleInstance&&i.tags[i.keys.cloudRoleInstance]||s,o={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:t.length>0?t:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:i.tags[i.keys.internalSdkVersion],StreamId:fH,MachineName:s,Instance:a};return o},e.createQuickPulseMetric=function(t){var r;return r={Name:t.name,Value:t.value,Weight:t.count||1},r},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case yi.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case yi.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case yi.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case yi.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case yi.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.name,i=qo({},r,{Name:n});return i},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.severityLevel||0,i=qo({},r,{Message:t.data.baseData.message,SeverityLevel:yi.SeverityLevel[n]});return i},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.exceptions,i="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(u){i+=u.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(i=n[0].stack),s=n[0].message,a=n[0].typeName);var o=qo({},r,{Exception:i,ExceptionMessage:s,ExceptionType:a});return o},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=qo({},r,{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return i},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=qo({},r,{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return i},e.createQuickPulseDocument=function(t){var r,n,i,s;t.data.baseType?(n=mw.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=mw.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):lH.warn("Document type invalid; not sending live metric document",t.data.baseType),i=t.tags[e.keys.operationId],s=e.aggregateProperties(t);var a={DocumentType:r,__type:n,OperationId:i,Version:"1.0",Properties:s};return a},e.aggregateProperties=function(t){var r=[],n=t.data.baseData.measurements||{};for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],a={key:i,value:s};r.push(a)}var o=t.data.baseData.properties||{};for(var i in o)if(o.hasOwnProperty(i)){var s=o[i],a={key:i,value:s};r.push(a)}return r},e.keys=new yi.ContextTagKeys,e}();yw.exports=pH});var Cw=d((KV,Ew)=>{"use strict";var dH=function(){return(Date.now()+621355968e5)*1e4};Ew.exports={getTransmissionTime:dH}});var bw=d((YV,Iw)=>{"use strict";var hH=require("https"),vH=Gs(),Tw=Ke(),gH=Cw(),mH=Nt(),wv={method:"POST",time:"x-ms-qps-transmission-time",subscribed:"x-ms-qps-subscribed"},yH=function(){function e(t){this._config=t,this._consecutiveErrors=0}return e.prototype.ping=function(t,r){this._submitData(t,r,"ping")},e.prototype.post=function(t,r){this._submitData([t],r,"post")},e.prototype._submitData=function(t,r,n){var i=this,s=JSON.stringify(t),a=(u={},u[vH.disableCollectionRequestOption]=!0,u.host=this._config.quickPulseHost,u.method=wv.method,u.path="/QuickPulseService.svc/"+n+"?ikey="+this._config.instrumentationKey,u.headers=(c={Expect:"100-continue"},c[wv.time]=gH.getTransmissionTime(),c["Content-Type"]="application/json",c["Content-Length"]=Buffer.byteLength(s),c),u);this._config.httpsAgent?a.agent=this._config.httpsAgent:a.agent=mH.tlsRestrictedAgent;var o=hH.request(a,function(l){var f=l.headers[wv.subscribed]==="true";i._consecutiveErrors=0,r(f,l)});o.on("error",function(l){i._consecutiveErrors++;var f="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";i._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN===0?(f="Live Metrics endpoint could not be reached "+i._consecutiveErrors+" consecutive times. Most recent error:",Tw.warn(e.TAG,f,l)):Tw.info(e.TAG,f,l),r()}),o.write(s),o.end();var u,c},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();Iw.exports=yH});var Sw=d((JV,ww)=>{"use strict";var _H=Ke(),EH=fl(),Sv=_w(),CH=bw(),TH=mn(),IH=Oo(),bH=function(){function e(t,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new EH(t),this.context=r||new IH,this._sender=new CH(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(t){this._collectors.push(t)},e.prototype.trackMetric=function(t){this._addMetric(t)},e.prototype.addDocument=function(t){var r=Sv.telemetryEnvelopeToQuickPulseDocument(t);r&&this._documents.push(r)},e.prototype.enable=function(t){t&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!t&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(t){this._collectors.forEach(function(r){r.enable(t)})},e.prototype._addMetric=function(t){var r=t.value,n=t.count||1,i=TH.PerformanceToQuickPulseCounter[t.name];i&&(this._metrics[i]?(this._metrics[i].Value=(this._metrics[i].Value*this._metrics[i].Weight+r*n)/(this._metrics[i].Weight+n),this._metrics[i].Weight+=n):(this._metrics[i]=Sv.createQuickPulseMetric(t),this._metrics[i].Name=i,this._metrics[i].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){var t=this,r=Object.keys(this._metrics).map(function(s){return t._metrics[s]}),n=Sv.createQuickPulseEnvelope(r,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(n):this._ping(n);var i=this._isCollectingData?e.POST_INTERVAL:e.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,i=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(i=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),i),this._handle.unref()},e.prototype._ping=function(t){this._sender.ping(t,this._quickPulseDone.bind(this))},e.prototype._post=function(t){this._sender.post(t,this._quickPulseDone.bind(this))},e.prototype._quickPulseDone=function(t,r){t!=null?(this._isCollectingData!==t&&(_H.info("Live Metrics sending data",t),this.enableCollectors(t)),this._isCollectingData=t,r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();ww.exports=bH});var Aw=d(Mo=>{"use strict";var wH=Mo&&Mo.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Mo,"__esModule",{value:!0});var xw=fl(),Lo=Oo(),SH=Ke(),xH=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>=6},e.prototype.enable=function(t,r,n){var i=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),!!e.isNodeVersionCompatible()){if(e._metricsAvailable==null&&t&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");e._emitter=new s,e._metricsAvailable=!0,SH.info("Native metrics module successfully loaded!")}catch{e._metricsAvailable=!1;return}this._isEnabled=t,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,n),this._handle=setInterval(function(){return i._trackNativeMetrics()},n),this._handle.unref()):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(t){var r=process.env[xw.ENV_nativeMetricsDisableAll],n=process.env[xw.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(n){var i=n.split(","),s={};if(i.length>0)for(var a=0,o=i;a<o.length;a++){var u=o[a];s[u]=!0}return typeof t=="object"?{isEnabled:!0,disabledMetrics:wH({},t,s)}:{isEnabled:t,disabledMetrics:s}}return typeof t=="boolean"?{isEnabled:t,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:t}},e.prototype._trackNativeMetrics=function(){var t=!0;typeof this._isEnabled!="object"&&(t=this._isEnabled),t&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var t=e._emitter.getGCData();for(var r in t){var n=t[r].metrics,i=r+" Garbage Collection Duration",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:i,value:n.total,count:n.count,max:n.max,min:n.min,stdDev:s,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Lo.sdkVersion,a)})}var a}},e.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var t=e._emitter.getLoopData(),r=t.loopUsage;if(r.count!=0){var n="Event Loop CPU Time",i=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:n,value:r.total,count:r.count,min:r.min,max:r.max,stdDev:i,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Lo.sdkVersion,s)});var s}}},e.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var t=process.memoryUsage(),r=t.heapUsed,n=t.heapTotal,i=t.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:r,count:1,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Lo.sdkVersion,s)}),this._client.trackMetric({name:"Memory Total (Heap)",value:n,count:1,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Lo.sdkVersion,a)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:i-n,count:1,tagOverrides:(o={},o[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Lo.sdkVersion,o)});var s,a,o}},e}();Mo.AutoCollectNativePerformance=xH});var Dw=d((e2,Pw)=>{"use strict";var Rw=Ke(),AH=function(){function e(t,r,n,i){this._buffer=[],this._lastSend=0,this._isDisabled=t,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=i}return e.prototype.setUseDiskRetryCaching=function(t,r,n){this._sender.setDiskRetryMode(t,r,n)},e.prototype.send=function(t){var r=this;if(!this._isDisabled()){if(!t){Rw.warn("Cannot send null/undefined telemetry");return}var n=this._stringify(t);if(typeof n=="string"){if(this._buffer.push(n),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}}},e.prototype.triggerSend=function(t,r){var n=this._buffer.length<1;if(!n){var i=this._buffer.join(`
`);t?(this._sender.saveOnCrash(i),typeof r=="function"&&r("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(i):new Buffer(i),r)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},e.prototype._stringify=function(t){try{return JSON.stringify(t)}catch(r){Rw.warn("Failed to serialize payload",r,t)}},e}();Pw.exports=AH});var kw=d(xv=>{"use strict";Object.defineProperty(xv,"__esModule",{value:!0});function RH(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}xv.azureRoleEnvironmentTelemetryProcessor=RH});var qw=d(pl=>{"use strict";Object.defineProperty(pl,"__esModule",{value:!0});var Ow=qt();function PH(e,t){var r=e.sampleRate,n=!1;return r==null||r>=100||e.data&&Ow.TelemetryType.Metric===Ow.baseTypeToTelemetryType(e.data.baseType)?!0:(t.correlationContext&&t.correlationContext.operation?n=Nw(t.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}pl.samplingTelemetryProcessor=PH;function Nw(e){var t=-2147483648,r=2147483647,n=5381;if(!e)return 0;for(;e.length<8;)e=e+e;for(var i=0;i<e.length;i++)n=((n<<5)+n|0)+e.charCodeAt(i)|0;return n=n<=t?r:Math.abs(n),n/r*100}pl.getSamplingHashCode=Nw});var Lw=d(Pv=>{"use strict";Object.defineProperty(Pv,"__esModule",{value:!0});var Av=cl(),Rv=qt();function DH(e,t){switch(t&&t.addDocument(e),e.data.baseType){case Rv.TelemetryTypeString.Exception:Av.countException();break;case Rv.TelemetryTypeString.Request:var r=e.data.baseData;Av.countRequest(r.duration,r.success);break;case Rv.TelemetryTypeString.Dependency:var n=e.data.baseData;Av.countDependency(n.duration,n.success);break}return!0}Pv.performanceMetricsTelemetryProcessor=DH});var Mw=d(dl=>{"use strict";function Dv(e){for(var t in e)dl.hasOwnProperty(t)||(dl[t]=e[t])}Object.defineProperty(dl,"__esModule",{value:!0});Dv(kw());Dv(qw());Dv(Lw())});var Fw=d((s2,Hw)=>{"use strict";var Tt=require("fs"),hl=require("os"),en=require("path"),kH=require("zlib"),zs=require("child_process"),pt=Ke(),OH=Gs(),NH=Nt(),qH=function(){function e(t,r,n){if(this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._resendTimer=null,!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=Tt.existsSync(e.ICACLS_PATH)}catch{}e.OS_PROVIDES_FILE_PROTECTION||pt.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,pt.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},e.prototype.send=function(t,r){var n=this,i=this._config.endpointUrl,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};kH.gzip(t,function(a,o){var u=o;a?(pt.warn(a),u=t,s.headers["Content-Length"]=t.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=o.length),pt.info(e.TAG,s),s[OH.disableCollectionRequestOption]=!0;var c=function(f){f.setEncoding("utf-8");var p="";f.on("data",function(h){p+=h}),f.on("end",function(){n._numConsecutiveFailures=0,pt.info(e.TAG,p),typeof n._onSuccess=="function"&&n._onSuccess(p),typeof r=="function"&&r(p),n._enableDiskRetryMode&&(f.statusCode===200?n._resendTimer||(n._resendTimer=setTimeout(function(){n._resendTimer=null,n._sendFirstFileOnDisk()},n._resendInterval),n._resendTimer.unref()):(f.statusCode===408||f.statusCode===429||f.statusCode===439||f.statusCode===500||f.statusCode===503)&&n._storeToDisk(t))})},l=NH.makeRequest(n._config,i,s,c);l.on("error",function(f){if(n._numConsecutiveFailures++,!n._enableDiskRetryMode||n._numConsecutiveFailures>0&&n._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var p="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";n._enableDiskRetryMode&&(p="Ingestion endpoint could not be reached "+n._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),pt.warn(e.TAG,p,f)}else{var p="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";pt.info(e.TAG,p,f)}if(n._onErrorHelper(f),typeof r=="function"){var h="error sending telemetry";f&&typeof f.toString=="function"&&(h=f.toString()),r(h)}n._enableDiskRetryMode&&n._storeToDisk(t)}),l.write(u),l.end()})},e.prototype.saveOnCrash=function(t){this._enableDiskRetryMode&&this._storeToDiskSync(t)},e.prototype._runICACLS=function(t,r){var n=zs.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",function(i){return r(i)}),n.on("close",function(i,s){return r(i===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+i+")"))})},e.prototype._runICACLSSync=function(t){if(zs.spawnSync){var r=zs.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=zs.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",function(i){return n+=i}),r.on("error",function(i){return t(i,null)}),r.on("close",function(i,s){return e.ACL_IDENTITY=n&&n.trim(),t(i===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+i+")"),e.ACL_IDENTITY)})},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(zs.spawnSync){var t=zs.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(t.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(t,r){return[t,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;if(!e.USE_ICACLS)return r(null);if(e.ACLED_DIRECTORIES[t]===void 0)e.ACLED_DIRECTORIES[t]=!1,this._getACLIdentity(function(i,s){if(i)return e.ACLED_DIRECTORIES[t]=!1,r(i);n._runICACLS(n._getACLArguments(t,s),function(a){return e.ACLED_DIRECTORIES[t]=!a,r(a)})});else return r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(e.ACLED_DIRECTORIES[t]===void 0){this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),e.ACLED_DIRECTORIES[t]=!0;return}else if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(t,r){var n=this;Tt.lstat(t,function(i,s){i&&i.code==="ENOENT"?Tt.mkdir(t,function(a){a&&a.code!=="EEXIST"?r(a):n._applyACLRules(t,r)}):!i&&s.isDirectory()?n._applyACLRules(t,r):r(i||new Error("Path existed but was not a directory"))})},e.prototype._getShallowDirectorySize=function(t,r){Tt.readdir(t,function(n,i){if(n)return r(n,-1);var s=null,a=0,o=0;if(i.length===0){r(null,0);return}for(var u=0;u<i.length;u++)Tt.stat(en.join(t,i[u]),function(c,l){o++,c?s=c:l.isFile()&&(a+=l.size),o===i.length&&(s?r(s,-1):r(s,a))})})},e.prototype._getShallowDirectorySizeSync=function(t){for(var r=Tt.readdirSync(t),n=0,i=0;i<r.length;i++)n+=Tt.statSync(en.join(t,r[i])).size;return n},e.prototype._storeToDisk=function(t){var r=this,n=en.join(hl.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);pt.info(e.TAG,"Checking existence of data storage directory: "+n),this._confirmDirExists(n,function(i){if(i){pt.warn(e.TAG,"Error while checking/creating directory: "+(i&&i.message)),r._onErrorHelper(i);return}r._getShallowDirectorySize(n,function(s,a){if(s||a<0){pt.warn(e.TAG,"Error while checking directory size: "+(s&&s.message)),r._onErrorHelper(s);return}else if(a>r._maxBytesOnDisk){pt.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+a);return}var o=new Date().getTime()+".ai.json",u=en.join(n,o);pt.info(e.TAG,"saving data to disk at: "+u),Tt.writeFile(u,t,{mode:384},function(c){return r._onErrorHelper(c)})})})},e.prototype._storeToDiskSync=function(t){var r=en.join(hl.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);try{pt.info(e.TAG,"Checking existence of data storage directory: "+r),Tt.existsSync(r)||Tt.mkdirSync(r),this._applyACLRulesSync(r);var n=this._getShallowDirectorySizeSync(r);if(n>this._maxBytesOnDisk){pt.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+n);return}var i=new Date().getTime()+".ai.json",s=en.join(r,i);pt.info(e.TAG,"saving data before crash to disk at: "+s),Tt.writeFileSync(s,t,{mode:384})}catch(a){pt.warn(e.TAG,"Error while saving data to disk: "+(a&&a.message)),this._onErrorHelper(a)}},e.prototype._sendFirstFileOnDisk=function(){var t=this,r=en.join(hl.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);Tt.exists(r,function(n){n&&Tt.readdir(r,function(i,s){if(i)t._onErrorHelper(i);else if(s=s.filter(function(u){return en.basename(u).indexOf(".ai.json")>-1}),s.length>0){var a=s[0],o=en.join(r,a);Tt.readFile(o,function(u,c){u?t._onErrorHelper(u):Tt.unlink(o,function(l){l?t._onErrorHelper(l):t.send(c)})})}})})},e.prototype._onErrorHelper=function(t){typeof this._onError=="function"&&this._onError(t)},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=60*1e3,e.MAX_BYTES_ON_DISK=50*1e3*1e3,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS=hl.type()==="Windows_NT",e}();Hw.exports=qH});var $w=d((a2,Uw)=>{"use strict";var O=qt(),Kt=Nt(),LH=Kn(),MH=function(){function e(){}return e.createEnvelope=function(t,r,n,i,s){var a=null;switch(r){case O.TelemetryType.Trace:a=e.createTraceData(t);break;case O.TelemetryType.Dependency:a=e.createDependencyData(t);break;case O.TelemetryType.Event:a=e.createEventData(t);break;case O.TelemetryType.Exception:a=e.createExceptionData(t);break;case O.TelemetryType.Request:a=e.createRequestData(t);break;case O.TelemetryType.Metric:a=e.createMetricData(t);break;case O.TelemetryType.Availability:a=e.createAvailabilityData(t);break;case O.TelemetryType.PageView:a=e.createPageViewData(t);break}if(n&&O.domainSupportsProperties(a.baseData)){if(a&&a.baseData)if(!a.baseData.properties)a.baseData.properties=n;else for(var o in n)a.baseData.properties[o]||(a.baseData.properties[o]=n[o]);a.baseData.properties=Kt.validateStringMap(a.baseData.properties)}var u=s&&s.instrumentationKey||"",c=new O.Envelope;return c.data=a,c.iKey=u,c.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),c.tags=this.getTags(i,t.tagOverrides),c.time=new Date().toISOString(),c.ver=1,c.sampleRate=s?s.samplingPercentage:100,r===O.TelemetryType.Metric&&(c.sampleRate=100),c},e.createTraceData=function(t){var r=new O.MessageData;r.message=t.message,r.properties=t.properties,isNaN(t.severity)?r.severityLevel=O.SeverityLevel.Information:r.severityLevel=t.severity;var n=new O.Data;return n.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Trace),n.baseData=r,n},e.createDependencyData=function(t){var r=new O.RemoteDependencyData;typeof t.name=="string"&&(r.name=t.name.length>1024?t.name.slice(0,1021)+"...":t.name),r.data=t.data,r.target=t.target,r.duration=Kt.msToTimeSpan(t.duration),r.success=t.success,r.type=t.dependencyTypeName,r.properties=t.properties,r.resultCode=t.resultCode?t.resultCode+"":"",t.id?r.id=t.id:r.id=Kt.w3cTraceId();var n=new O.Data;return n.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Dependency),n.baseData=r,n},e.createEventData=function(t){var r=new O.EventData;r.name=t.name,r.properties=t.properties,r.measurements=t.measurements;var n=new O.Data;return n.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Event),n.baseData=r,n},e.createExceptionData=function(t){var r=new O.ExceptionData;r.properties=t.properties,isNaN(t.severity)?r.severityLevel=O.SeverityLevel.Error:r.severityLevel=t.severity,r.measurements=t.measurements,r.exceptions=[];var n=t.exception.stack,i=new O.ExceptionDetails;i.message=t.exception.message,i.typeName=t.exception.name,i.parsedStack=this.parseStack(n),i.hasFullStack=Kt.isArray(i.parsedStack)&&i.parsedStack.length>0,r.exceptions.push(i);var s=new O.Data;return s.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Exception),s.baseData=r,s},e.createRequestData=function(t){var r=new O.RequestData;t.id?r.id=t.id:r.id=Kt.w3cTraceId(),r.name=t.name,r.url=t.url,r.source=t.source,r.duration=Kt.msToTimeSpan(t.duration),r.responseCode=t.resultCode?t.resultCode+"":"",r.success=t.success,r.properties=t.properties;var n=new O.Data;return n.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Request),n.baseData=r,n},e.createMetricData=function(t){var r=new O.MetricData;r.metrics=[];var n=new O.DataPoint;n.count=isNaN(t.count)?1:t.count,n.kind=O.DataPointType.Aggregation,n.max=isNaN(t.max)?t.value:t.max,n.min=isNaN(t.min)?t.value:t.min,n.name=t.name,n.stdDev=isNaN(t.stdDev)?0:t.stdDev,n.value=t.value,r.metrics.push(n),r.properties=t.properties;var i=new O.Data;return i.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Metric),i.baseData=r,i},e.createAvailabilityData=function(t){var r=new O.AvailabilityData;t.id?r.id=t.id:r.id=Kt.w3cTraceId(),r.name=t.name,r.duration=Kt.msToTimeSpan(t.duration),r.success=t.success,r.runLocation=t.runLocation,r.message=t.message,r.measurements=t.measurements,r.properties=t.properties;var n=new O.Data;return n.baseType=O.telemetryTypeToBaseType(O.TelemetryType.Availability),n.baseData=r,n},e.createPageViewData=function(t){var r=new O.PageViewData;r.name=t.name,r.duration=Kt.msToTimeSpan(t.duration),r.url=t.url,r.measurements=t.measurements,r.properties=t.properties;var n=new O.Data;return n.baseType=O.telemetryTypeToBaseType(O.TelemetryType.PageView),n.baseData=r,n},e.getTags=function(t,r){var n=LH.CorrelationContextManager.getCurrentContext(),i={};if(t&&t.tags)for(var s in t.tags)i[s]=t.tags[s];if(r)for(var s in r)i[s]=r[s];return n&&(i[t.keys.operationId]=i[t.keys.operationId]||n.operation.id,i[t.keys.operationName]=i[t.keys.operationName]||n.operation.name,i[t.keys.operationParentId]=i[t.keys.operationParentId]||n.operation.parentId),i},e.parseStack=function(t){var r=void 0;if(typeof t=="string"){var n=t.split(`
`);r=[];for(var i=0,s=0,a=0;a<=n.length;a++){var o=n[a];if(jw.regex.test(o)){var u=new jw(n[a],i++);s+=u.sizeInBytes,r.push(u)}}var c=32*1024;if(s>c)for(var l=0,f=r.length-1,p=0,h=l,v=f;l<f;){var T=r[l].sizeInBytes,S=r[f].sizeInBytes;if(p+=T+S,p>c){var x=v-h+1;r.splice(h,x);break}h=l,v=f,l++,f--}}return r},e}(),jw=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=Kt.trim(t);var n=t.match(e.regex);n&&n.length>=5&&(this.method=Kt.trim(n[2])||this.method,this.fileName=Kt.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();Uw.exports=MH});var zw=d((o2,Gw)=>{"use strict";var HH=require("url"),FH=fl(),jH=Oo(),tn=qt(),UH=Dw(),kv=Mw(),Vw=Kn(),$H=Fw(),VH=Nt(),Bw=Ke(),BH=$w(),GH=function(){function e(t){this._telemetryProcessors=[],this._enableAzureProperties=!1;var r=new FH(t);this.config=r,this.context=new jH,this.commonProperties={};var n=new $H(this.config);this.channel=new UH(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return e.prototype.trackAvailability=function(t){this.track(t,tn.TelemetryType.Availability)},e.prototype.trackPageView=function(t){this.track(t,tn.TelemetryType.PageView)},e.prototype.trackTrace=function(t){this.track(t,tn.TelemetryType.Trace)},e.prototype.trackMetric=function(t){this.track(t,tn.TelemetryType.Metric)},e.prototype.trackException=function(t){t&&t.exception&&!VH.isError(t.exception)&&(t.exception=new Error(t.exception.toString())),this.track(t,tn.TelemetryType.Exception)},e.prototype.trackEvent=function(t){this.track(t,tn.TelemetryType.Event)},e.prototype.trackRequest=function(t){this.track(t,tn.TelemetryType.Request)},e.prototype.trackDependency=function(t){t&&!t.target&&t.data&&(t.target=HH.parse(t.data).host),this.track(t,tn.TelemetryType.Dependency)},e.prototype.flush=function(t){this.channel.triggerSend(t?!!t.isAppCrashing:!1,t?t.callback:void 0)},e.prototype.track=function(t,r){if(t&&tn.telemetryTypeToBaseType(r)){var n=BH.createEnvelope(t,r,this.commonProperties,this.context,this.config);t.time&&(n.time=t.time.toISOString()),this._enableAzureProperties&&kv.azureRoleEnvironmentTelemetryProcessor(n,this.context);var i=this.runTelemetryProcessors(n,t.contextObjects);i=i&&kv.samplingTelemetryProcessor(n,{correlationContext:Vw.CorrelationContextManager.getCurrentContext()}),i&&(kv.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else Bw.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(t){this._enableAzureProperties=t},e.prototype.addTelemetryProcessor=function(t){this._telemetryProcessors.push(t)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(t,r){var n=!0,i=this._telemetryProcessors.length;if(i===0)return n;r=r||{},r.correlationContext=Vw.CorrelationContextManager.getCurrentContext();for(var s=0;s<i;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[t,r])===!1){n=!1;break}}catch(o){n=!0,Bw.warn("One of telemetry processors failed, telemetry item will be sent.",o,t)}return n},e}();Gw.exports=GH});var Ww=d((Ov,Xw)=>{"use strict";var zH=Ov&&Ov.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),QH=zw(),Qw=Cv(),XH=Gs(),vl=Ke(),WH=function(e){zH(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?Qw.trackRequestSync(this,r):vl.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&vl.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?Qw.trackRequest(this,r):vl.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(r){r&&r.request?XH.trackRequest(this,r):vl.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(QH);Xw.exports=WH});var Yw=d(Kw=>{"use strict";Object.defineProperty(Kw,"__esModule",{value:!0})});var mS=d(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var Nv=Kn(),KH=Db(),YH=Ob(),Zw=cl(),JH=sw(),ZH=Gs(),eF=Cv(),eS=ri(),Ho=Ke(),tF=Sw(),tS=Aw();D.TelemetryClient=Ww();D.Contracts=qt();D.azureFunctionsTypes=Yw();var rS;(function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C"})(rS=D.DistributedTracingModes||(D.DistributedTracingModes={}));var nS=!0,iS=!1,sS=!0,aS=!0,oS=!1,uS=!0,cS=!0,lS=!0,qv=!0,fS,gl=!1,pS=!0,dS,hS=void 0,vS=void 0,Fo,jo,Uo,$o,Qs,_i,Vo,rn=!1,Jw;function rF(e){return D.defaultClient?Ho.info("The default client is already setup"):(D.defaultClient=new D.TelemetryClient(e),Fo=new KH(D.defaultClient),jo=new YH(D.defaultClient),Uo=new Zw(D.defaultClient),$o=new JH(D.defaultClient),_i=new eF(D.defaultClient),Vo=new ZH(D.defaultClient),Qs||(Qs=new tS.AutoCollectNativePerformance(D.defaultClient))),D.defaultClient&&D.defaultClient.channel&&D.defaultClient.channel.setUseDiskRetryCaching(lS,hS,vS),Lv}D.setup=rF;function gS(){return D.defaultClient?(rn=!0,Fo.enable(nS,iS),jo.enable(sS),Uo.enable(aS),$o.enable(oS,D.defaultClient.config),Qs.enable(pS,dS),_i.useAutoCorrelation(qv,fS),_i.enable(uS),Vo.enable(cS),D.liveMetricsClient&&gl&&D.liveMetricsClient.enable(gl)):Ho.warn("Start cannot be called before setup"),Lv}D.start=gS;function nF(){return qv?Nv.CorrelationContextManager.getCurrentContext():null}D.getCorrelationContext=nF;function iF(e,t){return Nv.CorrelationContextManager.startOperation(e,t)}D.startOperation=iF;function sF(e,t){return Nv.CorrelationContextManager.wrapCallback(e,t)}D.wrapWithCorrelationContext=sF;var Lv=function(){function e(){}return e.setDistributedTracingMode=function(t){return eS.w3cEnabled=t===rS.AI_AND_W3C,e},e.setAutoCollectConsole=function(t,r){return r===void 0&&(r=!1),nS=t,iS=r,rn&&Fo.enable(t,r),e},e.setAutoCollectExceptions=function(t){return sS=t,rn&&jo.enable(t),e},e.setAutoCollectPerformance=function(t,r){r===void 0&&(r=!0),aS=t;var n=tS.AutoCollectNativePerformance.parseEnabled(r);return pS=n.isEnabled,dS=n.disabledMetrics,rn&&(Uo.enable(t),Qs.enable(n.isEnabled,n.disabledMetrics)),e},e.setAutoCollectHeartbeat=function(t){return oS=t,rn&&$o.enable(t,D.defaultClient.config),e},e.setAutoCollectRequests=function(t){return uS=t,rn&&_i.enable(t),e},e.setAutoCollectDependencies=function(t){return cS=t,rn&&Vo.enable(t),e},e.setAutoDependencyCorrelation=function(t,r){return qv=t,fS=r,rn&&_i.useAutoCorrelation(t,r),e},e.setUseDiskRetryCaching=function(t,r,n){return lS=t,hS=r,vS=n,D.defaultClient&&D.defaultClient.channel&&D.defaultClient.channel.setUseDiskRetryCaching(t,r,n),e},e.setInternalLogging=function(t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),Ho.enableDebug=t,Ho.disableWarnings=!r,e},e.setSendLiveMetrics=function(t){return t===void 0&&(t=!1),D.defaultClient?(!D.liveMetricsClient&&t?(D.liveMetricsClient=new tF(D.defaultClient.config.instrumentationKey),Jw=new Zw(D.liveMetricsClient,1e3,!0),D.liveMetricsClient.addCollector(Jw),D.defaultClient.quickPulseClient=D.liveMetricsClient):D.liveMetricsClient&&D.liveMetricsClient.enable(t),gl=t,e):(Ho.warn("Live metrics client cannot be setup without the default client"),e)},e.start=gS,e}();D.Configuration=Lv;function aF(){eS.w3cEnabled=!0,D.defaultClient=null,rn=!1,Fo&&Fo.dispose(),jo&&jo.dispose(),Uo&&Uo.dispose(),$o&&$o.dispose(),Qs&&Qs.dispose(),_i&&_i.dispose(),Vo&&Vo.dispose(),D.liveMetricsClient&&(D.liveMetricsClient.enable(!1),gl=!1,D.liveMetricsClient=void 0)}D.dispose=aF});var dF={};MS(dF,{activate:()=>fF,deactivate:()=>pF});module.exports=HS(dF);var CS=require("vscode");var Q=require("vscode");var Qo=require("fs"),In=require("vscode");var Bv=require("os"),jS=require("vscode"),US=Pr(Il()),zo;(t=>t.RequestCancelled=-32800)(zo||(zo={}));function bl(e){return e.map(t=>String.fromCharCode(t)).join("")}function wl(e=""){var t;try{return(t=(0,Bv.userInfo)().username)!=null?t:e}catch(r){return e}}var zv=require("vscode"),$S=Pr(Il());var Qv=require("fs");var Sl=class{constructor(){this.dictionary={};this.locale="en";try{if(process&&process.env){let t=JSON.parse(process.env.VSCODE_NLS_CONFIG);t&&typeof t.locale=="string"&&(this.locale=t.locale)}}catch(t){}}read_i18n(t){try{let r=Buffer.from((0,Qv.readFileSync)(t)).toString("utf-8");return JSON.parse(r)}catch(r){return{}}}localize(t){let r=this.dictionary[t];if(typeof r=="string")return r}load(t){try{this.dictionary=Object.assign({},this.read_i18n(t.asAbsolutePath("package.nls.json")),this.read_i18n(t.asAbsolutePath("package.nls.en.json")),this.read_i18n(t.asAbsolutePath(`package.nls.${this.locale}.json`)))}catch(r){}}},Xv=new Sl;function Wv(e){return w(this,null,function*(){yield Xv.load(e)})}function se(e,t){return VS(e,t)}function VS(e,t){var r,n;return(n=(r=Xv.localize(e))!=null?r:t)!=null?n:e}var hr=require("vscode");function dr(e,t,r){return{range:e,kind:t,value:r}}var Ge=class{constructor(){}clearCache(){this._cache=void 0}parse(t){let r;return this._cache&&this._cache.uri==t.uri&&this._cache.version==t.version?r=this._cache.value:(r=Ge.parseValue(this.tokenize(t)),this._cache={uri:t.uri,version:t.version,value:r}),r}static next(t){if(t){let r=t.next();if(r&&!r.done)return r.value}}static parseValue(t){let r=Ge.next(t);if(r){let n=r.range.end;switch(r.kind){case 8:case 9:case 10:case 6:return{range:r.range,value:r.value};case 2:let i=[],s=[];for(;;){let u=Ge.parseValue(t);if(u)i.push(u),s.push(u.value);else break;let c=Ge.next(t);if(c==null||(n=c.range.end,c.kind==3))break;if(c.kind==4)continue;break}return{range:new hr.Range(r.range.start,n),value:s,items:i};case 0:let a=[],o={};for(;;){let u=!1,c=Ge.next(t);if(c==null)break;for(n=c.range.end;;){let p=Ge.next(t);if(p==null||p.kind!=5){if(a.push({name:c,value:void 0}),o[c.value]=void 0,p&&p.kind==6){c=p;continue}u=!0;break}break}if(u)break;let l=Ge.parseValue(t);if(a.push({name:c,value:l}),o[c.value]=l==null?void 0:l.value,l==null)break;n=l.range.end;let f=Ge.next(t);if(f==null||(n=f.range.end,f.kind==1))break;if(f.kind!=4)break}return{properties:a,range:new hr.Range(r.range.start,n),value:o};default:break}}}traverse(t,r,n,i){return w(this,null,function*(){if(t==null)return;let s=yield Promise.resolve(r(t,i));if(typeof s!="undefined")return s;let a=t;if(Array.isArray(a.items)){let o=0;for(let u of a.items)if(s=yield this.traverse(u,r,n,`${i}[${o++}]`),typeof s!="undefined")return s}else if(a.properties)for(let o of a.properties){if(s=yield Promise.resolve(n(o.name,o.value,i)),typeof s!="undefined")return s;let u=i?`${i}.${o.name.value}`:o.name.value;if(s=yield this.traverse(o.value,r,n,u),typeof s!="undefined")return s}})}*tokenize(t){let r=t.getText();for(let n=0;n<r.length;){let i=r[n],s=t.positionAt(n),a=new hr.Range(s,new hr.Position(s.line,s.character+1));switch(i){case"{":yield dr(a,0);break;case"}":yield dr(a,1);break;case"[":yield dr(a,2);break;case"]":yield dr(a,3);break;case",":yield dr(a,4);break;case":":yield dr(a,5);break;case'"':let o=Ge.parseString(r,n);yield dr(new hr.Range(s,t.positionAt(o.end)),6,o.value),n=o.end;continue;default:if(i>="0"&&i<="9"||i=="-"){let c=Ge.parseNumber(r,n);if(c){yield dr(new hr.Range(s,t.positionAt(n+c.length)),7,c.value),n+=c.length;continue}}let u=Ge.tryParseLiteral(r,n);if(u){yield dr(new hr.Range(s,t.positionAt(n+u.length)),u.token,u.value),n+=u.length;continue}if(Ge.isIdentifierChar(i)){let c=Ge.parseIdentifier(r,n);if(c&&c.length>0){yield dr(new hr.Range(s,t.positionAt(n+c.length)),6,c.value),n+=c.length;continue}}break}n++}}static isIdentifierChar(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t=="\\"||t=="/"||t=="_"}static parseIdentifier(t,r){let n=r;for(;r<t.length&&Ge.isIdentifierChar(t[r]);r++);return{start:n,end:r,length:r-n,value:t.substring(n,r)}}static tryParseLiteral(t,r){let n={null:[null,8],true:[!0,9],false:[!1,10]},i=t[r];for(let s in n)if(i==s[0]&&t.substring(r).match(`/^${s}/i`))return{length:s.length,value:n[s][0],token:n[s][1]}}static parseNumber(t,r){let n=t.substring(r).match(/^-?[0-9]*(\.[0-9]*)?([eE][+\-]?[0-9]+)?/i);if(n){let i=n[0],s;return i.includes(".")||i.includes("e")||i.includes("E")?s=parseFloat(i):s=parseInt(i),{value:s,length:i.length}}}static parseString(t,r){let n=r,i=!1,s="",a=!1;for(r++;r<t.length&&!a;r++){let o=t[r];if(i){switch(o){case"b":s+="\b";break;case"f":s+="\f";break;case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"u":let u=t.substring(r+1).match(/^[0-9a-z]{1,4}/i);u?s+=String.fromCodePoint(parseInt(u[0],16)):s+="u";break;default:s+=o;break}i=!1}else switch(o){case"\\":i=!0;break;case'"':a=!0;break;default:s+=o;break}}return{value:s,start:n,end:r}}};var Dt=class extends Ge{constructor(){super()}static parseComposerJson(t){return w(this,null,function*(){if(t&&(0,Qo.existsSync)(t.fsPath))try{let r=yield In.workspace.fs.readFile(t);if(r&&r.length!=0)return JSON.parse(Buffer.from(r).toString("utf-8"))}catch(r){}})}static parseComposerLock(t){return w(this,null,function*(){let r=In.Uri.joinPath(t,"..","composer.lock");if((0,Qo.existsSync)(r.fsPath))try{let n=yield In.workspace.fs.readFile(r);if(n&&n.length!=0)return JSON.parse(Buffer.from(n).toString("utf-8"))}catch(n){}})}static parseComposerInstalledJson(t){return w(this,null,function*(){let r=In.Uri.joinPath(t,"..","vendor/composer/installed.json");if((0,Qo.existsSync)(r.fsPath))try{let n=yield In.workspace.fs.readFile(r);if(n&&n.length!=0)return JSON.parse(Buffer.from(n).toString("utf-8"))}catch(n){}})}static parsePackagesMeta(t){let r={};if(t)for(let n of["packages","packages-dev"]){let i=t[n];Array.isArray(i)&&i.forEach(s=>{s.name&&(r[s.name]=s)})}return r}resolvePackagesMeta(t){return w(this,null,function*(){let r={};return r=Object.assign(r,Dt.parsePackagesMeta(yield Dt.parseComposerLock(t))),r=Object.assign(r,Dt.parsePackagesMeta(yield Dt.parseComposerInstalledJson(t))),r})}},wi=new Dt;var Qu=Pr(DE()),_r=require("vscode");var Xu=require("fs");var nC=Pr(eC()),iC=require("path"),zu=Pr(wt());var Hk=[101,56,52,97,53,57,53,55,45,100,54,56,48,45,52,99,99,53,45,57,50,54,55,45,53,101,53,101,51,100,48,97,56,100,53,55],Lp=class{constructor(t){this.client=t;Qu.Configuration.setAutoCollectExceptions(!0).setUseDiskRetryCaching(!0).setAutoCollectConsole(!0,!0).setInternalLogging(!0,!0)}init(t,r){let n=jk(t),i=wl();this.client.context.tags["ai.device.model"]=`Visual Studio Code ${_r.version}`,this.client.context.tags["ai.user.id"]=i,this.client.context.tags["ai.user.accountId"]=rC()(i).toString(),this.client.context.tags["ai.session.id"]=nC.v1(),this.client.context.tags["ai.application.ver"]=n.version,this.client.commonProperties=Object.bind(this.client.commonProperties,r,{"process.platform":process.platform,"process.arch":process.arch,"extension.id":t.extension.id});for(let s in n)this.client.commonProperties["server."+s]=n[s];this.track("extension loaded",{"copilot.enabled":qp("github.copilot"),"phptools.enabled":qp("devsense.phptools-vscode"),"intelephense.enabled":qp("bmewburn.vscode-intelephense-client")})}track(t,r,n){if(!_r.env.isTelemetryEnabled||!this.client)return;let i={name:t,properties:Object.bind({},r)};n&&(i.measurements=n),this.client.trackEvent(i)}metric(t,r,n,i,s,a){this.client.trackMetric({name:t,value:r,count:n,min:i,max:s,stdDev:a})}error(t,r,n){if(n=Object.bind({},n),!_r.env.isTelemetryEnabled){var i=_r.workspace.getConfiguration().get("telemetry.telemetryLevel");if(i!="error"&&(i!="crash"||r!="critical"))return}t.code&&t.code==zo.RequestCancelled||this.client.trackException({exception:t,severity:r=="critical"?zu.SeverityLevel.Critical:r=="error"?zu.SeverityLevel.Error:zu.SeverityLevel.Warning,properties:n})}},sC=new Lp(new Qu.TelemetryClient(bl(Hk)));function Fk(e){let t="out/server/version.json";return e?e.asAbsolutePath(t):(0,iC.join)(__filename,"../../..",t)}function jk(e){let t=Fk(e);try{if((0,Xu.existsSync)(t))return JSON.parse((0,Xu.readFileSync)(t,"utf8"))||{}}catch(n){}let r=e.extension.packageJSON.version;return{target:`${process.platform}-${process.arch}`,version:r}}function qp(e){return _r.extensions.getExtension(e)!==void 0}var ve=class{static get commands_download_title(){return se("commands.download.title")}static get action_open_folder(){return se("action.open-folder")}static get commands_search_title(){return se("commands.search.title")}static get error_couldntGetComposer(){return se("error.couldntGetComposer")}static get codelens_update(){return se("codelens.update")}static get error_missingComposerLock(){return se("error.missingComposerLock")}static get action_choose_folder(){return se("action.choose-folder")}static get title(){return se("title")}static get composer_inlayVersionEnabled_description(){return se("composer.inlayVersionEnabled.description")}static get composer_diagnosticsEnabled_description(){return se("composer.diagnosticsEnabled.description")}static get description(){return se("description")}static get capabilities_virtualWorkspaces_description(){return se("capabilities.virtualWorkspaces.description")}static get action_install(){return se("action.install")}static get capabilities_untrustedWorkspaces_description(){return se("capabilities.untrustedWorkspaces.description")}static get action_dontshowagain(){return se("action.dontshowagain")}static get task_composer_args_description(){return se("task.composer.args.description")}static get task_composer_command_description(){return se("task.composer.command.description")}static get composer_workingPath_description(){return se("composer.workingPath.description")}static get action_remove(){return se("action.remove")}static get authors(){return se("authors")}static get composer_bin_description(){return se("composer.bin.description")}static get codelens_check(){return se("codelens.check")}static get error_nonEmptyFolder(){return se("error.nonEmptyFolder")}static get codelens_install(){return se("codelens.install")}static get open_folder_title(){return se("open-folder.title")}static get action_update(){return se("action.update")}static get installed_version(){return se("installed_version")}static get abandoned(){return se("abandoned")}static get action_dismiss(){return se("action.dismiss")}};var aC=require("fs");function oC(e,t){return w(this,null,function*(){let r=yield new Promise(n=>{(0,aC.writeFile)(e,t,i=>{n(i)})});if(r)throw r})}var Xe=class{constructor(){this.disposables=[]}push(t){this.disposables.push(t)}onDispose(){}dispose(){try{this.onDispose()}catch(t){}for(let t of this.disposables)t.dispose();this.disposables=[]}};var uC=require("fs");function cC(e){return new Promise((t,r)=>{(0,uC.readdir)(e,(n,i)=>{n?t(!0):i&&i.length!=0?t(!1):t(!0)})})}var Mp=require("vscode");function lC(e){return e==null?!1:Mp.tasks.taskExecutions.includes(e)==!1?!0:new Promise(t=>{let r=Mp.tasks.onDidEndTask(n=>{n.execution==e&&(r.dispose(),t(!0))})})}var ja=require("vscode");function Ua(e){var t=ja.workspace.getConfiguration(null,e).get("composer.workingPath","");return t&&t!=""&&t!="."?ja.Uri.joinPath(e,t):e}function fC(){var e=ja.workspace.getConfiguration(null).get("composer.bin","");if(typeof e=="string"&&e!="")return e}var Hp=class extends Xe{constructor(r,n){super();this.taskProvider=r;this.packagist=n;this.parser=wi}registerCommand(r,n,i){this.push(Q.commands.registerCommand(r,(...s)=>w(this,null,function*(){let a;if(n&&(n.requiresCwd||n.requiresComposerJson)&&(a=yield this.pickCwd(s,n&&n.requiresComposerJson,n&&n.enableOpenFolder),typeof a=="undefined"))return!1;s&&s.length!=0&&typeof s[0]=="string"&&s[0].endsWith("composer.json")&&s.shift(),i(a,...s)})))}QuickPickPackage(r,n,i){return new Promise(s=>{let a=Q.window.createQuickPick(),o="require",u="packagist.org";a.canSelectMany=!1,a.title=r!=null?r:"Search package to install ...",a.placeholder=n!=null?n:"package name",a.items=[],a.onDidAccept(c=>w(this,null,function*(){let l=a.selectedItems&&a.selectedItems.length!=0?a.selectedItems[0].label:a.value.trim();s(l),a.hide()})),a.onDidHide(c=>s(void 0)),a.onDidChangeValue(c=>w(this,null,function*(){let l=i?[{tooltip:o,iconPath:new Q.ThemeIcon("cloud-download")},{tooltip:u,iconPath:new Q.ThemeIcon("link-external")}]:void 0,f=yield this.packagist.search(c.trim());if(a.value==c&&f&&Array.isArray(f.results)){let p=[];f.results.forEach(h=>{var S,x;let v=(S=h.downloads)!=null?S:0,T=(x=h.favers)!=null?x:0;p.push({label:h.name,description:`    $(extensions-install-count) ${v.toLocaleString("en-US",{maximumFractionDigits:0})}  $(star-full) ${T.toLocaleString("en-US",{maximumFractionDigits:0})}`,detail:h.description,buttons:l})}),a.items=p}})),a.onDidTriggerItemButton(c=>w(this,null,function*(){switch(c.button.tooltip){case o:yield this.taskProvider.executeComposerTask("require",[c.item.label],void 0);break;case u:let l=`https://packagist.org/packages/${c.item.label}`;yield Q.env.openExternal(Q.Uri.parse(l));break}})),a.show()})}pickCwd(r,n,i){return w(this,null,function*(){if(r&&r.length>=1&&typeof r[0]=="string"&&r[0].endsWith("composer.json"))return Q.Uri.joinPath(Q.Uri.parse(r[0]),"..").fsPath;let s=Q.workspace.workspaceFolders;if(s){if(s.length==1)return Ua(s[0].uri).fsPath;if(s.length>1){let a=yield Q.window.showWorkspaceFolderPick({placeHolder:"Select the command's working directory ..."});if(a)return Ua(a.uri).fsPath}return}if(i){let a=yield Q.window.showOpenDialog({canSelectMany:!1,canSelectFiles:!1,canSelectFolders:!0,openLabel:ve.action_choose_folder});return a&&a.length==1?a[0].fsPath:void 0}if(Q.window.activeTextEditor){let a=Q.Uri.joinPath(Q.window.activeTextEditor.document.uri,"..");if(a.scheme=="file")return a.fsPath}})}pickInstalledPackage(r,n,i){return w(this,null,function*(){var f,p;let s=Q.Uri.joinPath(Q.Uri.file(r),"composer.json"),a=yield Dt.parseComposerJson(s),o=[],u="(dev) ";if(a){let h=(v,T,S)=>{v!="php"&&!v.startsWith("ext-")&&o.push({label:v,description:`${S?u:""}${T}`})};for(let v in(f=a.require)!=null?f:{})h(v,a.require[v],!1);for(let v in(p=a["require-dev"])!=null?p:{})h(v,a["require-dev"][v],!0)}let c=h=>({pkgname:h.label,dev:h.description.startsWith(u)}),l=yield Q.window.showQuickPick(o,{canPickMany:i!=null?i:!1,title:n!=null?n:"",placeHolder:"Package name"});return l?Array.isArray(l)?l.map(h=>c(h)):[c(l)]:[]})}},Wu=class extends Hp{constructor(t,r,n){super(r,n),this.registerCommand("composer.install",{requiresComposerJson:!0},(i,...s)=>w(this,null,function*(){return yield r.executeComposerTask("install",s,i)})),this.registerCommand("composer.update",{requiresComposerJson:!0},(i,...s)=>w(this,null,function*(){return yield r.executeComposerTask("update",s,i)})),this.registerCommand("composer.remove",{requiresComposerJson:!0},(i,...s)=>w(this,null,function*(){if(s.length==0){let a=yield this.pickInstalledPackage(i,"Select package to remove",!0),o=a.filter(c=>c.dev).map(c=>c.pkgname),u=a.filter(c=>!c.dev).map(c=>c.pkgname);o.length!=0&&(yield r.executeComposerTask("remove",[...o,"--dev"],i)),u.length!=0&&(yield r.executeComposerTask("remove",u,i))}else return yield r.executeComposerTask("remove",s,i)})),this.registerCommand("composer.create-project",{requiresCwd:!0,enableOpenFolder:!0},(i,...s)=>w(this,null,function*(){if(t.appendLine(`Project will be created in '${i}' ...`),!(yield cC(i)))throw t.appendLine(ve.error_nonEmptyFolder),Q.window.showErrorMessage(ve.error_nonEmptyFolder),new Error(ve.error_nonEmptyFolder);let a=s.length?s[0]:yield this.QuickPickPackage();if(a){t.appendLine(`About to create project from package '${a}' ...`);let o=yield this.taskProvider.executeComposerTask("create-project",[a,"."],i);Q.workspace.workspaceFolders||(yield lC(o),(yield Q.window.showInformationMessage(`${ve.open_folder_title} (${i})`,ve.action_open_folder,ve.action_dismiss))==ve.action_open_folder&&(yield Q.commands.executeCommand("vscode.openFolder",Q.Uri.file(i))))}})),this.registerCommand("composer.require",{requiresCwd:!0},(i,...s)=>w(this,null,function*(){let a=s.length?s[0]:yield this.QuickPickPackage();a&&(yield this.taskProvider.executeComposerTask("require",[a],i))})),this.registerCommand("composer.require-dev",{requiresCwd:!0},(i,...s)=>w(this,null,function*(){let a=s.length?s[0]:yield this.QuickPickPackage();a&&(yield this.taskProvider.executeComposerTask("require",[a,"--dev"],i))})),this.registerCommand("composer.run-script",{requiresComposerJson:!0},(i,...s)=>w(this,null,function*(){let a;if(s&&s.length>0)a=s[0];else{let o=Q.Uri.joinPath(Q.Uri.file(i),"composer.json"),u=yield Dt.parseComposerJson(o);if(u&&typeof u.scripts=="object"){let c=[];for(let l in u.scripts)c.push(l);a=yield Q.window.showQuickPick(c,{title:"Select script to run ...",placeHolder:"script name"})}else{Q.window.showErrorMessage(`'${"composer.json"}' could not be parsed`);return}}a&&(yield this.taskProvider.executeComposerTask("run-script",[a],i))})),this.registerCommand("composer.search",{},(i,...s)=>w(this,null,function*(){let a=yield this.QuickPickPackage("Search packages ...","filter",!0);if(a){let o=`https://packagist.org/packages/${a}`;yield Q.env.openExternal(Q.Uri.parse(o))}})),this.registerCommand("composer.about",{},()=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("about")})),this.registerCommand("composer.archive",{requiresCwd:!0},i=>w(this,null,function*(){let s=yield Q.window.showInputBox({placeHolder:"[package] [version] --format=tar",title:"Create package archive.",prompt:'"composer archive" options'});typeof s!="undefined"&&(yield this.taskProvider.executeComposerTask("archive",s?s.split(" "):[],i))})),this.registerCommand("composer.clear-cache",{},()=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("clear-cache")})),this.registerCommand("composer.fund",{requiresComposerJson:!0},i=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("fund",[],i)})),this.registerCommand("composer.check-platform-reqs",{requiresComposerJson:!0},i=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("check-platform-reqs",[],i)})),this.registerCommand("composer.licenses",{requiresComposerJson:!0},i=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("licenses",[],i)})),this.registerCommand("composer.outdated",{requiresComposerJson:!0},i=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("outdated",[],i)})),this.registerCommand("composer.reinstall",{requiresComposerJson:!0},i=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("reinstall",[],i)})),this.registerCommand("composer.show-tree",{requiresComposerJson:!0},i=>w(this,null,function*(){return yield this.taskProvider.executeComposerTask("show",["--tree"],i)}))}};var le=require("vscode");function pC(e){return e&&(e.path.endsWith("composer.json")||e.path.endsWith("composer.lock"))}var Uk=-99999;function $k(e,t){let r=[...t.matchAll(/\r?\n/g)];return{uri:e,version:Uk++,getText:()=>t,positionAt:n=>{let i=new le.Position(0,n);if(r){let s=0;for(let a of r){let o=a.index+a.length;if(o<=n)i=new le.Position(++s,n-o);else break}}return i}}}var Ku=class extends Xe{constructor(){super();this.parser=wi;this.documents=new Map;this.timeouts=new Map;this.push(this.collection=le.languages.createDiagnosticCollection("Composer"));let r;this.push(r=le.workspace.createFileSystemWatcher("**/composer.*")),this.push(le.workspace.onDidOpenTextDocument(n=>this.updateFromDocument(n))),this.push(le.workspace.onDidChangeTextDocument(n=>this.updateFromDocument(n.document))),this.push(le.workspace.onDidCloseTextDocument(n=>this.updateFromFs(n.uri))),this.push(le.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("composer.diagnosticsEnabled")})),r.onDidChange(n=>this.updateFromFs(n)),r.onDidDelete(n=>this.updateFromFs(n)),r.onDidCreate(n=>this.updateFromFs(n)),le.workspace.workspaceFolders&&le.workspace.workspaceFolders.forEach(n=>w(this,null,function*(){yield this.updateFromFs(le.Uri.joinPath(n.uri,"composer.json")),yield this.updateFromFs(le.Uri.joinPath(n.uri,"composer.lock")),yield this.update(n.uri)}))}updateFromFs(r){return w(this,null,function*(){if(pC(r)){this.documents.delete(r.toString(!0));try{let n=yield le.workspace.fs.readFile(r);n&&n.length&&this.documents.set(r.toString(!0),$k(r,Buffer.from(n).toString("utf-8")))}catch(n){}yield this.setDirty(le.Uri.joinPath(r,".."))}})}updateFromDocument(r){return w(this,null,function*(){pC(r.uri)&&(this.documents.set(r.uri.toString(!0),r),yield this.setDirty(le.Uri.joinPath(r.uri,"..")))})}setDirty(r){return w(this,null,function*(){let n=r.toString(!0),i=this.timeouts.get(n);i?i.refresh():this.timeouts.set(n,setTimeout(()=>w(this,null,function*(){this.timeouts.delete(n),yield this.update(r)}),500))})}update(r){return w(this,null,function*(){let n=le.Uri.joinPath(r,"composer.json"),i=le.Uri.joinPath(r,"composer.lock"),s=this.documents.get(n.toString(!0)),a=this.documents.get(i.toString(!0)),o=[];if(s&&a&&le.workspace.getConfiguration().get("composer.diagnosticsEnabled",!0)!=!1){let u=Dt.parsePackagesMeta(JSON.parse(a.getText())),c=this.parser.parse(s);yield this.parser.traverse(c,(l,f)=>{},(l,f,p)=>{if(typeof l.value=="string"&&(p=="require"||p=="require-dev")){let h=u[l.value];if(h&&h.abandoned){let v=new le.Diagnostic(l.range,`'${l.value}' has been abandoned.`,le.DiagnosticSeverity.Warning);v.source="Composer",v.code="abandoned",v.tags=[le.DiagnosticTag.Deprecated],o.push(v)}}})}o.length?this.collection.set(n,o):this.collection.delete(n)})}};var H=require("vscode");var $a={scheme:"file",language:"json",pattern:"**/composer.json"},Bn=class extends Xe{constructor(r,n){super();this.taskProvider=r;this.packagist=n;this.parser=wi;this.push(this.onDidChangeCodeLensesEmitter=new H.EventEmitter),this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.push(this.onDidChangeInlayHintsEmitter=new H.EventEmitter),this.onDidChangeInlayHints=this.onDidChangeInlayHintsEmitter.event,this.push(H.languages.registerHoverProvider($a,this)),this.push(H.languages.registerInlayHintsProvider($a,this)),this.push(H.languages.registerCodeLensProvider($a,this)),this.push(H.languages.registerCompletionItemProvider($a,this,":",'"')),this.push(H.languages.registerCodeActionsProvider($a,this,{})),this.push(H.workspace.onDidChangeConfiguration(s=>{s.affectsConfiguration("composer.inlayVersionEnabled")&&this.onDidChangeInlayHintsEmitter.fire()}));let i;this.push(i=H.workspace.createFileSystemWatcher("**/composer.lock")),i.onDidDelete(s=>this.onDidChangeInlayHintsEmitter.fire()),i.onDidCreate(s=>this.onDidChangeInlayHintsEmitter.fire()),i.onDidChange(s=>this.onDidChangeInlayHintsEmitter.fire())}provideCodeActions(r,n,i,s){return w(this,null,function*(){let a=[],o=this.parser.parse(r);return yield this.parser.traverse(o,u=>{},(u,c,l)=>w(this,null,function*(){if((l=="require"||l=="require-dev")&&(n.intersection(u.range)||c&&c.range.intersection(n))){if(u.value=="php"||u.value.startsWith("ext-"))return;let f=l=="require-dev";(yield this.parser.resolvePackagesMeta(r.uri))[u.value]==null&&a.push({command:f?"composer.require-dev":"composer.require",title:`require "${u.value}"${f?" --dev":""}`,tooltip:"",arguments:[r.uri.toString(!0),u.value]}),a.push({command:"composer.update",title:`${ve.action_update} "${u.value}"`,tooltip:"",arguments:[r.uri.toString(!0),u.value]}),a.push({command:"composer.remove",title:`${ve.action_remove} "${u.value}"`,tooltip:"",arguments:[r.uri.toString(!0),u.value,f?"--dev":""]})}})),a})}provideCompletionForVersions(r,n){return w(this,null,function*(){let i=yield this.packagist.packageData(n),s=i!=null&&i.packages?i.packages[n]:void 0,a=[];if(Array.isArray(s)&&s.length){let o=new Set;a=s.filter(u=>u.version_normalized).map((u,c)=>{let l=u.version_normalized.split("."),f=l&&l.length>=2?new H.CompletionItem(`"^${l[0]}.${l[1]}"`):new H.CompletionItem(`"${u.version}"`);return f.range=r,f.filterText=` ${f.label}`,f.sortText=c.toString().padStart(8,"0"),f}).filter(u=>typeof u.label=="string"&&!o.has(u.label)&&o.add(u.label))}return{items:a,isIncomplete:!1}})}provideCompletionItems(r,n,i,s){return w(this,null,function*(){let a=this.parser.parse(r);return yield this.parser.traverse(a,o=>{},(o,u,c)=>w(this,null,function*(){var l;if(c=="require"||c=="require-dev"){if(o.range.contains(n)&&typeof o.value=="string"){let f=o.value.trim();if(f.length==0)return;let p=[],h=(l=r.getWordRangeAtPosition(n))!=null?l:new H.Range(n,n),v=yield this.packagist.search(f);return v&&v.results&&v.results.forEach(T=>{let S=new H.CompletionItem(T.name,H.CompletionItemKind.Reference);S.detail=T.description,S.documentation=Bn.descriptionForPackage(T,!1,!0,!0),S.insertText=`"${T.name}"`,T.abandoned&&(S.tags=[H.CompletionItemTag.Deprecated]),S.commitCharacters=[":",'"'," "],S.additionalTextEdits=[H.TextEdit.delete(o.range.with({end:h.start})),H.TextEdit.delete(o.range.with({start:h.end}))],p.push(S)}),{items:p,isIncomplete:!0}}if(u&&u.range.contains(n))return yield this.provideCompletionForVersions(u.range,o.value);if(o.range.end.line==n.line&&o.range.end.character<n.character&&r.getText(new H.Range(o.range.end,n)).trim()==":")return yield this.provideCompletionForVersions(new H.Range(n,n),o.value)}}))})}provideCodeLenses(r,n){return w(this,null,function*(){let i=[],s=new H.Range(0,0,0,0);i.push(new H.CodeLens(s,{title:`$(desktop-download) ${ve.codelens_install}`,tooltip:"composer install",command:"composer.install",arguments:[r.uri.toString(!1)]}),new H.CodeLens(s,{title:`$(refresh) ${ve.codelens_update}`,tooltip:"composer update",command:"composer.update",arguments:[r.uri.toString(!1)]}),new H.CodeLens(s,{title:`$(check) ${ve.codelens_check}`,tooltip:"composer check-platform-reqs",command:"composer.check-platform-reqs",arguments:[r.uri.toString(!1)]}));let a=this.parser.parse(r);return yield this.parser.traverse(a,o=>{},(o,u,c)=>{c=="scripts"&&typeof o.value=="string"&&i.push(new H.CodeLens(o.range,{title:"$(run) Run",tooltip:`Run the script '${o.value}'`,command:"composer.run-script",arguments:[r.uri.toString(!1),o.value]}))}),i})}provideInlayHints(r,n,i){return w(this,null,function*(){let s=[];if(H.workspace.getConfiguration().get("composer.inlayVersionEnabled",!0)==!1)return s;let a=yield this.parser.resolvePackagesMeta(r.uri),o=this.parser.parse(r);return yield this.parser.traverse(o,u=>{},(u,c,l)=>{if((l=="require"||l=="require-dev")&&n.contains(u.range)&&c){let f=a[u.value];if(f&&f.version){let p=new H.InlayHintLabelPart(`(${f.version})`);p.tooltip=`${ve.installed_version}`;let h=new H.InlayHint(c.range.end,[p],H.InlayHintKind.Type);h.paddingLeft=!0,h.textEdits=[],s.push(h)}}}),s})}static descriptionForPackage(r,n,i,s){var a,o;if(r&&r.name){let u=new H.MarkdownString("",!0);u.supportHtml=!0;let c=[],l="";if(r.version&&(l=`_(${r.version})_`),u.appendMarkdown(`**${r.name}** ${l}

`),r.authors&&Array.isArray(r.authors)){let f=r.authors.map(p=>`$(person) ${p.name}`).filter(p=>p).join(", ");f&&u.appendMarkdown(`**${ve.authors}:** ${f}<br/>`)}if(r.abandoned&&u.appendMarkdown(`$(stop) **${ve.abandoned}** ${r.abandoned}<br/>`),i&&typeof r.downloads=="number"&&u.appendMarkdown(`$(extensions-install-count) ${r.downloads.toLocaleString("en-US",{maximumFractionDigits:0})}<br/>`),s&&typeof r.favers=="number"&&u.appendMarkdown(`$(star-full) ${r.favers.toLocaleString("en-US",{maximumFractionDigits:0})}<br/>`),u.appendMarkdown(`

`),(typeof n=="undefined"||n)&&u.appendMarkdown(`${(a=r.description)!=null?a:""}

`),c.push(`[Packagist](https://packagist.org/packages/${r.name})`),(o=r.source)!=null&&o.url){let f=r.source.url,p="Source",h=f.replace(/\.git$/,"");c.push(`[${p}](${h})`)}return r.homepage&&c.push(`[Homepage](${r.homepage})`),u.appendMarkdown(c.join(" | ")),u}}provideHover(r,n,i){return w(this,null,function*(){let s=yield this.parser.resolvePackagesMeta(r.uri),a=this.parser.parse(r);return yield this.parser.traverse(a,o=>{},(o,u,c)=>{if((c=="require"||c=="require-dev")&&o.range.contains(n)){let l=s[o.value];if(l&&l.name)return new H.Hover(Bn.descriptionForPackage(l),o.range)}})})}};var jp=require("fs"),Er=require("vscode");var dC="composer.lock.check",Yu=class extends Xe{constructor(r,n){super();this.context=r;this.taskprovider=n;if(this.enabled){let i;this.push(Er.workspace.onDidChangeWorkspaceFolders(s=>this.updateFolders(s.added))),this.push(i=Er.workspace.createFileSystemWatcher("**/composer.lock",!0,!0,!1)),i.onDidDelete(s=>w(this,null,function*(){s.fsPath.endsWith("composer.lock")&&(yield this.updateFolder(Er.workspace.getWorkspaceFolder(s)))})),this.updateFolders(Er.workspace.workspaceFolders)}}updateFolders(r){r&&r.length!=0&&r.forEach(n=>this.updateFolder(n))}updateFolder(r){return w(this,null,function*(){if(!r||!r.uri||r.uri.scheme!="file")return;let n=Er.Uri.joinPath(r.uri,"composer.json"),i=Er.Uri.joinPath(r.uri,"composer.lock");try{(0,jp.existsSync)(n.fsPath)&&!(0,jp.existsSync)(i.fsPath)&&(yield this.popup(r))}catch(s){}})}get enabled(){return this.context.globalState.get(dC,!0)!=!1}set enabled(r){this.context.globalState.update(dC,r)}popup(r){return w(this,null,function*(){if(!r&&r.uri.scheme!="file"||!this.enabled)return;let n=ve.action_install,i=ve.action_dontshowagain,s=yield Er.window.showWarningMessage(ve.error_missingComposerLock,n,i);s==n?yield this.taskprovider.executeComposerTask("install",[],Ua(r.uri).fsPath):s==i&&(this.enabled=!1)})}};var Vt=require("fs"),fn=require("process"),Xn=require("vscode");var QC=Pr(require("https")),XC=require("url");var GC=require("url"),SO=FC(),xO=BC();function AO(e){return e.protocol==="http:"?process.env.HTTP_PROXY||process.env.http_proxy||null:e.protocol==="https:"&&(process.env.HTTPS_PROXY||process.env.https_proxy||process.env.HTTP_PROXY||process.env.http_proxy)||null}function zC(e,t,r){let n=t||AO(e);if(!n)return null;let i=(0,GC.parse)(n);if(!/^https?:$/.test(i.protocol))return null;let s={host:i.hostname,port:Number(i.port),auth:i.auth,rejectUnauthorized:RO(r)?r:!0};return e.protocol==="http:"?new SO(s):new xO(s)}function RO(e){return e===!0||e===!1}function WC(e,t,r,n,i){return w(this,null,function*(){t.appendLine("Downloading "+e+" ..."),t.appendLine("  URL: "+n);try{return Yp(e,n,t,r).then(s=>(t.appendLine("OK."),s))}catch(s){if(i){t.appendLine(`
  Alternative URL: `+i);try{let a=yield Yp(e,i,t,r);return t.appendLine("OK."),a}catch(a){throw s}}else throw s}})}function Yp(e,t,r,n){return w(this,null,function*(){let i=(0,XC.parse)(t),s=n(),a=s.proxy,o=s.strictSSL,u={host:i.hostname,path:i.path,agent:zC(i,a,o),port:i.port,timeout:15*60*1e3,rejectUnauthorized:PO(o)?o:!0},c=[];return new Promise((l,f)=>{let p=QC.request(u,h=>{if(h.statusCode===301||h.statusCode===302)return r.appendLine(`
  Redirect: ${h.headers.location}`),l(Yp(e,h.headers.location,r,n));if(h.statusCode!=200)return r.appendLine(`
  Download failure: status code '${h.statusCode}'`),f(new Error(h.statusCode.toString()));let v=parseInt(h.headers["content-length"]),T=0,S=0,x=`  Downloading (${Math.floor(v/1024)}kB):`;r.append(x),h.on("data",m=>{T+=m.length,c.push(m);let A=Math.ceil(x.length*(T/v));for(;S<A;)r.append("."),S++}),h.on("end",()=>{l(Buffer.concat(c))}),h.on("error",m=>{f(new Error(`Failed to download from ${t}. Error Message: ${m.message} || 'NONE'}`))})});p.on("error",h=>{r.appendLine(`
  Error: ${h.message}`),f(new Error(`Request error: ${h.message||"NONE"}`))}),p.end()})})}function PO(e){return e===!0||e===!1}var KC=require("vscode"),tc=class{constructor(t,r){this.proxy=t;this.strictSSL=r}};function YC(){return()=>{let e=KC.workspace.getConfiguration(),t=e.get("http.proxy"),r=e.get("http.proxyStrictSSL",!0);return new tc(t,r)}}var e0=require("path");var DO=["/usr/bin/composer","/usr/local/bin/composer"],JC="latest.phar.timestamp",kO=30*24*60*60;function ZC(){return Date.now()/1e3}var rc=class extends Xe{constructor(r,n){super();this.context=r;this.log=n;Xn.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("composer.bin")&&this.updatePath()}),Xn.commands.registerCommand("composer.download",()=>w(this,null,function*(){return yield this.getOrDownloadComposerPhar(!0)})),this.updatePath().then(i=>{i.userbin!=!0&&this.tryUpdate()})}getUserDir(){let r=fn.platform=="win32"?"APPDATA":"HOME",n=fn.env[r];if(n)return n.replace("\\","/").trim()}getHomeDir(){var s,a;let r=fn.env["COMPOSER_HOME"];if(r)return r.trim();let n=this.getUserDir();if(n==null)return;if(fn.platform=="win32")return`${n}/Composer`;let i=[];if((0,Vt.existsSync)("/etc/xdg")){let o=(s=fn.env.XDG_CONFIG_HOME)!=null?s:`${n}/.config`;i.push(`${o}/composer`)}return i.push(`${n}/.composer`),(a=i.find(o=>(0,Vt.existsSync)(o)))!=null?a:i[0]}getComposerHome(){let r=this.getHomeDir();if(r==null||!r){this.log.appendLine(`Cannot determine composer home directory. Please set '${"COMPOSER_HOME"}' environment variable.`);return}if(r=r.replaceAll("\\","/").trim(),(0,Vt.existsSync)(r))try{(0,Vt.chmodSync)(r,511)}catch(n){}else{this.log.appendLine(`Creating folder '${r}' for '${"composer.phar"}' installation.`),this.log.appendLine(`This can be customized using the '${"COMPOSER_HOME"}' environment variable.`);try{(0,Vt.mkdirSync)(r,511)}catch(n){this.log.appendLine(`Failed to create folder '${r}': ${n.message}`)}}return r}resolveComposerPharPath(){return w(this,null,function*(){var r=fC();if(r)return{path:r,userbin:!0};var n=yield Xn.workspace.findFiles("composer.phar",void 0,1);if(n&&n.length&&n[0].scheme=="file")return{path:n[0].fsPath,userbin:!0};for(let a of DO)if((0,Vt.existsSync)(a))return{path:a,userbin:!0};let i=this.getComposerHome(),s=`${i}/composer.phar`;return(0,Vt.existsSync)(s)?{path:s,userbin:!0}:{path:`${i}/latest.phar`}})}updatePath(){return w(this,null,function*(){let r=yield this.resolveComposerPharPath();return this.path=r.path,fn.platform=="win32"&&(this.path=this.path.replaceAll("/","\\")),console.log(`composer bin: '${this.path}'`),r})}tryUpdate(){return w(this,null,function*(){var r=this.context.globalState.get(JC,void 0);r===void 0?yield Xn.commands.executeCommand("composer.download"):r&&typeof r=="number"&&ZC()-r>kO&&(this.log.appendLine("  Updating composer.phar since the local version is more than 30 days old ..."),yield Xn.commands.executeCommand("composer.download"))})}getOrDownloadComposerPhar(r){return w(this,null,function*(){for(let n=0;n<3;n++){if(r||!(0,Vt.existsSync)(this.path)){let i;try{i=yield WC("composer.phar",this.log,YC(),"https://getcomposer.org/composer.phar")}catch(s){}if(i&&i.byteLength>1024*1024)try{try{(0,Vt.mkdirSync)((0,e0.dirname)(this.path),511)}catch(s){}yield oC(this.path,i),this.context.globalState.update(JC,ZC()),this.log.appendLine(`  composer.phar downloaded to '${this.path}'.`)}catch(s){this.log.appendLine(`  Error writing file '${this.path}': ${s.message}`);continue}else{i&&i.byteLength>0&&this.log.appendLine(`  Error: only ${i.byteLength} bytes downloaded.`);continue}}return this.path}})}};var We=require("vscode");var nc=class extends Xe{constructor(r){super();this.composerphar=r;this.push(We.tasks.registerTaskProvider("composer",{provideTasks:()=>[],resolveTask:(n,i)=>w(this,null,function*(){let s;return typeof n.scope=="object"&&n.scope.uri&&(s=n.scope.uri.fsPath),yield this.createTask(n.definition,s)})}))}getPhpToolsApi(){return w(this,null,function*(){var n,i;let r={phpBin:void 0,authentication:void 0};if(this.phptools==null){let s=We.extensions.getExtension("devsense.phptools-vscode");s?this.phptools=(n=yield s.activate())!=null?n:r:this.phptools=r}return(i=this.phptools)!=null?i:r})}getPhpCommand(){return w(this,null,function*(){let r=yield this.getPhpToolsApi();if(r&&r.phpBin){let i=yield r.phpBin();if(i)return i}let n=We.workspace.getConfiguration().get("php.executablePath");return n!==void 0&&n&&typeof n=="string"&&n!="php"?n:"php"})}executeComposerTask(r,n,i){return w(this,null,function*(){return yield We.tasks.executeTask(yield this.createComposerTask(r,n,i))})}createComposerTask(r,n,i){return w(this,null,function*(){return yield this.createTask({type:"composer",command:r,args:n},i)})}createTask(r,n){return w(this,null,function*(){var o,u;let i=yield this.composerphar.getOrDownloadComposerPhar();if(i===void 0){We.window.showErrorMessage(ve.error_couldntGetComposer);return}let s=yield this.getPhpCommand();s[0]=='"'&&s[s.length-1]=='"'&&(s=s.substring(1,s.length-2));let a=[{value:i,quoting:We.ShellQuoting.Strong},r.command];return r.args&&r.args.forEach(c=>{a.push({value:c!=null?c:"",quoting:We.ShellQuoting.Strong})}),new We.Task(r,(o=r.scope)!=null?o:We.TaskScope.Workspace,(u=r.name)!=null?u:`composer ${r.command}`,"composer",new We.ShellExecution(s,a,{cwd:n}))})}};var t0=Pr(require("https"));var OO=5*60*1e3,ic=class extends Xe{constructor(){super();this.cache={}}request(r){let n=this.cache[r];return n&&n.json&&n.timestamp+OO>Date.now()?n.json:new Promise((i,s)=>{let a=[];t0.get(r,o=>{o.on("data",u=>{a.push(u)}),o.on("end",()=>{let u=JSON.parse(Buffer.concat(a).toString("utf-8"));this.cache[r]={json:u,timestamp:Date.now()},i(u)}),o.on("error",u=>{s(u)})})})}searchByTag(r){return w(this,null,function*(){return yield this.request(`https://packagist.org/search.json?tags=${r}`)})}search(r){return w(this,null,function*(){return yield this.request(`https://packagist.org/search.json?query=${r}`)})}packageData(r){return w(this,null,function*(){return yield this.request(`https://repo.packagist.org/p2/${r}.json`)})}};var _S=Pr(mS());var oF=require("vscode");var uF=Pr(Bd()),cF;var yS={};function ES(e,t){t==null&&(t={});for(let r in yS)t[r]=yS[r];cF.trackEvent({name:e,properties:t})}var lF;function fF(e){return w(this,null,function*(){return sC.init(e),Wv(e),e.subscriptions.push(lF=new Mv(e)),{}})}function pF(){return w(this,null,function*(){ES("extension unloaded (composer)")})}var Mv=class extends Xe{constructor(r){super();this.push(this.log=CS.window.createOutputChannel("Composer")),this.push(this.packagist=new ic),this.push(this.composerphar=new rc(r,this.log)),this.push(this.taskprovider=new nc(this.composerphar)),this.push(new Wu(this.log,this.taskprovider,this.packagist)),this.push(new Bn(this.taskprovider,this.packagist)),this.push(new Yu(r,this.taskprovider)),this.push(new Ku)}};0&&(module.exports={activate,deactivate});
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
/**
 * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
 *
 * This can be used with JS designed for browsers to improve reuse of code and
 * allow the use of existing libraries.
 *
 * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
 *
 * @author Dan DeFelippi <dan@driverdan.com>
 * @contributor David Ellis <d.f.ellis@ieee.org>
 * @license MIT
 */
